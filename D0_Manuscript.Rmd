---
title: "" # needs to be empty since it is specified in Title.Rmd
author: ""
date: ""
documentclass: "report"
classoption: twoside
fontsize: 10pt
glossary: true
output: 
  pdf_document:
    keep_tex: true
    includes:
      in_header: MSc_Style.tex
subparagraph: true # this is needed as a workaround to get titlesec to work
graphics: yes
geometry: "left= 2cm,right = 2cm, bottom = 1.5cm, top = 2cm"
---

```{r setup, include=FALSE}
####--------------- PACKAGES ----
install.load.package <- function(x) {
  if (!require(x, character.only = TRUE))
    install.packages(x, repos='http://cran.us.r-project.org')
  require(x, character.only = TRUE)
}
package_vec <- c("knitr", "raster", "pracma", "gameofthrones", "ggplot2", "cowplot", 
                 "grid", "gridExtra", "xlsx", "kableExtra")
sapply(package_vec, install.load.package)
oldSource <- knit_hooks$get("source")
knit_hooks$set(source = function(x, options) {
  x <- oldSource(x, options)
  x <- ifelse(!is.null(options$ref), paste0("\\label{", options$ref,"}", x), x)
  ifelse(!is.null(options$codecap), paste0("\\captionof{chunk}{", options$codecap,"}", x), x)
})
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE, cache.lazy=FALSE, tidy.opts=list(width.cutoff=80),tidy=TRUE, fig.height=5.5)
options(digits=2, width = 90)

source("Y - Codes/S0b_Directories.R") # setting directories
source("Y - Codes/S0c_Functions.R") # Loading miscellaneous functions

col.NDVI <- rev(terrain.colors(100))
col.qsoil <- colorRampPalette(c("yellow", "burlywood", "beige", "turquoise", "deepskyblue"))(100)
col.tair <- colorRampPalette(c("blue","turquoise", "yellow", "orange", "red"))(100)
SR_cols <- list(col.NDVI, col.tair, col.qsoil, col.qsoil, col.qsoil, col.qsoil)
SR_Titles <- list("NDVI", "Air Temperature", "Soil Moisture (0-7cm)", "Soil Moisture (7-28cm)", "Soil Moisture (28-100cm)", "Soil Moisture (100-255cm)")
setwd(Dir.KrigCov)
Elevation <- raster(list.files()[2], varname = "Elevation")
ElevationF <- raster(list.files()[1], varname = "Elevation")
```

```{r StudRegFun, echo = FALSE}
SRData <- function(Region){
  ### LOADING DATA ---- 
  setwd(Dir.Gimms.Monthly)
  SR_NDVI <- mean(brick(list.files()[grep(pattern = Region, list.files())]), na.rm = TRUE)
  setwd(Dir.ERA.Monthly)
  SR_Qsoil1 <- mean(brick(list.files()[grep(pattern = paste("Qsoil1_mean_", Region, sep=""), list.files())]), na.rm = TRUE)
  SR_Qsoil2 <- mean(brick(list.files()[grep(pattern = paste("Qsoil2_mean_", Region, sep=""), list.files())]), na.rm = TRUE)
  SR_Qsoil3 <- mean(brick(list.files()[grep(pattern = paste("Qsoil3_mean_", Region, sep=""), list.files())]), na.rm = TRUE)
  SR_Qsoil4 <- mean(brick(list.files()[grep(pattern = paste("Qsoil4_mean_", Region, sep=""), list.files())]), na.rm = TRUE)
  SR_Tair <- mean(brick(list.files()[grep(pattern = paste("Tair_mean_", Region, sep=""), list.files())]), na.rm = TRUE)
  
  ### FIXING VALUES ---- 
  QsoilStack <- stack(SR_Qsoil1, SR_Qsoil2, SR_Qsoil3, SR_Qsoil4)
  SR_Qsoil1[1:2] <- c(min(QsoilStack, na.rm = TRUE)@data@min, max(QsoilStack, na.rm = TRUE)@data@max)
  SR_Qsoil2[1:2] <- c(min(QsoilStack, na.rm = TRUE)@data@min, max(QsoilStack, na.rm = TRUE)@data@max)
  SR_Qsoil3[1:2] <- c(min(QsoilStack, na.rm = TRUE)@data@min, max(QsoilStack, na.rm = TRUE)@data@max)
  SR_Qsoil4[1:2] <- c(min(QsoilStack, na.rm = TRUE)@data@min, max(QsoilStack, na.rm = TRUE)@data@max)
  
  ### PLOTTING ---- 
  Plot_Stack <- stack(SR_NDVI, SR_Tair, SR_Qsoil1, SR_Qsoil2, SR_Qsoil3, SR_Qsoil4)
  par(mfrow = c(3,2), mai = c(1, 0, 0.5, 0))
  for(i in 1:length(SR_cols)){
    if(i == 1){
      plot(Plot_Stack[[i]], colNA = "black", main = paste("Mean", SR_Titles[[i]], "1982 - 2015"), cex.main = 3, legend.width = 3, legend.shrink=1, axis.args=list(cex.axis=2.5), cex.axis = 2,
     col =SR_cols[[i]], axes = TRUE, legend = FALSE)
    } else{
      plot(Plot_Stack[[i]], colNA = "black", main = paste("Mean", SR_Titles[[i]], "1981 - 2015"), cex.main = 3, legend.width = 3, legend.shrink=1, axis.args=list(cex.axis=2.5), cex.axis = 2,
     col =SR_cols[[i]], axes = TRUE, legend = FALSE)
    } 
    if(i <= 2){
    plot(Plot_Stack[[i]], legend.only=TRUE, smallplot=c(0.0,.93,.12,.16), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = SR_cols[[i]])
    }
    if(i == 2){
      par(mai = c(.5, 0, 0.5, 0))
    }
    }
  return(SR_Qsoil4)
}
```

```{r SRTRY, echo = FALSE}
TRYRegions <- function(Region){
### LOADING DATA ----
setwd(Dir.Gimms.Monthly)
Back_ras <- mean(brick(list.files()[1:7]), na.rm = TRUE) # background raster for later plots
values(Back_ras)[which(!is.na(values(Back_ras)))] <- 8888
Titles <- c("Height", "Nitrogen Content")
### PLOTTING ----
par(mfrow = c(2,2), mai = c(1, 0, 0.5, 0))
  setwd(Dir.TRY)
  Plot_ras <- brick(list.files(Dir.TRY)[grep(pattern = Region, list.files(Dir.TRY))][1]) # Raw file
  Plot1_ras <- brick(list.files(Dir.TRY)[grep(pattern = Region, list.files(Dir.TRY))][2]) # Distrib file
  Back_ras1 <- crop(Back_ras, extent(Plot_ras))
  Back_ras1 <- stack(Back_ras1, Back_ras1)
  names(Back_ras1) <- c("Height", "Nitrogen")
  for(i in 1:2){
  plot(Back_ras1[[i]], colNA = "black", main = Titles[i], cex.main = 3, legend = FALSE, col = "grey")
  plot(Plot_ras[[i]], add = TRUE, legend = FALSE, col = col.tair, axes = TRUE)
  plot(Plot_ras[[i]], legend.only=TRUE, smallplot=c(0,.95,.075,.115), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.tair)
  }
  for(i in 1:2){
  plot(Back_ras1[[i]], colNA = "black", main = Titles[i], cex.main = 3, legend = FALSE, col = "grey")
  plot(Plot1_ras[[i]], add = TRUE, legend = FALSE, col = col.tair, axes = TRUE)
  plot(Plot1_ras[[i]], legend.only=TRUE, smallplot=c(0,.95,.075,.115), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.tair)
  }
}
```

```{r ModelRes, echo = FALSE}
col.signeg <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "targaryen2")
col.sigpos <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "tyrell")
col.nonsig <- colorRampPalette(c("grey"))(1)
col.lags <- got(n = 12, alpha = 1, begin = 0, end = 1, direction = 1, option = "daenerys")
smallplotxpos <- c(0.5,.93,.03,.065) # where to put colour scales
smallplotxneg <- c(0.05,.5,.03,.065) # where to put colour scales
ModelRes <- function(Region, SoilLayer){
  Files <- list.files(Dir.Memory)[grep(list.files(Dir.Memory), pattern = Region)]
  Files <- Files[grep(Files, pattern = ".nc")]
  plot_ras <- brick(paste(Dir.Memory, Files[SoilLayer], sep="/"))
  plot(plot_ras[[1]], col = col.lags, colNA = "black", legend=FALSE, axes=FALSE)
  plot(plot_ras[[1]], legend.only=TRUE, col=col.lags, smallplot=c(.05, .93, .03, .065), horizontal = TRUE, axis.args=list(cex.axis=2.5))
  if(SoilLayer == 1){
    RasLay <- 4:6
  }else{
    RasLay <- c(5)
  }
  for(Plot in RasLay){
    Neg_ras <- plot_ras[[Plot]]
    Neg_ras[which(values(Neg_ras) >= 0)] <- NA
    Pos_ras <- plot_ras[[Plot]]
    Pos_ras[which(values(Pos_ras) < 0)] <- NA
    plot(Neg_ras, col=col.signeg, colNA = "black", legend=FALSE, axes=FALSE)
    if(Plot == 4 & Region == "Iberian Region"){
      plot(Pos_ras, col=col.sigpos, colNA = "black", legend=FALSE, axes=FALSE, add=TRUE)
    }else{
      plot(Pos_ras, col=col.sigpos, legend=FALSE, axes=FALSE, add=TRUE) 
    }
    plot(Neg_ras, legend.only=TRUE, col=col.signeg, colNA = "black", smallplot=smallplotxneg, horizontal = TRUE, axis.args=list(cex.axis=2.5))
    if(Plot == 4 & Region == "Iberian Region"){
      plot(Pos_ras, legend.only=TRUE, col=col.sigpos, smallplot=c(.05, .93, .03, .065), horizontal = TRUE, axis.args=list(cex.axis=2.5))
    }else{
      plot(Pos_ras, legend.only=TRUE, col=col.sigpos, smallplot=smallplotxpos, horizontal = TRUE, axis.args=list(cex.axis=2.5))
    }
  }
}
```

```{r VarParRes, echo = FALSE}
col.varpar1 <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "wildfire")
col.varpar2 <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "targaryen")
col.varpar3 <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "jon_snow")
col.list <- list(col.varpar1, col.varpar2, col.varpar3) 
SoilLayer = 1

VarParRes <- function(Region, SoilLayer, Plot = 1){
  Files <- list.files(Dir.Memory)[grep(list.files(Dir.Memory), pattern = Region)]
  Files <- Files[grep(Files, pattern = ".nc")]
  Alter_ras <- brick(paste(Dir.Memory, Files[SoilLayer], sep="/"))[[7:10]]
  Alter_ras[2] <- 0
  values(Alter_ras)[which(values(Alter_ras) < 0)] <- 0
  cells <- order(values(Alter_ras[[1]]))
  plot_df <- data.frame(Variance =NA, 
                        Cell =NA,
                        Source =NA)
  Idents <- c(NA, "t-1", "Shared", "Qsoil")
  for(i in 1:4){
    Alter_ras[[i]][which(values(Alter_ras[[i]])>quantile(values(Alter_ras[[1]]),.95, na.rm=TRUE))] <- quantile(values(Alter_ras[[1]]),.95, na.rm=TRUE)
    if(i > 1){
      plot_df1 <- data.frame(Variance = values(Alter_ras[[i]])[cells],
                             Cell = 1:length(cells), 
                             Source = rep(Idents[i], length(cells)))
      plot_df <- rbind(plot_df, plot_df1)
    }
  }
  plot_df <- na.omit(plot_df)
  p <- ggplot(data = plot_df, aes(y = Variance, x = Cell, fill = Source)) + geom_bar(stat = "identity") + ylim(0, quantile(values(Alter_ras[[1]]),.95, na.rm=TRUE)) + theme_bw(base_size= 20) + xlab("Raster Cells") + scale_fill_manual(values=c(col.list[[3]][1], col.list[[2]][50], col.list[[1]][30]))
  if(Plot == 1){
    print(p)
  }else{
   for(i in 2:4){
    col.varpar <- col.list[[i-1]]
    plot(Alter_ras[[i]], col=col.varpar, colNA = "black", legend=FALSE, axes=FALSE)
    plot(Alter_ras[[i]], legend.only=TRUE, col=col.varpar, smallplot=c(.05, .93, .03, .065), horizontal = TRUE, axis.args=list(cex.axis=2.5))
  } 
  }
}
```

```{r SoilLayersRes, echo = FALSE}
col.signeg <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "targaryen2")
col.sigpos <- got(n = 100, alpha = 1, begin = 0, end = 1, direction = -1, option = "tyrell")
col.nonsig <- colorRampPalette(c("grey"))(1)
smallplotxpos <- c(0.5,.93,.03,.065) # where to put colour scales
smallplotxneg <- c(0.05,.5,.03,.065) # where to put colour scales
SoilLayersRes <- function(Region){
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  Alter_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
  for(SoilLayer in 2:4){
    Add_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
    Alter_ras <- stack(Alter_ras, Add_ras)
  }
  for(Plot in 1:4){
    Neg_ras <- Alter_ras[[Plot]]
    Neg_ras[which(values(Neg_ras) >= 0)] <- NA
    Pos_ras <- Alter_ras[[Plot]]
    Pos_ras[which(values(Pos_ras) < 0)] <- NA
    plot(Neg_ras, col=col.signeg, colNA = "black", legend=FALSE, axes=FALSE)
    plot(Pos_ras, col=col.sigpos, legend=FALSE, axes=FALSE, add=TRUE) 
    plot(Neg_ras, legend.only=TRUE, col=col.signeg, colNA = "black", smallplot=smallplotxneg, horizontal = TRUE, axis.args=list(cex.axis=2.5))
    plot(Pos_ras, legend.only=TRUE, col=col.sigpos, smallplot=smallplotxpos, horizontal = TRUE, axis.args=list(cex.axis=2.5))
  }
}
```

```{r PatCausRes, echo = FALSE}
PatcausRes <- function(Region, SoilLayer, SoilOnly){
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  Alter_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))
  Files <- list.files(Dir.ERA.Monthly)[grep(list.files(Dir.ERA.Monthly), pattern = Region)]
  Files <- Files[grep(Files, pattern = ".nc")]
  EQsoil <- Files[grep(Files, pattern = "Qsoil")]
  EQsoil <- brick(paste(Dir.ERA.Monthly, EQsoil[SoilLayer], sep="/"))
  EQsoil <- values(mean(EQsoil))
  ETair <- Files[grep(Files, pattern = "Tair")]
  ETair <- brick(paste(Dir.ERA.Monthly, ETair, sep="/"))
  ETair <- values(mean(ETair))
  ENDVI <- list.files(Dir.Gimms.Monthly)[grep(list.files(Dir.Gimms.Monthly), pattern =Region)]
  ENDVI <- brick(paste(Dir.Gimms.Monthly, ENDVI, sep="/"))
  ENDVI <- values(mean(ENDVI))
  plot_df <- data.frame(Memory = values(Alter_ras[[1]]),
                        NDVI = values(Alter_ras[[2]]),
                        Qsoil = values(Alter_ras[[3]]),
                        Tair = values(Alter_ras[[4]]),
                        ENDVI = ENDVI,
                        EQsoil = EQsoil,
                        ETair = ETair)
  plot_df <- na.omit(plot_df)
  QsoilTitle <- c("(0-7cm)", "(7-28cm)", "(28-100cm)", "(100-255cm)")
  Output <- as.list(rep(NA, 8))
  if(SoilOnly == TRUE){
    plotm <- ggplot(plot_df, aes(x = as.factor(Memory), y = EQsoil)) +
  geom_boxplot() + theme_bw(base_size = 35) + ylab(paste("Mean Soil Moisture", QsoilTitle[SoilLayer])) + xlab(paste("Soil Moisture", QsoilTitle[SoilLayer], "Lag")) + coord_flip()
print(plotm)
  Output[[1]] <- summary(lm(Memory ~ EQsoil, data = plot_df))[["coefficients"]][1,1]
  Output[[2]] <- summary(lm(Memory ~ EQsoil, data = plot_df))[["coefficients"]][1,4]
  Output[[3]] <- summary(lm(Memory ~ EQsoil, data = plot_df))[["coefficients"]][2,1]
  Output[[4]] <- summary(lm(Memory ~ EQsoil, data = plot_df))[["coefficients"]][2,4]
plotq <- ggplot(plot_df, aes(x = EQsoil, y = Qsoil)) +
  geom_point(shape = ".", alpha = 0.5, col = "blue", size = 3.5) + 
  theme_bw(base_size = 35) + xlab(paste("Mean Soil Moisture", QsoilTitle[SoilLayer])) + ylab(paste("Soil Moisture", QsoilTitle[SoilLayer], "Coefficients")) + 
  stat_smooth(method = "lm",col ="black",level = 0.95)+
  geom_hline(yintercept = 0, linetype="dotted")
print(plotq)
  Output[[5]] <- summary(lm(Qsoil ~ EQsoil, data = plot_df))[["coefficients"]][1,1]
  Output[[6]] <- summary(lm(Qsoil ~ EQsoil, data = plot_df))[["coefficients"]][1,4]
  Output[[7]] <- summary(lm(Qsoil ~ EQsoil, data = plot_df))[["coefficients"]][2,1]
  Output[[8]] <- summary(lm(Qsoil ~ EQsoil, data = plot_df))[["coefficients"]][2,4]
  }else{
    plotN <- ggplot(plot_df, aes(x = ENDVI, y = NDVI)) +
  geom_point(shape = ".", alpha = 0.5, col = "forestgreen", size = 3.5) + 
  theme_bw(base_size = 35) + xlab("Mean NDVI") + ylab("NDVI [t-1] Coefficients") + 
  stat_smooth(method = "lm",col ="black",level = 0.95)+
  geom_hline(yintercept = 0, linetype="dotted")
print(plotN)
  Output[[1]] <- summary(lm(NDVI ~ ENDVI, data = plot_df))[["coefficients"]][1,1]
  Output[[2]] <- summary(lm(NDVI ~ ENDVI, data = plot_df))[["coefficients"]][1,4]
  Output[[3]] <- summary(lm(NDVI ~ ENDVI, data = plot_df))[["coefficients"]][2,1]
  Output[[4]] <- summary(lm(NDVI ~ ENDVI, data = plot_df))[["coefficients"]][2,4]
plotT <- ggplot(plot_df, aes(x = ETair, y = Tair)) +
  geom_point(shape = ".", alpha = 0.5, col = "red", size = 3.5) + 
  theme_bw(base_size = 35) + xlab("Mean Air Temperature") + ylab("Air Temperature Coefficients") + 
  stat_smooth(method = "lm",col ="black",level = 0.95)+
  geom_hline(yintercept = 0, linetype="dotted")
print(plotT)
  Output[[5]] <- summary(lm(Tair ~ ETair, data = plot_df))[["coefficients"]][1,1]
  Output[[6]] <- summary(lm(Tair ~ ETair, data = plot_df))[["coefficients"]][1,4]
  Output[[7]] <- summary(lm(Tair ~ ETair, data = plot_df))[["coefficients"]][2,1]
  Output[[8]] <- summary(lm(Tair ~ ETair, data = plot_df))[["coefficients"]][2,4]
  }
  return(Output)
}
```

```{r TRYRes, echo = FALSE}
Tryres <- function(Region, SoilLayer, Variable){
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Variable_vec <- c("t-1", "Qsoil", "Tair")
  LocVar <- which(Variable_vec == Variable) + 1
  TryFiles <-  list.files(Dir.TRY)[grep(list.files(Dir.TRY), pattern = Region)]
  TryRaw <- brick(paste(Dir.TRY, TryFiles[1], sep="/"))
  values(TryRaw)[which(values(TryRaw) > quantile(values(TryRaw), .99, na.rm = TRUE))] <- NA
  TryDis <- brick(paste(Dir.TRY, TryFiles[2], sep="/"))
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  Alter_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[LocVar]]
  Memory_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[1]]
  data_df <- data.frame(Height = c(values(TryRaw[[1]]), values(TryDis[[1]])), 
                     Nitrogen = c(values(TryRaw[[2]]), values(TryDis[[2]])),
                     Qsoil = c(values(Alter_ras), values(Alter_ras)),
                     Memory = c(values(Memory_ras), values(Memory_ras)),
                     TRY = c(rep("Raw", length(values(Alter_ras))), rep("Mapped", length(values(Alter_ras)))))

  VarTitle <- c("NDVI [t-1] Coefficients", "Qsoil", "Air Temperature Coefficients")[(LocVar-1)]
  if(LocVar == 3){
    VarTitle <- c("Soil Moisture (0-7cm) Coefficients", "Soil Moisture (7-28cm) Coefficients", "Soil Moisture (28-100cm) Coefficients", "Soil Moisture (100-255cm) Coefficients")[SoilLayer]
  }
  if(Variable != "Qsoil"){
   Output <- as.list(rep(NA, 16)) 
  }else{
   Output <- as.list(rep(NA, 32)) 
  }
p1 <- ggplot(data_df, aes(x = Height, y = Qsoil, col = TRY)) +
  geom_point(shape = ".", alpha = 0.5, size = 3.5) + theme_bw(base_size = 35) +  xlab("Vegetative Height") + ylab(VarTitle) + geom_hline(yintercept = 0, linetype="dotted") + stat_smooth(method = "lm") + scale_color_manual(values=c("lightgreen", "black"))
print(p1)
if(is.na(unique(data_df$Height[which(data_df$TRY == "Raw")]))){
  Output[[1]] <- NA
  Output[[2]] <- NA
  Output[[3]] <- NA
  Output[[4]] <- NA
}else{
  Output[[1]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,1]
  Output[[2]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,4]
  Output[[3]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,1]
  Output[[4]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,4]
}
  Output[[5]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,1]
  Output[[6]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,4]
  Output[[7]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,1]
  Output[[8]] <- summary(lm(Qsoil ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,4]
p2 <- ggplot(data_df, aes(x = Nitrogen, y = Qsoil, col = TRY)) +
  geom_point(shape = ".", alpha = 0.5, size = 3.5) + theme_bw(base_size = 35) +  xlab("Leaf Nitrogen Content") + ylab(VarTitle) + geom_hline(yintercept = 0, linetype="dotted") + stat_smooth(method = "lm") + scale_color_manual(values=c("orange", "black"))
print(p2)
  Output[[9]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,1]
  Output[[10]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,4]
  Output[[11]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,1]
  Output[[12]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,4]
  Output[[13]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,1]
  Output[[14]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,4]
  Output[[15]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,1]
  Output[[16]] <- summary(lm(Qsoil ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,4]
  if(Variable == "Qsoil"){
    if(is.na(unique(data_df$Height[which(data_df$TRY == "Raw")]))){
  Output[[17]] <- NA
  Output[[18]] <- NA
  Output[[19]] <- NA
  Output[[20]] <- NA
}else{
  Output[[17]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,1]
  Output[[18]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,4]
  Output[[19]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,1]
  Output[[20]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,4]
}
  Output[[21]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,1]
  Output[[22]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,4]
  Output[[23]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,1]
  Output[[24]] <- summary(lm(Memory ~ Height, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,4]
  Output[[25]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,1]
  Output[[26]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][1,4]
  Output[[27]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,1]
  Output[[28]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Raw"),]))[["coefficients"]][2,4]
  Output[[29]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,1]
  Output[[30]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][1,4]
  Output[[31]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,1]
  Output[[32]] <- summary(lm(Memory ~ Nitrogen, data = data_df[which(data_df$TRY == "Mapped"),]))[["coefficients"]][2,4]
  }
  return(Output)
}
```

```{r TRYresTab, echo = FALSE}
TryTab <- function(ModelCoeffs, SoilLayer, Region){
  ModelCoeffs <- unlist(ModelCoeffs)
tabout <- data.frame(Column = ModelCoeffs[1:4])
starts <- seq(1,length(ModelCoeffs), by = 4)
for(i in 2:(length(ModelCoeffs)/4)){
  tabout <- cbind(tabout, ModelCoeffs[starts[i]:(starts[i]+3)])
}
colnames(tabout) <- rep(c("R", "M"), 4)
rownames(tabout) <- c("Intercept", "$p_{Intercept}$", "Slope", "$p_{Slope}$")
Short <- paste("PFTs and Qsoil", SoilLayer, " Memory (", Region, ")", sep="")
Long <- paste("Coefficients of linear regressions of Qsoil", SoilLayer, " memory coefficients against PFT data 
              (vegetative height H, and leaf nitrogen mass Nmass) both as raw geo-referenced data (R), 
              and extended maps of species-specific trait means (M). 
              Established via \\ref{rTRYresTab}.", sep="")
kab <- kable(tabout, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- add_header_above(kable_input = kab, header = c(" " = 1, "H" = 2, "Nmass" = 2,
                                                      "H" = 2, "Nmass" = 2), italic = FALSE, align = 'c')
kab <- add_header_above(kable_input = kab, header = c(" " = 1, "Qsoil" = 4, "Lag" = 4), bold = TRUE, align = 'c')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

```{r COMRes, echo = FALSE}
Comres <- function(Region, Variable){
  VarHold <- Variable
  if(Variable == "FSC-1" | Variable == "FSC-2"){
    Variable <- "FastSlow"
  }
  ## Memory Data
  # Memory
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  Memory_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[1]]
  for(SoilLayer in 2:4){
    Add_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[1]]
    Memory_ras <- stack(Memory_ras, Add_ras)
  }
  # t-1
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  NDVI_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[2]]
  # Qsoil
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  Qsoil_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
  for(SoilLayer in 2:4){
    Add_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
    Qsoil_ras <- stack(Qsoil_ras, Add_ras)
  }
  # Tair
  Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  Tair_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[4]]
  ## COMPADRE data
  Dir.Comp <- paste(Dir.Compadre, Variable, sep="/")
  Compad_ras <- list.files(Dir.Comp)[grep(list.files(Dir.Comp), pattern = Region)]
  if(VarHold != "FSC-2"){
    Compad_ras <- raster(paste(Dir.Comp, Compad_ras, sep="/"))[[1]]
  }else{
    Compad_ras <- brick(paste(Dir.Comp, Compad_ras, sep="/"))[[2]]
  }
  values(Compad_ras)[which(values(Compad_ras) > quantile(values(Compad_ras), .66, na.rm = TRUE))] <- quantile(values(Compad_ras), .66, na.rm = TRUE)
  if(VarHold == "FSC-1" | VarHold == "FSC-2"){
   values(Compad_ras)[which(values(Compad_ras) < quantile(values(Compad_ras), .05, na.rm = TRUE))] <- quantile(values(Compad_ras), .05, na.rm = TRUE) 
  }
  plot_df <- data.frame(
    Data = c(values(Memory_ras[[1]]), values(Memory_ras[[2]]), values(Memory_ras[[3]]), values(Memory_ras[[4]]), values(NDVI_ras), values(Qsoil_ras[[1]]), values(Qsoil_ras[[2]]), values(Qsoil_ras[[3]]), values(Qsoil_ras[[4]]), values(Tair_ras)), 
    Identifiers = rep(c("LagSoil1", "LagSoil2", "LagSoil3", "LagSoil4", "t-1", "Qsoil1", "Qsoil2", "Qsoil3", "Qsoil4", "Tair"), each = length(values(Memory_ras[[1]]))),
   Compadre = rep(values(Compad_ras), 10)
  )
  Variable <- VarHold
  plot_df <- na.omit(plot_df)
  Output <- as.list(rep(NA,10))
  plot <- ggplot(data = plot_df, aes(x = Compadre, y = Data, col = Identifiers)) + geom_point(alpha = 0.5, size = 3.5) + theme_bw(base_size = 35) +  xlab(paste("COMPADRE", Variable)) + ylab("Vegetation Memory Coefficients") + geom_hline(yintercept = 0, linetype="dotted") + stat_smooth(method = "lm", level = 0.66) + scale_color_manual(values=c("purple4", "purple2", "violetred2", "violet", "blue4", "blue2", "cyan4", "cyan2", "forestgreen", "red"))
  print(plot)
  Idents <- c("t-1", "Tair", paste("Qsoil", 1:4, sep=""), paste("LagSoil", 1:4, sep=""))
  for(i in 0:(length(Idents)-1)){
    Output[[(4*i+1)]] <- summary(lm(Data ~ Compadre, data = plot_df[which(plot_df$Identifiers == Idents[(i+1)]),]))[["coefficients"]][1,1]
    Output[[(4*i+2)]] <- summary(lm(Data ~ Compadre, data = plot_df[which(plot_df$Identifiers == Idents[(i+1)]),]))[["coefficients"]][1,4]
    Output[[(4*i+3)]] <- summary(lm(Data ~ Compadre, data = plot_df[which(plot_df$Identifiers == Idents[(i+1)]),]))[["coefficients"]][2,1]
    Output[[(4*i+4)]] <- summary(lm(Data ~ Compadre, data = plot_df[which(plot_df$Identifiers == Idents[(i+1)]),]))[["coefficients"]][2,4]
  }
  return(list(leg,Output))
}
```

```{r URes, echo = FALSE}
Ures <- function(Region, SoilLayer){
Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".xlsx")]
Utab <- read.xlsx(file = paste(Dir.Reg, Files, sep="/"), sheetName = paste("Model", SoilLayer))
Medians <- read.xlsx(file = paste(Dir.Reg, Files, sep="/"), sheetName = "Variable medians")[SoilLayer,]
Medians <- as.vector(Medians[1,c(2:4)])
Utab <- Utab[,-1] 
colnames(Utab) <- c("NDVI [t-1]", paste("Qsoil", SoilLayer, sep=""), "Tair")
rownames(Utab)  <- c(round(Medians,2))
Utab <- round(Utab, 2)
Short <- paste("Mann-Whitney U-Test (", Region, ", Qsoil", SoilLayer, " Model)", sep="")
Long <- paste("Rownames represent median values of vegetation memory coefficients contained in column names. 
              U-Test statistics of vegetation memory coefficient values are contained within the upper-righthand cells. 
              $p$-values belonging to these $U$-values are represented in the lower-lefthand block of cells. 
              Established via \\ref{rUresChunk}.")
kab <- kable(Utab, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

```{r UQsoilRes, echo = FALSE}
UQsoilres <- function(Region){
Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".xlsx")]
Utab <- read.xlsx(file = paste(Dir.Reg, Files, sep="/"), sheetName = "Qsoil")
Medians <- read.xlsx(file = paste(Dir.Reg, Files, sep="/"), sheetName = "Variable medians")[,3]
Utab <- Utab[,-1] 
colnames(Utab) <- paste("Qsoil", c(1:4), sep="")
rownames(Utab)  <- c(round(Medians,4))
Utab <- round(Utab, 2)
Short <- paste("Mann-Whitney U-Test (", Region, ", Qsoil Layers)", sep="")
Long <- paste("Rownames represent median values of Qsoil vegetation memory coefficients contained in column names. 
              U-Test statistics of vegetation memory coefficient values are contained within the upper-righthand cells. 
              $p$-values belonging to these $U$-values are represented in the lower-lefthand block of cells. 
              Established via \\ref{rUQsoilRes}.")
kab <- kable(Utab, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

```{r COMPADTab, echo = FALSE}
CompadTab <- function(Region, ModelCoeffs, Variable){
  tabout <- data.frame(Column = ModelCoeffs[1:4])
starts <- seq(1,length(ModelCoeffs), by = 4)
for(i in 2:(length(ModelCoeffs)/4)){
  tabout <- cbind(tabout, ModelCoeffs[starts[i]:(starts[i]+3)])
}
rownames(tabout) <- c("Intercept", "$p_{Intercept}$", "Slope", "$p_{Slope}$")
tabout <- round(tabout,2)
colnames(tabout) <- c("t-1", "Tair", 1:4, 1:4)
Short <- paste("COMPADRE ", Variable, " and Vegetation Memory (", Region, ")", sep="")
Long <- paste("Linear regression coefficients of COMPADRE data and vegetation memory coefficients. 
              Established via \\ref{rCOMPADTab}.", sep="")
kab <- kable(tabout, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- add_header_above(kable_input = kab, header = c(" " = 3, "Qsoil" = 4, "Lag" = 4), bold = TRUE, align = 'c')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

```{r PatCausAnova, echo = FALSE}
PatCausAnova <- function(Region){
 ## LOADING
Dir.Reg <- paste(Dir.Memory, "/", Region, "-1981_2015", sep="")
  Files <- list.files(Dir.Reg)[grep(list.files(Dir.Reg), pattern = ".nc")]
  SoilLayer <- 1
  Alter_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[1]]
  for(SoilLayer in 2:4){
    Add_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[1]]
    Alter_ras <- stack(Alter_ras, Add_ras)
  }
  Memory <- Alter_ras
  SoilLayer <- 1
  Alter_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
  for(SoilLayer in 2:4){
    Add_ras <- brick(paste(Dir.Reg, Files[SoilLayer], sep="/"))[[3]]
    Alter_ras <- stack(Alter_ras, Add_ras)
  }
  Qsoil <- Alter_ras
  Files <- list.files(Dir.ERA.Monthly)[grep(list.files(Dir.ERA.Monthly), pattern = Region)]
  Files <- Files[grep(Files, pattern = ".nc")]
  EQsoil <- Files[grep(Files, pattern = "Qsoil")]
  SoilLayer <- 1
  Alter_ras <- mean(brick(paste(Dir.ERA.Monthly, EQsoil[SoilLayer], sep="/")))
  for(SoilLayer in 2:4){
    Add_ras <- mean(brick(paste(Dir.ERA.Monthly, EQsoil[SoilLayer], sep="/")))
    Alter_ras <- stack(Alter_ras, Add_ras)
  }
  EQsoil <- Alter_ras
  ## DATA
  anova_df <- data.frame(EQsoil1 = values(EQsoil[[1]]),
                         EQsoil2 = values(EQsoil[[2]]),
                         EQsoil3 = values(EQsoil[[3]]),
                         EQsoil4 = values(EQsoil[[4]]),
                         Qsoil1 = values(Qsoil[[1]]),
                         Qsoil2 = values(Qsoil[[2]]),
                         Qsoil3 = values(Qsoil[[3]]),
                         Qsoil4 = values(Qsoil[[4]]),
                         Memory1 = values(Memory[[1]]),
                         Memory2 = values(Memory[[2]]),
                         Memory3 = values(Memory[[3]]),
                         Memory4 = values(Memory[[4]]))
  anova_df <- na.omit(anova_df)  
  ## ANOVA
  ### Memory
  Mod1 <- lm(Memory1 ~ EQsoil1, data = anova_df)
  Mod2 <- lm(Memory2 ~ EQsoil2, data = anova_df)
  Mod3 <- lm(Memory3 ~ EQsoil3, data = anova_df)
  Mod4 <- lm(Memory4 ~ EQsoil4, data = anova_df)
  AnMem <- anova(Mod1, Mod2, Mod3, Mod4)
  ### Qsoil
  Mod1 <- lm(Qsoil1 ~ EQsoil1, data = anova_df)
  Mod2 <- lm(Qsoil2 ~ EQsoil2, data = anova_df)
  Mod3 <- lm(Qsoil3 ~ EQsoil3, data = anova_df)
  Mod4 <- lm(Qsoil4 ~ EQsoil4, data = anova_df)
  AnQsoil <- anova(Mod1, Mod2, Mod3, Mod4)
  return(list(AnMem, AnQsoil))
}
```

```{r Patcaustab, echo = FALSE}
PatCauseTab <- function(ModelCoeffs, Region){ # using Outputs of PatcauseRes for ModelCoeffs argument
  tabout <- data.frame(Column = ModelCoeffs[1:4])
starts <- seq(1,length(ModelCoeffs), by = 4)
for(i in 2:(length(ModelCoeffs)/4)){
  tabout <- cbind(tabout, ModelCoeffs[starts[i]:(starts[i]+3)])
}
colnames(tabout) <- c("t-1", "Tair", "1", "2", "3", "4", "1", "2", "3", "4")
rownames(tabout) <- c("Intercept", "$p_{Intercept}$", "Slope", "$p_{Slope}$")
Short <- paste("Vegetation Memory Sensitivity (",Region,")", sep="")
Long <- paste("Coefficients of linear regressions of vegetation sensitivity across the Iberian Region. 
              Established via \\ref{rPatcaustab}.", sep="")
kab <- kable(tabout, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- add_header_above(kable_input = kab, header = c(" " = 3, "Qsoil" = 4, "Lag" = 4), bold = TRUE, align = 'c')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

```{r PFTTab, echo = FALSE}
PFTTab <- function(ModelCoeffs, Region, Data){ # Outputs of Tryres to ModelCOeffs
  tabout <- data.frame(Column = ModelCoeffs[1:4])
starts <- seq(1,length(ModelCoeffs), by = 4)
for(i in 2:(length(ModelCoeffs)/4)){
  tabout <- cbind(tabout, ModelCoeffs[starts[i]:(starts[i]+3)])
}
colnames(tabout) <- rep(c("H", "$N_{mass}$"), 6)
rownames(tabout) <- c("Intercept", "$p_{Intercept}$", "Slope", "$p_{Slope}$")
Short <- paste(Data, " PFTs and Vegetation Memory (",Region,")", sep="")
Long <- paste("Linear regression coefficients of vegetative height (H) and leaf nitrogen mass (Nmass) against 
              vegetation memory coefficients. 
              Established via \\ref{rPFTTab}.", sep="")
kab <- kable(tabout, 
            booktabs = TRUE,
            caption = paste("\\textbf{",Short, " -} ",Long, sep=""),
            caption.short = Short,
            escape = FALSE,
            format = 'latex')
kab <- add_header_above(kable_input = kab, header = c(" " = 1, "t-1" = 2, "Tair" = 2, 
                                                      "1" = 2, "2" = 2, "3" = 2, "4" = 2), italic = TRUE, align = 'c')
kab <- add_header_above(kable_input = kab, header = c(" " = 5, "Qsoil" = 8), bold = TRUE, align = 'c')
kab <- kable_styling(kab, latex_options = c("hold_position"))
print(kab)
}
```

<!--- ####### PREAMBLE -----------
--------------------------------------------->

\begin{titlepage}
%\maketitle % this is the default. it does not comply with the requirements by UiB
\includegraphics[height=2cm]{3 - Figures/uib-logo.png}
\hspace{6cm}
\includegraphics[height=2cm]{3 - Figures/Nansen-logo.jpg}\\
\line(1,0){500} \\
\begin{center}
%	\line(1,0){500} \\
%	\vspace{0.1cm}
	\Huge{Inferring Vegetation Memory from Remote Sensing Data using novel Climate Reconstruction Products}
%	\vspace{0.1cm}
%	\line(1,0){300} \\
	\vspace{2.5cm}\\
	\Large{\textbf{Master's Thesis (M.Sc.)}}\\
	\vspace{2.cm}
	\large{31/05/2019}\\
	\vspace{0.2cm}
	\large{at Universitetet i Bergen}\\
	\vspace{2cm}
	\large{In Partial Fulfilment of the Requirements for the Degree Master of Science (M.Sc.)}\\
	\vspace{3.5cm}
   \hfill \textbf{by} \linebreak 
    Primary Supervisor: Dr. Alistair Seddon \hfill  Erik Kusch  \linebreak 
    Secondary Supervisor: Dr. Richard Davy \hfill born 03/01/1995 in Eilenburg, Germany \\ 
    \hfill Enrolment number: 239977
\end{center}
\end{titlepage}


\clearpage

<!--- ####### TOC, TOF, TOT, TOL ------------------------------------------------>  
\pagenumbering{gobble}
\blankpage

\begin{abstract}
\Blindtext

\end{abstract}

\chapter*{Acknowledgements}
\blindtext


\pagenumbering{roman} 
\setcounter{tocdepth}{3}
\tableofcontents
\listoffigures
\listoftables
\clearpage
\printglossary[title=List of Abbreviations and Acronyms,toctitle=List of Abbreviations and Acronyms]
\clearpage

<!--- ####### DOCUMENT ---------------------------------------------------------->
\pagenumbering{arabic}

\fancypagestyle{plain}{%
\fancyhead[OR]{\thepage}
\fancyhead[EL]{\thepage}
}
\pagestyle{fancy}

\titleformat{\chapter}{\normalfont\huge\bfseries}{}{0pt}{\thechapter. \Huge}
\titlespacing*{\chapter}{0pt}{00pt}{20pt}


\clearpage

# Introduction
Ecosystems are subject to disturbance regimes which can undergo substantial alterations, especially under climate change\cite{Johnstone2016}. Widespread bioclimatic impacts which can be attributed to these changes include\cite{CoreWritingTeam2014}: (1) increased frequency and intensity of climate extremes\cite{Santiago2016}, (2) increasing temperatures and levels of aridity in dryland regions\cite{Allen2010}, and (3) shifts in environemntal and ecosystem processes\cite{Kefi2016,Johnstone2016,Seidl2016b}. This has raised growing concern that future disturbance dynamics will exceed tipping points and cause non-linear shifts in ecosystem state in relation to **attractors**\cite{Senf2017} (see table \ref{tab:ResTerm} for definitions of bold font terms relating to the resilience debate). Such a **regime shift**\cite{Scheffer2010,Xu2015,Vasilakopoulos2015} can have a tremendous impact on local as well as global welfare of mankind\cite{Cote2010,Scheffer2001,Genkai-Kato2007}. Therefore, policy makers have made it their mission statement to enforce actions which serve to maintain or boost **resilience**. The Aichi biodiversity targets, for example, include the following statement: \textit{"By 2020, ecosystem resilience [...] has been enhanced, [...] thereby contributing to climate change mitigation and adaptation and to combating desertification"} as target 15\cite{CBD2013}. Whilst the Aichi targets are set to encompass global action, national policy makers, such as the Australian Government, are recongising the importance of achieving climate resilience as well in stating: \textit{"We achieve climate resilience when short, medium and long-term decision making considers current climate risks and a changing climate"}\cite{GovernmentDepartmentoftheEnvironment2015}. 
Conceiving such strategies and evaluating their respective efficacies requires a thorough understanding of resilience theory and a robust set of tools to measure the resilience of ecosystems.  

Generally, resilience can be understood as the capacity of a system to absorb **disturbances** and respond to changing conditions so as to still retain the same function, structure, identity and feedbacks\cite{Vasilakopoulos2015,Holling1973}. First introduced to biological sciences in 1973 by Holling et al. resilience thinking encompassed two separate characteristics of ecosystems\cite{Holling1973}:

\begin{enumerate}
\item \textit{Stability} was defined as the ability of a system to return to its original state after a temporary disturbance. The more stable a system, the less it fluctuates in its characteristics and the faster it returns to its initial conditions after a perturbation. Contemporary literature usually refers to this property as \textbf{engineering resilience}\cite{Liu2018,Mumby2015,Seidl2016b}. 
\item \textit{Resilience}, on the other hand, was characterised as the property of a system that allowed it to withstand disturbances without collapsing. The more resilient a system, the higher its chances of persisting under changing conditions. Today this is mostly referred to as \textbf{ecological resilience}\cite{Scheffer2015,Standish2014,Gunderson2000}.  
\end{enumerate}

Within this early context on resilience thinking, a system could be resilient whilst not being very stable and fluctuating in its properties a great deal\cite{Holling1973}. Consider Andean grasslands as an example: wildfires lead to immense fluctuations in vegetation cover without making it impossible for the system to recover\cite{Oliveras2014}. As such, resilience thinking often considers large spatial and temporal extents\cite{Foley2003} which lend themselves well to remote sensing approaches\cite{Ares2001,Harris2014}.

It has been argued that, since then, the term 'resilience' itself has undergone a 'greenwash'\cite{Newton2016}, which has diminished its direct usefulness to researchers. This process has seen the term 'resilience' being introduced originally to ecological sciences but adapted by other branches of research (e.g. social sciences\cite{Carpenter2001}) and society (e.g. policy makers\cite{Newton2016}), modified for different purposes and re-introduced to ecological sciences with multiple altered definitions\cite{Brown2015}. For example, \textit{coerced resilience} is created and maintained through anthropogenic action\cite{Rist2014}. Novel remote sensing assessments of resilience, however, establish resilience theory largely though mathematical understandings\cite{Papagiannopoulou2017}.

Assumptions on ecosystem functioning that are made without including resilience thinking may result in particularly dire consequences if the systems in question (also referred to as focal systems\cite{Rist2014,Allen2016}) are production ecosystems\cite{Rist2014,Brown2015} (ecosystems which are used by humans for resource allocation).

\clearpage

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Basic vocabulary of the ecological stability debate]{\textbf{Basic vocabulary of the ecological stability debate -} A few definitions that are key to the understanding of the resilience framework.}
    \begin{tabular}{|L{2.5cm}L{14cm}|}
    \hline
    \bfseries Term  & \bfseries Definition\\
    \hline
    \textbf{Attractor} 
    & A regime towards which a system moves asymptotically\cite{Scheffer2003, Rist2014, Tabacchi2009, Mumby2014, Angeler2016, Scheffer2001, Vasilakopoulos2015}. Also known as \textit{stable state}\cite{Foley2003}, \textit{(stable) equilibrium}\cite{Mumby2015} or \textit{regime}\cite{Tabacchi2009}. \\ \hdashline
    \textbf{Disturbance} 
    & Any impact that perturbs a systems trajectory from a given attractor\cite{Mouillot2013,Tabacchi2009,Standish2014, Grimm1997,Wardle2014}.
	\\ \hdashline  
    \textbf{Regime shift} 
    & The restructuring of a system from one set of dominant processes and feedbacks governed by one attractor to an alternate set governed by an alternate attractor\cite{Seddon2014,Scheffer2003,Mori2013,Rist2014, Selkoe2015}. Also known as \textit{tipping point}\cite{Scheffer2010} or \textit{bifurcation}\cite{Vasilakopoulos2015}.
	\\ \hline
    \textbf{Ecological Resilience} 
    & '[...] measures the magnitude of disturbance that can be absorbed before the ecosystem's structure changes'\cite{DeKeersmaecker2015}. Also known as \textit{General resilience}\cite{Angeler2016}.
    \linebreak Ecological resilience is a measure of how much a system can be changed until it shifts from one stable state/attractor to another\cite{Hodgson2015, Holling1973, Peterson1997, Angeler2016, DeKeersmaecker2015, Brown2015, Standish2014, Gunderson2000}.\\ \hdashline
    \textbf{Engineering Resilience} 
    & '[...] measures the speed of recovery after the disturbance'\cite{DeKeersmaecker2015}. Also known as \textit{Recovery}\cite{Standish2014}, \textit{Stability}\cite{Holling1973} or \textit{Resiliency}\cite{Angeler2016}.
    \linebreak Engineering resilience is a measure of how fast a system reverts to its pre-change state. It can be measured by assessing the return time\cite{Hodgson2015, Holling1973, Peterson1997, Angeler2016, DeKeersmaecker2015, Brown2015, Standish2014, Gunderson2000, Tabacchi2009}.\\
    \hline
    \end{tabular}%
  \label{tab:ResTerm}%
\end{table*}

Simultaneous assessment of components of any given ecosystem is a difficult task that often defies completion\cite{Standish2014}. This poses a **major research challenge** of choosing a measure by which to assess resilience and ecosystem components reliably through time and space. Consequently, recent studies have focussed on identifying and quantifying sub-components of ecosystem  resilience\cite{Seddon2016,Redmond2017,Papagiannopoulou2017,Gazol2017}. This is especially the case in remote sensing research where data availability is largely determined through what data repositories are available.

Hodgson et al. tackled this problem by building a framework for resilience assessments representing resilience as two separate entities: (1) *Resistance* to perturbation and (2) *Recovery* from perturbation\cite{Hodgson2015}. 

Recovery rates have been used as proxies for resilience metrics in many study settings including (1) palaeoecological research (e.g. by linking recovery rates of tropical ecosystems and disturbances categories\cite{Cole2014}), (2) observational studies (e.g. drought-impacts across different temporal and spatial scales\cite{Reyer2015}), and (3) experimental research (e.g. through applying small-scale disturbances and recording recovery rates\cite{VanBelzen2017a}).

The *resistance* and *recovery* aspects of the Hodgson et al. framework to resilience can be represented through \textbf{ecological stress memory} (also know as 'ecological memory', see table \ref{tab:MemTerm} for definitions of bold font terms relating to the ecological memory framework). Whilst ecological memory is often understood to be simultaneous with *adaptation to disturbances* resulting in increased biological fitness int eh face of repeated stress events\cite{Walter2013}, my study employs **ecological memory as a proxy for recovery rates**.

Nyström \& Folke reported a direct link between spatial resilience and ecological memory of coral reefs\cite{Nystrom2001}. In forest ecosystems, a positive link between ecological memory and ecosystem resilience has been identified by Johnstone et al\cite{Johnstone2016}. Additional support for this argument stems from remote sensing studies such as De Keersmaecker et al.\cite{DeKeersmaecker2015} and Seddon et al.\cite{Seddon2016} who identified autoregressive coefficients of vegetation properties as proxies of engineering resilience.

However, even quantifying ecological memory of an entire ecosystem is difficult as ecological memory is a compound metric unifying a multitude of sub-processes\cite{Walter2013}. For example, the aforementioned Nyström \& Folke recognised legacies, mobile links, and support areas as parts of ecological memory\cite{Nystrom2001} whilst Jonstone et al. propose information and material legacies as the key factors of ecological memory\cite{Johnstone2016}. Hence, ecosystem-scale studies have refocussed their attention on identifying components of ecological stress memory such as \textbf{vegetation memory}\cite{Walter2013,Johnstone2016}.  

\clearpage

## Vegetation Memory

Ecological memory effects can be understood as the influence of antecedent conditions on ecosystem properties given contemporary disturbance regimes\cite{Liu2018,Ogle2015}. The existence of such temporal effects emphasize the necessity of considering time in ecological frameworks by providing a link between antecedent environmental conditions and plant performance\cite{Seddon2016,Munne-Bosch2013,Papagiannopoulou2017a,Walter2013}. In fact, there is empirical evidence that past conditions inform contemporary vegetation morphology\cite{Walter2013}, phenology\cite{Liu2018}, primary productivity\cite{Ogle2015,Rudgers2018}, species composition\cite{Esper2015,Walter2013}, and carbon cycles\cite{Papagiannopoulou2017a,Liu2018}. Studying vegetation memory sheds light on an important set of ecosystem processes which contain an outstanding potential to make ecosystems resilient in the face of climate change\cite{Walter2013}.

### Terminology
Vegetation memory can - in the broadest of terms - be understood as:

\begin{center}
\textbf{\textit{The impacts of antecedent conditions on current vegetation
productivity.}}\cite{Liu2018,Ogle2015,Walter2013,DeKeersmaecker2015}
\end{center}

In a comprehensive paper, Ogle et al. expanded on this definition by identifying the following three important characteristics to vegetation memory\cite{Ogle2015}:
\begin{enumerate}
\item \textit{Length} - The extent of time through which past conditions significantly affect the current state of vegetation.
\item \textit{Strength} - The magnitude of the effect that past events/conditions have on the current state of vegetation
\item \textit{Temporal Patterns} - The variation in relative impacts of antecedent conditions at different points in time.
\end{enumerate}

Tackling the characteristic of vegetation memory origin, Ogle et al. introduced the notion of **intrinsic** and **extrinsic** memory effects\cite{Ogle2015} (see table \ref{tab:MemTerm} and figure \ref{fig:SchemaVegMem}). 

Due to the complexity of extrinsic memory components and drivers I find it useful to add another criterion to extrinsic memory characteristics: \textit{Extrinsic Source}. This represents the nature of the antecedent extrinsic conditions that drive current states of vegetation (i.e. the origin/source of the extrinsic memory effect), including (but not limited to): herbivory pressure or climate events.

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Basic vocabulary of the vegetation memory framework]{\textbf{Basic vocabulary of the vegetation memory framework -} A few definitions that are key to the understanding of vegetation memory and its components.}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries Term  & \bfseries Definition\\
    \hline
    \textbf{Ecological Memory} & Ecological memory is synonymous with information and material legacies: adaptations, individuals, and materials that persist after a disturbance and drive the responses to future disturbances\cite{Johnstone2016,Nystrom2001}.
\\ \hdashline  
    \textbf{Vegetation Memory} & Vegetation memory is defined as any response of a single plant or vegetation compounds after following disturbance event that alters the response of the plant/plant community towards future stress events. This includes a modification of interaction with other ecological components\cite{Walter2013}.\\ \hline
    \textbf{Intrinsic Memory} & Intrinsic memory refers to the influence of antecedent conditions of the focal system in determining contemporary conditions of the same system. Also known as \textit{endogenous memory}.\cite{Ogle2015} \\ \hdashline
    \textbf{Extrinsic Memory} & Extrinsic memory refers to the influence of antecedent conditions of the environment (usually abiotic, climate factors) in determining contemporary conditions of the focal system. Also known as \textit{exogenous memory}.\cite{Ogle2015} \\ \hline
    \end{tabular}%
  \label{tab:MemTerm}%
\end{table*}

\clearpage

### Ecological Relevance
Vegetation memory is identified as the effect of antecedent conditions on current vegetation patterns\cite{Ogle2015}. The stronger and longer the memory effect, the more vegetation will be influenced by antecedent anomalies of the ecosystem and abiotic processes thus signalling higher sensitivity to these drivers\cite{DeKeersmaecker2015}. A higher sensitivity translates to lower resilience and so:
\begin{center}
\textbf{Vegetation memory has been proposed as a proxy for engineering resilience.}\cite{Liu2018,DeKeersmaecker2017}
\end{center}

Patterns and characteristics of vegetation memory are a vital information criterion for \dss aimed at conservation or management efforts due to the inverse relationship between vegetation memory and engineering resilience. 

Additionally, vegetation memory is a compound metric which may be driven via a variety of forcing factors\cite{Seddon2016}. Thus making use of the differentiation of *intrinsic* and *extrinsic* components of vegetation memory by Ogle et al.\cite{Ogle2015} aids in gaining additional understanding of what local vegetation reacts to.

### Quantifying Vegetation Memory
Vegetation memory is influenced by a multitude of processes which range from abiotic characteristics\cite{DeKeersmaecker2015,Seddon2016,Papagiannopoulou2017a} to biotic system components\cite{Johnstone2016,DeKeersmaecker2015}. Comprehensive studies of vegetation response to biotic and abiotic forcing are numerous\cite{Liu2018,Seddon2016,Papagiannopoulou2017a,Ogle2015,Cole2014,Seddon2016}. 

#### Traditional Approaches

Traditional studies of vegetation memory leverage data obtained via extensive sampling campaigns and are thus laborious to carry out. Nevertheless, a multitude of such studies exist which provide a solid foundation for the understanding of ecological memory to date. 

Some traditional approaches - like Johnstone et al.\cite{Johnstone2016} - establish theoretical frameworks of vegetation memory (i.e. as material and information legacies) which require empirical assessment through further research.

One such study identified vegetation memory as spectral reddening as a proxy of spatial correlation of ecosystem properties. Increased spatial correlation is regarded as a proxy of high memory and ecosystems approaching regime shifts\cite{Kefi2014}. Additionally, these largely field-based studies are able to make use of a host of information criteria including but not limited to seed banks, wood thickness, canopy structure, and root depth\cite{Filotas2014}. Such information is often invaluable as it highlights the functional property of vegetation memory which is often identified through vegetation responses to different disturbances but rarely explained in terms of plant function that enables memory.

Due to limited sampling effort, such traditional studies are - although vitally important for our understanding of vegetation memory pathways - limited in scope. This will often lead to an advanced causal understanding of vegetation memory but only at limited spatial and temporal extents.

#### Remote Sensing Approaches

Remote sensing studies forego tedious field work data collection efforts and rely solely on easily available data. This data may either be obtained via remote sensing methods (i.e. satellite or drone imagery) or be pulled from published data sets from the field.

Using these data sets, remote sensing studies of vegetation memory offer vast improvements in spatial and potentially temporal coverage when compared to traditional approaches. This, in turn, allows for landscape-scale patterns of vegetation memory characteristics to be identified. Unfortunately, to achieve these large spatial extents, one often has to sacrifice patial and temporal resolution. Especially climate data can be unreliable in some regions of the world when field measurements are sparse.

Recent remote sensing studies of vegetation memory have established a multitude of approaches to delineating vegetation memory from a variety of data sets. Examples include the use of:


\begin{enumerate}
\item \textbf{Correlation coefficients} of different lags of drought indices. 
\end{enumerate}

Prominent examples of these approaches (e.g. Vicente-Serrano et al.\cite{Vicente-Serrano2013}, and Liu et al.\cite{Liu2018}), identify vegetation characteristics through time via the \ndvi (aggregated from bi-weekly records to monthly maximum composites). Drought characteristics are usually assessed either via the \spei or \spi. Additionally, data is assessed for certain quality criteria (e.g. monthly \ndvi $< .1$) and standardised. Subsequently, correlation coefficients asses how well \ndvi and drought index anomalies co-incide (strength of memory, A in figure \ref{fig:Vincente}) and at what temporal lag these coefficients are the most relevant (length of memory, B in figure \ref{fig:Vincente} and figure \ref{fig:Liu}).

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Vincente.png}
\caption[Drought Memory Length and Strength]{\textbf{Drought Memory Length and Strength - }Spatial patterns of drought memory length assessed via correlation coefficients. Figure lifted from Vicente-Serrano et al\cite{Vicente-Serrano2013}.}
\label{fig:Vincente}
\end{figure}

\clearpage

\begin{figure}[h!]
\centering \includegraphics[width=.9\linewidth]{3 - Figures/Liu.png}
\caption[Water Memory Length]{\textbf{Water Memory Length - } Spatial patterns of water memory length assessed via correlation coefficients. Figure lifted from Liu et al\cite{Liu2018}.}
\label{fig:Liu}
\end{figure}

\begin{enumerate}
\setcounter{enumi}{1}
\item \textbf{Mixed effect models} of antecedent vegetation and climate characteristics and subsequent model selection.
\end{enumerate}

In their 2015 paper, De Keersmaecker et al. introduced a comprehensive vegetation memory modelling approach using \ndvi, temperature, and \spei data in a linear mixed effect model. Again, certain data preparation steps such as removal of low-quality data, calculation of maximum monthly composites of \ndvi and subsequent standardisation were carried out. Climate data which did not meet the same spatial resolution as the \ndvi data was resampled using the nearest neighbour method. Study results of the **first autoregressive model** (\ndvi data regressed via \ndvi data a previous time step, also referred to as *intrinsic memory*) are presented in figure \ref{fig:DeKeers}.

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/DeKeers.png}
\caption[Intrinsic Vegetation Memory]{\textbf{Intrinsic Vegetation Memory - } Autoregressive coefficients of intrinsic vegetation memory depicting engineering resilience (high memory scores identify low resilience). Figured lifted from De Keersmaecker et al\cite{DeKeersmaecker2015}.}
\label{fig:DeKeers}
\end{figure}

Seddon et al.\cite{Seddon2016} delineated autoregressive \ndvi patterns very similar to those presented in figure \ref{fig:DeKeers}.

<!-- Seddon et al. -->

<!-- \begin{figure}[h!] -->
<!-- \centering \includegraphics[width=.7\linewidth]{3 - Figures/Seddon.png} -->
<!-- \caption[Short]{\textbf{Short - }Long\cite{Seddon2015}} -->
<!-- \label{fig:Seddon} -->
<!-- \end{figure} -->

<!-- \begin{enumerate} -->
<!-- \setcounter{enumi}{2} -->
<!-- \item \textbf{Bayesian models} to distinguish intrinsic and extrinsic memory effects.  -->
<!-- \end{enumerate} -->

\clearpage

#### Synthesis

\paragraph*{Models}  \hspace{.5cm}

Some common modelling practices have emerged from contemporary remote sensing vegetation memory studies: 
\begin{enumerate}
\item \textbf{Intrinsic Memory} is usually identified as the relationship between vegetation properties at time step $t$ a prior time $t-1$ (usually at monthly intervals)\cite{DeKeersmaecker2015}. See figure \ref{fig:SchemaVegMem} for a visual representation.
\item \textbf{Extrinsic Memory} is attributed to combinations of temperature, precipitation, and/or drought records\cite{Liu2018,Vicente-Serrano2013,DeKeersmaecker2015,Ogle2015}. See figure \ref{fig:SchemaVegMem} for a visual representation.
\item \textbf{Model Selection} is used to determine the length of extrinsic memory effects by identifying the time window during which extrinsic forcing holds the most explanatory power of vegetation characteristics\cite{Liu2018,Vicente-Serrano2013,DeKeersmaecker2015}.
\item \textbf{Anomalies} (i.e. standardised records) of both response and predictor variables are used as these are metrics which can be linked directly to perturbation events\cite{DeKeersmaecker2015}.
\end{enumerate}

Vegetation memory models can thus usually be summarised as:

\begin{equation}
Y_t = \alpha * Y_{t-1} + \sum_{e = 1}^{E}(\beta_e * X_e)
\end{equation}

with $Y_t$ and $Y_{t-1}$ denoting anomalies of vegetation properties at times $t$ and $t-1$ respectively, $X_e$ indexing anomalies of the $e$'th extrinsic force (out of a total $E$ extrinsic drivers), and $\alpha$ and $\beta$ representing the **coeffcients** of **intrinsic** and **extrinsic** memory effects respectively. Rerunning such a model with independent, extrinsic inputs ($X_e$'s) at different time lags and subsequent model selection can then be employed to identify the length of the extrinsic vegetation memory related to the $e$'th extrinsic force.

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Scheme_VegMem.jpg}
\caption[Components of Vegetation Memory]{\textbf{Components of Vegetation Memory - }Conceptual layout of how intrinsic and extrinsic vegetation memory components can be identified. The concept recognises two important variables: (1) \textit{Response} - contemporary vegetation properties at time $t$, and (2) \textit{Extrinsic} - antecedent environmental data. Within this framework, vegetation memory - both intrinsic and extrinsic - is identified as the predictability of the response variable through a regression onto itself and extrinsic variables respectively. Regressions of data onto each other are visualised as dashed arrows, lag effects are identified by numbers. Some parts of this figure have been generated via \ref{rFigs}.}
\label{fig:SchemaVegMem}
\end{figure}

\clearpage

\paragraph*{Spatial Memory Patterns}  \hspace{.5cm}

Results of the studies above clearly indcate some areas of special interest: 

\begin{enumerate}
\item \textit{High Memory Coefficients} indicating regions of low resilience can be found largely in \textit{dryland regions} (e.g.: North-East Brazil, Australia, and Spain; figures \ref{fig:Vincente} and \ref{fig:DeKeers}).
\item \textit{Trends in Memory Length} signalling a change in causal patterns of memory effects can be found across the Iberian Peninsula, and the contiguous United States of America. See figures \ref{fig:Vincente} and \ref{fig:Liu}.
\end{enumerate}

Furthermore, all of these regions are characterised by gradients in vegetation memory intensity (figures \ref{fig:Vincente} and \ref{fig:DeKeers}). Remote sensing vegetation memory should thus focus on the above listed **dryland regions** characterised by **shifts in memory properties**.

\paragraph*{Data}  \hspace{.5cm}

Vegetation properties are usually assessed using \ndvi data. Additionally, indices of climate metrics are used for the calculation of extrinsic memory components. 

Contemporary studies of vegetation memory largely rely on *precipitation* or *drought* data obtained via the \spei drought index\cite{DeKeersmaecker2017,DeKeersmaecker2015}, and the \cru data set\cite{Liu2018}. These data sets are *observational* data sets as they are built from observational data often involving simple interpolation methods\cite{Trzaska2014}. Climate science has developed novel data sets which are more advanced than simple observational data sets. Thse are known as climate reanalysis products.

**Climate reanalysis** data sets are *self-consistent*, *gap-less* (in time and space) and thus **superior** to many observational data sets. One such reanalysis data set is the \textbf{\era}\cite{Era5Online}. The superiority of \era over frequently used climate data sets is largely due to:

\begin{enumerate}
\item The \textbf{volume of observational data} used to create the \era product with data types ranging from satellite data to weather station/independent institute data collection efforts, and station data from a wide variety of data providers\cite{ECMWF2018a}. Traditional, observational data sets are often characterised by their individual biases in sampling, and coverage representativeness. 
\item Its \textbf{sophisticated nature} building upon data assimilation procedures\cite{ECMWF2018b}, and complex models\cite{ECMWF2018} to shed light on physical processes\cite{ECMWF2018c}. As such, \era is currently the \textit{state-of-the-art} climate reanalysis product in climate science and benefits from the developments in data assimilation methodology, understanding of physics of the climate system and their interactions, which have come about in recent decades.
\end{enumerate}

Finally, \era improves on other prominent climate data sets in ecological studies like the aforementioned \cru and \spei, WorldClim (used by Seddon et al.\cite{Seddon2016}), or the \chelsa data set\cite{Bruelheide2018} in a multitude of ways since it offers:
\begin{enumerate}
\item Superior \textit{Temporal Resolution} (superior resolving of climate extremes)
\item Superior \textit{Spatial Resolution} (advanced resolving of local/topographical features)
\end{enumerate}

Therefore, one can reasonably expect to improve on contemporary vegetation memory studies by substituting observational climate data sets with the highly advanced \era data set.

In addition, none of the contemporary vegetation memory studies on landscape-scales include biological ground-truthed data such as the aforementioned indices of functional aspects to plants which traditional approaches can leverage through measures of **Plant Function** and thus aren't posed to identify biological causal pathways of vegetation memory

\clearpage

## Plant Function
<!-- Studies of biotic forcing usually fall into one of two categories which can be seen as research representative of the world views of Schimper (focus on functional diversity) and Hubbel (focus on species diversity)\cite{Westoby2006}. Whilst the latter represents traditional approaches to understanding the natural world, Schimpers framework has received increased attention over the past few years. This paradigm shift is due to the compelling evidence that a focus on functional aspects of biological systems may yield refined understandings of the natural world than species-focused studies\cite{DeBoeck2017}. -->

A functional approach to ecosystem processes can potentially explain what functional expressions allow said processes to persist despite perturbations\cite{DeBoeck2017,Truchy2015,Mace2014,Lavorel2002}. One of the most prominent tools of such studies is the *functional trait framework*. Arguabely, the most important of these frameworks when understanding vegetation processes - such as vegetation memory - is that of **Plant Functional Traits (PFTs)** and **Life History Traits (LHTs)**.  

Functional traits (encompassing PFTs and LHTs) capture a multitude of characteristics without the necessity for a focus on phylogenies of study organisms\cite{Nock2016} thus making landscape-scale studies (such as remote sensing approaches) required for identifying vegetation memory patterns possibly. The diverse range in which measures of plant function can be expressed are representative of the diverse strategies for establishing, growing and reproducing of plants\cite{Laughlin2014}. Hence, understanding how plant functioning enables plants to persist despite (a)biotic forcing (i.e. vegetation memory) is a promising first step to understanding ecosystem-scale responses to climate change.

### Terminology
\PFT frameworks (see table \ref{tab:PFTTerm} for definitions of bold font terms relating to \PFTs) have been linked to evolution\cite{Ackerly2003} and community composition patterns\cite{Laughlin2014,Lavorel2002}. A change in their expression has been found to be correlated with climate change patterns\cite{Wright2005} potentially suggesting a causal link between extrinsic vegetation memory and \PFT expressions. To classify the way in which \PFTs are related to community functions, Nock et al. present the concept of (1) \textbf{Effect Traits}, and (2) \textbf{Response Traits}\cite{Nock2016}. Classifying \PFTs according to this framework can profoundly aid the understanding of their influence on spatio-temporal patterns of vegetation performance\cite{Lavorel2002,Mori2013}. Effect traits determine how \PFTs alter ecosystem processes (predominantely driving post-disturbance recovery) whilst response traits affect how vegetation reacts to perturbations (signifiying resistance potential).

Recent studies suggest that vegetation community functions are governed by integrated phenotypes, which can be regarded as combinations of \PFT ranges\cite{Bonser2006, Nock2016} thus calling for a scientific approach focussed on \textbf{\FDR} which can be identified via an approach in which \PFT values of each individual are placed within a multidimensional system with each axis representing the range of values for one specific \PFT\cite{Ordonez2015}. Additonally, one may also want to use a measure of evenness which, in a functional biology setting, can be referred to as \textbf{\FDD} which is representative of how evenly dispersed data records are in multidimensional space.


<!-- Just as with species oriented studies, a measure of richness alone may be insufficient to capture necessary information to understanding biological systems. Therefore, one may also want to use a measure of evenness which, in a functional biology setting, can be referred to as \textbf{\FDD} which is representative of how evenly dispersed data records are in multidimensional space.   -->

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Basic vocabulary of Plant Functional Trait frameworks]{\textbf{Basic vocabulary of Plant Functional Trait frameworks -} A few definitions that are key to the understanding of Plant Functional Trait frameworks.}
    \begin{tabular}{|L{3.5cm}L{13cm}|}
    \hline
    \bfseries Term  & \bfseries Definition\\
    \hline
    \textbf{Plant Functional Traits (PFTs)} & Plant Functional traits characterise morphological, biochemical, physiological, structural, phenological and/or behavioural aspects of organisms which influence the fitness of said organisms\cite{Nock2016}.\\ \hdashline  
    \textbf{Effect Traits} & These determine a species influence on ecosystem processes\cite{Nock2016}.\\ \hdashline  
    \textbf{Response Traits} & These determine a species ability to colonise a certain habitat and persist despite environmental pressures\cite{Nock2016}.\\ \hline  
    \textbf{Functional Diversity Richness (FDR)} & Functional diversity richness measures the range of the PFT spectrum of a given study region/species assembly in multivariate trait space via a multivariate convex hull effectively measuring niche space\cite{Ordonez2015}.\\ \hdashline
    \textbf{Functional Diversity Dispersion (FDD)} & Functional diversity dispersion measure the dispersion of PFT values in multivariate trait space with respect to the local functional space centre effectively measuring niche segregation\cite{Ordonez2015}.\\ \hline
    \end{tabular}%
  \label{tab:PFTTerm}%
\end{table*}

\clearpage

Identifying \FDR and \FDD requires a lot of indivudal \PFT data and so contemporary studies in \PFT research have focussed heavily on methods of dimensionality reduction by identifying the \PFTs which capture a vast part of the global variation of plant function\cite{Laughlin2014,Diaz2015}. One such framework has been established in theory by Westoby \& Wright in which three important \PFT dimensions are recognised: (1) the leaf economic spectrum, (2) the seed size/mass spectrum, and (3) the height of the canopy at maturity\cite{Westoby2006}. Using an empirical approach, Díaz et al. identified:
\begin{enumerate}
\item \textit{Vegetative height} ($H$) - an important criterion to accessing light resources
\item \textit{Stem specific density} ($SSD$) - reflecting a trade-off between growth potential and mortality risk
\item \textit{Leaf area} ($LA$) - vital consequences for leaf water balance
\item \textit{Leaf mass per area} ($LMA$) - a proxy for the trade-off between carbon gain and leaf longevity
\item \textit{Leaf nitrogen content} ($Nmass$) - reflects a trade-off between photosynthetic potential and acquiring nitrogen
\item \textit{Diaspore mass} ($Dmass$) - reflects a trade-off between seedling survival and colonization ability
\end{enumerate}
as the most important \PFTs to understanding the global spectrum of plant functioning\cite{Diaz2015}. Recovery rates of vegetation post-disturbance (i.e. vegetation memory) is influenced by energy and biomass availability. Resource allocation and hence recovery potential using the above six traits is best understood employing $H$, $lMA$, and $Nmass$ due to their direct link to realising photosynthetic potential.


\PFTs convey information as *snapshots* of reality as their data sets usually do not contain repeated measures of the same individuals over a period of time. Another set of metrics related to plant characteristics through time are \textbf{\LHT} frameworks (see table \ref{tab:LHTTerm} for definitions of bold font terms relating to \LHTs). Despite recording expressions of plant function, \LHTs capture different information than \PFTs and should thus be regarded as *complementary* to \PFTs. Prominent examples of \LHTs include measures relating to (1) **System Turnover**, (2) **Longevity**, (3) **Growth**, and (4) **Reproduction**. Expressions of \LHTs explain temporal community processes and may thus be major drivers of ocal vegetation memory expressions.


\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Basic vocabulary of Life History Trait frameworks]{\textbf{Basic vocabulary of Life History Trait frameworks -} A few definitions that are key to the understanding of Life History Trait frameworks. Largely influenced by Salguero-Gómez et al\cite{Salguero-Gomez2016}.}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries Term  & \bfseries Definition\\
    \hline
    \textbf{Life History Traits (LHTs)} & LHTs characterise life history processes of populations and thus identifying temporal aspects of their life cycles.\\ \hline  
    \textbf{System Turnover} &  \\
    \textit{Generation Time} & The time needed to fully replace a population by a new cohort. \\ \hdashline
    \textbf{Longevity} & \\
    \textit{Survivorship Curve} & Shape of age-specific survivorship curve type. \\ 
    \textit{Age at Sexual Maturity} & Time it takes for an average individual of a population to become sexually reproductive. \\ \hdashline
    \textbf{Growth} & \\ 
    \textit{Progressive} & Mean probability to advance in life stages. \\ 
    \textit{Retrogressive} & Mean probability to regress in life stages. \\ \hdashline
    \textbf{Reproduction} & \\ 
    \textit{Net Reproductive Rate} & Mean number of recruits produced by each individual in the population. \\
    \textit{Degree of Iteroparity} & Spread of reproduction during the lifespan of an individual. \\ 
    \textit{Mature Life Expectancy} & Time between age of sexual maturity and life expectancy. \\ \hline
    \end{tabular}%
  \label{tab:LHTTerm}%
\end{table*}

\clearpage

### Ecological Relevance  
The positive effect of biodiversity on ecological stability has long been recorded\cite{DeBoeck2017} and even led to the formulation of prominent concepts like Yacchi's insurance hypothesis which postulates that the loss of a subset of species can be compensated for by the presence of other species given a sufficient overlap in functional aspects of both thus leading to a stabilisation of ecosystem processes\cite{Yachi1999}. 

\begin{center}
\textbf{\PFTs and \LHTs capture information about a variety of ecosystem processes.}\cite{Butler2017}
\end{center}

Most studies to date have focussed on species diversity\cite{Vasilakopoulos2015,Cote2010,Brown2015}. Some made use of the concept of functional species\cite{Gunderson2000} which presents researchers with a species classification system that is vague at best due to loose definitions of where to draw the lines between functional species. Functional trait biology, which captures the functional diversity of biological systems, is often employed as an improvement to the functional species/type concept\cite{Munne-Bosch2013,Walter2013} as it eliminates the necessity of phylogenetic analyses\cite{Nock2016} and enables studies to capture intra-specific variation\cite{Violle2012,Dantas2013,Kattge2011}.

\begin{center}
\textbf{\PFTs and \LHTs can be captured irrespective of species relationships.}\cite{Dantas2013}
\end{center}

Thus, \PFTs and \LHTs make for \textit{highly informative} proxies of \textit{ecosystem functioning} which can be recorded across \textit{large spatial and temporal scales} since studies aren't constrained to a handful of species. Additionally, \PFTs and represent an improved understanding of functional expressions of plant communities by \textit{expressing information at sub-species level}\cite{Violle2012}.

Recent research based upon \LHT data, for example, has revealed robust trade-off axes in plant\cite{Salguero-Gomez2016,Salguero-Gomez2017} as well as animal life histories\cite{Capdevila2018,Healy2018}. These axes are usually referred to as the \textbf{\fsc}\cite{Salguero-Gomez2016,Healy2018,Salguero-Gomez2017,Paniw2018}. Information about \LHTs has been demonstrated to be of use in trying to understand biological responses to temporal phenomena\cite{Paniw2018} and should thus prove crucial in delineating causal, biological pathways to establishing vegetation memory. 


### Unifying Information on Plant Functional Traits
\PFTs are usually recorded through individual trait campaigns or for single-study purposes. Combining \PFT information from these individual data sets can prove challenging due to different measurement practices and understandings of \PFTs. A comprehensive handbook on \PFT data collection practices by Pérez-Harguindeguy et al.\cite{Perez-Harguindeguy2013} presents an elegant solution to making \PFT data sets more comparable. Additionally, \PFT data sets have been aggregated into large data bases within online repositories such as:
\begin{itemize}
\item The \textbf{\TRY}\cite{Kattge2011} is data base of \PFT records connecting vegetation scientists across the globe and hosted by the \idiv. Within it's current release version (version 4) \TRY contains almost seven million \PFT records for 1,800 traits with about half of all records being geo-referenced\cite{TRYOnline}.
\item The \textbf{\BIEN}\cite{Enquist2009} is a repository of global plant diversity, function, and distribution. Its current release (version 4.1) contains over 200 million records at global coverage\cite{BIENOnline}.
\end{itemize}

<!-- (see figure \ref{fig:BIEN4}) -->
<!-- \begin{figure}[h!] -->
<!-- \resizebox{1\textwidth}{!}{\includegraphics[width=\linewidth]{3 - Figures/bien4.jpg}} -->
<!-- \caption[BIEN PFT Coverage]{\textbf{\BIEN \PFT Coverage - }Geo-referenced records within version 4.1 of the \BIEN data base at logarithmic scale\cite{BIENOnline}.}  -->
<!-- \label{fig:BIEN4} -->
<!-- \end{figure} -->

\begin{itemize}
\item The \textbf{\COMPADRE}\cite{Salguero-Gomez2015} contains \LHT, a subclass of \PFTs pertaining to life history characteristics (e.g. longevity, reproductive mode, etc.), driven matrix population models which produce important information about community processes through time based on records of different \LHTs\cite{Salguero-Gomez2016}. In its current release (version 5.0.0) it contains over 7,00 matrix models\cite{COMPADREOnline}.
\end{itemize}

Combining information from these data bases should result in a holistic view of global plant function as such an approach would unify \PFTs and \LHTs to further a spatio-temporal understanding of global plant function.

### Putting Plant Function on the Map
Vegetation memory patterns are inherently spatial phenomena\cite{DeKeersmaecker2015,Ogle2015,Vicente-Serrano2013,Liu2018}. So are patterns of plant functioning\cite{Ordonez2015}. Whilst the above mentioned data bases (\TRY, \BIEN, and \COMPADRE) contain vast amounts of geo-referenced \PFT and \LHT records, almost no comprehensive, gapless, and internally consistent global products of plant function are available\cite{Butler2017,Bruelheide2018}.  

Currently, the most commonly used method for extrapolating \PFT records to local/global map products follows the methodology layed out by Ordonez \& Svenning\cite{Ordonez2015} which has species-specific \PFT means being combined with geo-referenced species occurrences (a conceptual depiction of this can be seen in figure \ref{fig:PFTCombining}).

\begin{figure}[h!]
\includegraphics[width=1\linewidth]{3 - Figures/PFTCombiningbw.png}
\caption[Concept of Combining Plant Functional Trait Information with Species-Distribution Maps]{\textbf{Concept of Combining Plant Functional Trait Information with Species-Distribution Maps - }Conceptual framework of mapping plant function from \PFTs and species distribution maps into gridded map products of mean \PFT expressions. Inspired by Ordonez \& Svenning\cite{Ordonez2015}. Red cells indicate presence of a species, blue and yellow cells depict the average \PFT of species A and B respectively. Green cells represent the average of \PFT means of species A and B whilst white cells denote the absence of species and thus \PFT data.} 
\label{fig:PFTCombining}
\end{figure}

Species occurrence data - referred to as **floral data** in the case of plant occurrences - can be obtained via the \textbf{\GBIF} data base which currently contains over 1 billion geo-referenced occurrence records of species across all kingdoms of life\cite{GBIFOnline}.

Unfortunately, this approach is heavily reliant on geo-referenced occurrence records which are subject to sampling bias\cite{Sandel2015} and renders intra-specific expressions of \PFTs virtually non-existent as species are expressed via single mean values for each \PFT. Zoological studies have resolved these issues by recording relative abundances of species in addition to occurrence records\cite{Newbold2012}.  

Recent approaches in \PFT ecology have seen the development of mapping procedures of \PFTs according to abiotic conditions through linear models with spatial components\cite{Bruelheide2018} and complex Bayesian methods\cite{Butler2017}. No such method is available for extrapolating \LHT records to broader coverage as these come with an added dimension of time.

Despite the obvious short-commings of this mapping method, including \PFT and \LHT data to remote sensing vegetation memory studies is a novel approach in itself. This is built around the notion of vegetation memory being driven not only by antecedent conditions but also by functional characteristics of the local vegetation. Making use of the above \PFT extrapolation method thus serves as an exploratory analyses of how well it performs when trying to extract causal pathways leading to vegetation memory.

\clearpage 

## Thesis Outline
Remote sensing analyses have been the key to identifying vegetation memory patterns through time and space in a multitude of settings\cite{Liu2018,Vicente-Serrano2013,DeKeersmaecker2015}. Refining such approaches will facilitate important knowledge for \dss on environmental processes in the face of climate change as well as changes in land use by mankind\cite{Prestele2016}. Considering the direct link between vegetation memory and ecosystem resilience, this will garner an advanced comprehension of resilience and, in turn, enable maintenance and enhancement of ecosystems' resilience thus aiding to stabilize natural systems. It is therefore the **first main goal** (see figure \ref{fig:Outline} for an overview of how I am planning to achieve the research goals layed out here) of this study to:
\vspace{-.7cm}
\begin{center}
\item \textbf{I. Identify vegetation memory patterns while improving on contemporary approaches.}
\end{center}

To do so, I am going to answer the following research questions while focussing on dryland regions and \era data:
\begin{enumerate}
\item \textit{Using climate reanalysis data, which variables make up robust vegetation memory metrics?}
\item \textit{How well can we distinguish between intrinsic and extrinsic memory?}
\end{enumerate}
\vspace{.1cm}

A multitude of recent studies have identified vegetation memory characteristics of a diverse cast of focal ecosystems\cite{DeKeersmaecker2017,Liu2018,Papagiannopoulou2017a,Seddon2016,Peterson2002,Walter2013,Papagiannopoulou2017,Bell2018}. However, only a few of these have also delineated the ecological processes and causal pathways which have led to the observed patterns of vegetation memory. Achieving an understanding of how functional aspects of vegetation may alter vegetation memory capabilites should serve to bolster our understanding of how resilience comes about and can be maintained. Therefore, the **second main goal** of my thesis is to:

<!-- One notable example of these research efforts is a study by Foley et al. which expanded on the drivers behind the ecosystem collapse of the Sahara and Sahel regions\cite{Foley2003}.  -->

\vspace{-.7cm}
\begin{center}
\item \textbf{II. Determine how vegetation memory and plant function are linked.}
\end{center}

Achieving this goal is possible by answering the following research questions:
\begin{enumerate}
\item \textit{Which traits of biological function (\PFT and \LHT) are related to vegetation memory characteristics?}
\item \textit{What biological traits cause areas to exert intrinsic and extrinsic memory?}
\end{enumerate}

\begin{figure}[h!]
\centering \includegraphics[width=.95\linewidth]{3 - Figures/ThesisOutlinebw.png}
\caption[Study Outline]{\textbf{Study Outline - }Conceptual study flow-chart. Data sets and products are shown in boxes with solid outlines whilst data handling and computational procedures are depicted via dashed-outline boxes.} 
\label{fig:Outline}
\end{figure}



# Material \& Methods

## Study Regions  

The spatial extent of study sites for assessing vegetation memory effects was limited to regions which were (1) suitable for remote sensing studies, (2) relatively well-sampled in terms of \PFTs, \LHTs and floral data, and (3) contain large areas classified as \textbf{drylands}. Since vegetation memory is largely researched in terms of water limitations and precipitation events, dryland regions (as classified via ombrotypes within Rivas-Martínez et al.\cite{Rivas-Martinez2011}) are expected to allow for identification of extrinsic memory effects. Within `R`, limiting to study regions is done using shapefiles (\url{http://www.naturalearthdata.com/downloads/10m-cultural-vectors/}) and the `rgdal`\cite{R-rgdal} package (see \ref{rFunctions}).

### Iberian Region

The Iberian region - said to encompass Portugal, Spain, Andorra and France within this study - has been selected as a study region due to a clear gradient in ombrotypes (see figure \ref{fig:OmbroEU}), its high density of \TRY \PFT and \COMPADRE \LHT data availability, and previously reportedly clear patterns of vegetation memory effects\cite{DeKeersmaecker2015} and vegetation sensitivity\cite{Seddon2016}. See figures \ref{fig:IBPDataOverview} and \ref{fig:IBPTRY} for an overview of \gimms \ndvi, \era data, and \TRY \PFT data (both raw and extrapolated) across the Iberian region.

\begin{figure}[h!]
\centering \includegraphics[width=.85\linewidth]{3 - Figures/Ombro_EU.png}
\caption[European Ombrotpyes]{\textbf{European Ombrotpyes - }Regions of mean precipitation rates of biological relevance across Europe according to Rivas-Martínez et al.\cite{Rivas-Martinez2011} and retrieved via the Worldwide Bioclimatic Classification System\cite{OmbroEU}.}
\label{fig:OmbroEU}
\end{figure}

\clearpage

### Caatinga, Brazil

The Caatinga in Brazil - a dryland region located within northeastern Brazil - has been selected as a study region due to a predominance in dry ombrotypes and gradients of ombrotypes at its edges  (see figure \ref{fig:OmbroSA}) as well as previously identified strong vegetation memory effects\cite{DeKeersmaecker2015}.

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Ombro_SA.png}
\caption[South-American Ombrotpyes]{\textbf{South-American Ombrotpyes - }Regions of mean precipitation rates of biological relevance across South-America according to Rivas-Martínez et al.\cite{Rivas-Martinez2011} and retrieved via the Worldwide Bioclimatic Classification System\cite{OmbroSA}.}
\label{fig:OmbroSA}
\end{figure}

See figures \ref{fig:CaatDataOverview} and \ref{fig:CaatTRY} for an overview of \gimms \ndvi, \era data, and \TRY \PFT data (both raw and extrapolated) across the Caatinga.

\clearpage

### Australia

Australia has been selected as a study region due to a predominance in dry and even arid ombrotypes as well as gradients of ombrotypes on its eastern coast  (see figure \ref{fig:OmbroAU}). Previous studies have identified clear patterns of vegetation memory across\cite{DeKeersmaecker2017,DeKeersmaecker2015}, vegetation sensitivity\cite{Seddon2016}, and water memory length and strength\cite{Gazol2017}.

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Ombro_AU.png}
\caption[Australasian Ombrotpyes]{\textbf{Australasian Ombrotpyes - }Regions of mean precipitation rates of biological relevance across Australasia according to Rivas-Martínez et al.\cite{Rivas-Martinez2011} and retrieved via the Worldwide Bioclimatic Classification System\cite{OmbroAU}.}
\label{fig:OmbroAU}
\end{figure}

See figures \ref{fig:AUDataOverview} and \ref{fig:AUTRY} for an overview of \gimms \ndvi, \era data, and \TRY \PFT data (both raw and extrapolated) across Australia.

\clearpage

## Identifying Vegetation Memory 
<!-- Identifying vegetation memory requires intrinsic data (e.g. proxies of vegetation performance), and extrinsic data (e.g. climate/weather indices)\cite{Ogle2015,DeKeersmaecker2015}. Measures of plant function or life histories (i.e. \PFTs and \LHTs) of local vegetation may be useful in uncovering causal pathways leading to vegetation memory behaviour. -->

### Data
#### Vegetation Indices
Patterns of vegetation characteristics - both in time and space - can be assessed readily using remote sensing approaches\cite{Seddon2016,Nioti2015,Prince1995,Garroutte2016,DeKeersmaecker2017,Cammarano2014,Friedl2002}.  A \vi is a remote sensing proxy for different vegetation characteristics depending on the choice of \vi.

\vis have seen various applications in remote sensing including deriving vegetation dynamics on the scale of countries\cite{Evrendilek2008,Colditz2012,Prasad2007} or regions\cite{Cammarano2014,Stow2004}, and analysing resilience of vegetation assemblages to short-term climate anomalies\cite{DeKeersmaecker2015}. Biome classifications have undoubtedly been one of the most prominent usages of the \vis\cite{Chen2007,Friedl2002, Lieng2002,Friedl2010} as have applications in agriculture\cite{Devadas2009,Ares2001}.  

Whilst a vast arsenal of \vis are available to macroecologists (see Cammarano et al. for an overview\cite{Cammarano2014}), one of the main considerations in  choosing an appropriate \vi is that of **spatial resolution versus length of time series**. As satellite-born sensors receive hardware updates or other improvements - e.g. \avhrr versus \modis sensors - spatial resolution capabilities of \vis increase. However, we can't enhance the resolution of older records of \vis and are thus limited to lower resolution \vis if longer time series are desired. Since vegetation memory is a temporal phenomenon first and foremost, I have prioritised **time series length** over spatial resolution. Within the confines of my thesis, \vis represent the intrinsic characteristics of vegetation systems which will both be used as response and explanatory variables as outlined in figure \ref{fig:SchemaVegMem}.

\paragraph*{Normalised Difference Vegetation Index (NDVI)}  \hspace{.5cm}

The \ndvi has been selected as a proxy of vegetation characteristics in this study due to (1) its nature as an information criterion of biomass\cite{Fuller1996} and vegetation cover\cite{Cammarano2014} (indicators of vegetation performance and composition), (2) the availability of a long time series data with global coverage\cite{Pinzon2014}, and (3) its demonstrated utility in various ecosystem studies\cite{Garroutte2016} including assessments of vegetation sensitivity and memory\cite{Vicente-Serrano2013,Seddon2016,DeKeersmaecker2015}. See table \ref{tab:NDVICore} for an overview of the core characteristics of the \ndvi data set.

Rouse et al.\cite{Rouse1974} first introduced the \ndvi in 1974 and initially coined it 'Vegetation Index'. The name was subsequently changed to \ndvi when other \vis were proposed in the ensuing years alongside the advent of remote sensing studies which relied on \vis\cite{Matsushita2007,Justice1985,Nioti2015}.  

The \ndvi is a composite \vi that factors in measurements in the near infra-red wave band (NIR, 0.58-0.68 $\mu$m) and the red wave band (RED, 0.75-1.10 $\mu$m). These bands belong to the spectrum of light that is absorbed by chlorophyll and thus provide information on green vegetation\cite{Hao2008}. The formula for \ndvi is as follows\cite{Evrendilek2008,Hao2008}:

\begin{equation}
NDVI = \frac{\rho\textsubscript{NIR} - \rho\textsubscript{RED}}{\rho\textsubscript{NIR} + \rho\textsubscript{RED}}
\end{equation}

with $\rho_{NIR}$ being the reflection in the NIR band and $\rho_{RED}$ being the reflection in the RED band. The \ndvi is bound between 0 and 1 with higher values representing denser vegetation. For a more detailed mathematical background on the calculation of \ndvi scores see Matsushita et al\cite{Matsushita2007}.  

\ndvi data sets are readily available via the \gimms. For this study the GIMMS3g data set was used (available at \url{https://ecocast.arc.nasa.gov/data/pub/gimms/3g.v1/}), which provides \avhrr NDVI data as 15-day maximum-value composites from 1982 to 2015 at $0.083^\circ \times 0.083^\circ$ resolution\cite{Higgins2016}. The data was processed in `R`, downloaded and compiled into monthly composites using the raster\cite{R-Raster} and `gimms` package\cite{R-Gimms}. See figure \ref{fig:NDVIOverview} for a representation of one such global monthly composite. \ref{rGimms} contains the `R`-code used to process the data. 

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Core Information about NDVI data]{\textbf{Core Information about NDVI data -} Characteristics of the \gimms NDVI3g data set (v.1).}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries Characteristic  & \bfseries Data\\
    \hline
    \textit{Resolution} & $0.083^\circ \times 0.083^\circ \sim 9.27km \times 9.27km$\\
    \textit{Time Series} & Bi-weekly intervals from January 1982 to December 2015 \\
    \textit{Source} & \url{https://ecocast.arc.nasa.gov/data/pub/gimms/3g.v1/} \\
    \hline
    \end{tabular}
  \label{tab:NDVICore}
\end{table*}

```{r NDVIOverview, echo = FALSE, fig.width = 17, fig.height = 9.5, fig.cap="\\textbf{Global Representation of the Normalised Difference Vegetation Index (NDVI) -} Mean of monthly maximum composite representations of \\ndvi from January 1982 to December 2015 at global coverage. Higher values of \\ndvi indicate higher vegetation coverage, plant biomass, and primary production. Figure established via \\ref{rNDVIOverview}. \\label{fig:NDVIOverview}", fig.scap="Global Representation of the Normalised Difference Vegetation Index (NDVI)", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
setwd(Dir.Gimms.Monthly)
NDVIMean_ras <- mean(brick(list.files()[1:7]), na.rm = TRUE)
plot(NDVIMean_ras, colNA = "black", main = "Mean NDVI 1982 - 2015", cex.main = 2, 
     legend.width = 1.5, legend.shrink=1, axis.args=list(cex.axis=1.5), cex.axis = 1.5
     )
```

\clearpage

#### European Centre for Medium-range Weather Forecasts ReAnalysis 5 (ERA5)
\label{sEra}

Extrinsic memory effects have largely been understood through processes of drought and water limitation\cite{Rudgers2018,Munne-Bosch2013,Gazol2018,Walter2013,Liu2018}. Hence a large number of contemporary studies of vegetation memory have included some form of information criterion on water availability, through precipitation records\cite{Papagiannopoulou2017a,Seddon2016}, or drought indices\cite{Liu2018,DeKeersmaecker2017,DeKeersmaecker2015}. Additionally, temperature has been found to be a major driver of drought severity, plant morphology, and vegetation memory effects\cite{Esper2015,Papagiannopoulou2017a,Seddon2016}. \era data is implemented into my analyses of vegetation memory using two environmental characteristics: (1) Soil Moisture (in four layers), and (2) Air Temperature (as observable at a height of 2m above the ground). See table \ref{tab:ERA5Core} for an overview of core characteristics of the \era data set.

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Core Information about ERA5 data]{\textbf{Core Information about ERA5 data -} Characteristics of the ERA5 data set.}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries Characteristic  & \bfseries Data\\
    \hline
    \textit{Resolution} & $\sim 30km \times 30km$\\
    \textit{Time Series} & Hourly intervals from January 1950 to TODAY \\
    \textit{Source} & \url{https://apps.ecmwf.int/data-catalogues/era5} \\
    \hline
    \end{tabular}
  \label{tab:ERA5Core}
\end{table*}

See \ref{ObtainEra5}, \ref{ProcessEra5}, and \ref{RegridEra5} for the codes used to download \era data from the \ecmwf servers, aggregate data to full time series and fix gridding mismatches to be comparable to \gimms data.


\paragraph*{Air Temperature recorded in $K$}  \hspace{.5cm}

Temperature indices have been linked successfully to vegetation sensitivity\cite{Seddon2016}, tree-ring growth\cite{Esper2015,Pagotto2015}, global primary production\cite{Prince1995}, as well as severe drought events with possibly devastating consequences to local vegetation\cite{Allen2010}. \era recognises several temperature variables (e.g. soil, snow and air temperature)\cite{ECMWF2018c}. Within this study, I  use \tair as contained within the \era data set, due to the demonstrated impact of \tair on different aspects of plant physiology and plant morphology which may manifest in vegetation memory effects. See figure \ref{fig:ATOverview} for an overview of the \era \tair data.

```{r ATPlot, echo = FALSE, fig.width = 17, fig.height = 7.5, fig.cap="\\textbf{Overview of air temperature data -} Air temperature data presented in as obtainable via the ERA5 reanalysis product (\\tair). Figure established via \\ref{rATOverview}. \\label{fig:ATOverview}", fig.scap="Overview of air temperature data", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
Variable <- c("Tair")
colour = col.tair
setwd(Dir.ERA)
Era5ras <- mean(brick(list.files()[grep(pattern = Variable, list.files())]), na.rm = TRUE)
values(Era5ras)[which(is.na(values(Elevation)))] <- NA
plot(Era5ras, colNA = "black", main = paste("Mean", SR_Titles[2], "1980 - 2015"), 
     cex.main = 2, legend.width = 1.5, legend.shrink=1, 
     axis.args=list(cex.axis=1.5), cex.axis = 1.5, col = colour, legend = TRUE)
```


\clearpage

**Soil Moisture** recorded in $\frac{m^3_{H_2O}}{m_{soil}^3}$   

\vspace{.2cm}

My study uses \textit{\qsoil} as a proxy of local water regimes. Precipitation events are subject to further soil processes such as pore connectivity for precipitation water to be available to plants\cite{Smith2017}. Soil moisture should thus serve as a much more direct proxy of local water regimes. Additionally, \era includes four distinct layers in the soil for the calculation of \qsoil indices (see figure \ref{fig:QsoilOverview} for an overview): (1) \qsoila, (2) \qsoilb, (3) \qsoilc, and (4) \qsoild. Typical drought indices (i.e. \spei) do not allow for this additional distinction.


```{r QsoilPlot, echo = FALSE, fig.width = 17, fig.height = 10.2, cache = TRUE, cache.lazy=FALSE}
Variable <- c("Qsoil1", "Qsoil2", "Qsoil3", "Qsoil4")
colour = col.qsoil
par(mfrow = c(2,2))
setwd(Dir.ERA)
Era_list <- list(NA, NA, NA, NA)
for(i in 1:4){
  Era5ras <- mean(brick(list.files()[grep(pattern = Variable[i], list.files())]), na.rm = TRUE)
  values(Era5ras)[which(is.na(values(Elevation)))] <- NA
  Era_list[[i]] <- Era5ras
}
Era5ras <- brick(Era_list)
Era5ras[1] <- max(Era5ras)@data@max
for(i in 1:4){
  plot(Era5ras[[i]], colNA = "black", main = paste("Mean", SR_Titles[i+2], "1980 - 2015"), 
       cex.main = 2, legend.width = 1.5, legend.shrink=1, 
       axis.args=list(cex.axis=1.5), cex.axis = 1.5, col = colour, legend = FALSE)
}
```

\vspace{-1.5cm}
```{r QsoilPlot2, echo = FALSE, fig.width = 17, fig.height = 2, fig.cap="\\textbf{Overview of soil moisture data -} Soil moisture data presented in layers as obtainable via the ERA5 reanalysis product (\\tair, \\qsoila, \\qsoilb, \\qsoilc, \\qsoild). Figure established via \\ref{rQsoilOverview}. \\label{fig:QsoilOverview}", fig.scap="Overview of soil moisture data", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
par(mfrow = c(1,1))
plot(Era5ras[[4]], legend.only=TRUE, smallplot=c(0.05,.95,.2,.35), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.qsoil, legend.args = list(text='Soil Moisture', side = 3, line = .1, cex = 2))
```

Within \era, unfrozen ground water ($\theta$) across all four soil layers ($k$) is defined as:

\begin{equation}
\overline{\theta} = \sum_{k=1}^4 (R_k * max[f_{liq;k}\theta_k, \theta_{pwp}])
\end{equation}

with $R_k$ being the root fraction of soil layer $k$ which is a fixed metric according to \lccss, and the statement $max[f_{liq;k}\theta_k, \theta_{pwp}]$ calculating the amount of unfrozen soil water in soil layer $k$. $f_{liq;k}$ is a parametrised function of soil temperature; $\theta_{pwp}$ denotes the permanent wilting point according to soil texture. For a more in-depth explanation of how \qsoil is calculated within \era, see the IFS Documentation CY45R1 Chapter 4 \textit{Physical Processes}\cite{ECMWF2018c}.

\clearpage


#### Digital Elevation Models

Further abiotic data is needed for data preparation as outlined in section \ref{S:DataPrep} To this end, I am using \dem data obtained via the  \hwsd which contains different \dem outputs at 3 and 30 arc-second resolution\cite{Ele30,Ele3}. See table \ref{tab:HWSDCore} for an overview of \hwsd \dem data characteristics.

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[Core Information about HWSD data]{\textbf{Core Information about HWSD data -} Characteristics of the HWSD data set.}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries Characteristic  & \bfseries Data\\
    \hline
    \textit{Resolution} & $3arc \times 3arc \sim 31m \times 31m$\\
    \textit{Source} & \url{http://www.fao.org/soils-portal/soil-survey/soil-maps-and-databases/harmonized-world-soil-database-v12/en/} \\
    \hline
    \end{tabular}
  \label{tab:HWSDCore}
\end{table*}

For an overview of all variables from the \hwsd used within this study see table \ref{tab:HWSDOverview}. See figure \ref{fig:EleOverview} for a global representation of \hwsd \dem data and figure \ref{fig:HWSDAOverview} and \ref{fig:HWSDIOverview} for an overview of \hwsd slope aspect and incline data respectively as described in table \ref{tab:HWSDOverview}. These haven been rescaled to match \gimms resolution (see table \ref{tab:NDVICore}).


```{r CovPlot, echo = FALSE, fig.width = 17, fig.height = 9.5, fig.cap="\\textbf{DEM elevation data -} \\hwsd elevation data at \\gimms resolution. Figure established via \\ref{rEleOverview}. \\label{fig:EleOverview}", fig.scap="DEM elevation data", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
plot(ElevationF, colNA = "black", cex.main = 2, legend.width = 1.5, legend.shrink=1, axis.args=list(cex.axis=1.5), cex.axis = 1.5, legend = TRUE, col = terrain.colors(100), main = "DEM at GIMMs native resolution")
```

\clearpage

### Analyses

#### Data Preparation
\label{S:DataPrep}

\paragraph*{Monthly Maximum Composites}  \hspace{.5cm}
After retrieving \gimms \ndvi 3g data using the `gimms` package in `R`, bi-weekly \ndvi data is aggregated to monthly composites using the *maximum composite* method (see \ref{rGimms}). Doing so is a method for removing data uncertainty due to atmospheric interference which has seen application in recent remote-sensing-based studies of vegetation memory and resilience\cite{Gazol2018,Liu2018,Vicente-Serrano2013}.

\paragraph*{Downscaling} \hspace{.5cm}
In order to calculate vegetation memory effects (**first research goal**), vegetation data and abiotic data should be represented at the same spatial and temporal resolution. Whilst both \ndvi and \era data are available at monthly intervals (after pre-processing as already described), their spatial resolutions differ (e.g. $\sim 9.27km \times \sim 9.27km$, vs. $30km \times 30km$, respectively; see tables \ref{tab:NDVICore} and \ref{tab:ERA5Core}).  

There are two ways of remedying this spatial mismatch: (1) aggregating \gimms data to coarser resolution of \era data, or (2) downscaling of \era data to \gimms resolution. Whilst aggregating data to coarser resolutions is much easier and less computationally expensive, I have opted to apply **downscaling** to the \era data used within my study so as to retain valuable information within the \gimms \ndvi 3g data set. This will allow more precise vegetation memory identification and result in more biologically relevant patterns of vegetation memory characteristics.  

A large host of downscaling methods is available and before choosing any method one has to settle on whether to perform *statistical* or *dynamic* downscaling\cite{Trzaska2014,Onyutha2016}:

\begin{enumerate}
\item \textit{Statistical Downscaling} is centred around statistical links between global and local climate patterns\cite{Maraun2010}, comparatively computationally cheap and easily transferable to different study regions but suffers from a strong dependency on the choice of predictors/co-variates\cite{Fowler2007}.
\item \textit{Dynamic Downscaling} is built around regional climate models being implemented into global climate models\cite{Maraun2010}, produces results based on physically consistent processes but computationally expensive\cite{Fowler2007}.
\end{enumerate}

This study is focussed on three study regions (i.e. the Iberian Region, the Caatinga, and Australia) and five \era variables (\tair, \qsoila, \qsoilb, \qsoilc, and \qsoild) in monthly intervals from 1981 to 2015. \era data from 1981 is being downscaled to match \gimms resolution to calculate cumulative lags of memory effect drivers (see section \ref{sMemMods}). With this, downscaling needs to be performed three times (study regions), for five variables, each with 420 individual time steps (twelve months per year times 35 years). In total, the downscaling process is thus required to be run 6,300 times. Using a computationally expensive method belonging to the group of dynamical downscaling approaches is thus undesireable and I have elected to employ a **statistical downscaling** method to match \era data with \gimms resolution.  

More specifically, I am using **Kriging** - a method that is well-understood and has long been used in non-biological sciences for geostatistical interpolation purposes\cite{Hengl2011}. Kriging is a two-step process. First, one establishes statistical relationships between data which is to be kriged at its native resolution with covariate data at the same resolution. The second step sees the extrapolation of these relationships using target resolution covariate data. The way in which Kriging improves over other statistical downscaling methods centred around these two steps lies in the fact that the Kriging methodology not only *extrapolates* relationships but *residuals* as well (see figure \ref{fig:Krig} for a visual representation).

Therefore, Kriging within my analyses requires three inputs: (1) \era data at native resolution, (2) \hwsd covariates (see table \ref{tab:HWSDOverview}) at \era resolution, and (3) \hwsd covariates (see table \ref{tab:HWSDOverview}) at \gimms resolution to produce sets of \era data at \gimms resolution. Kriging operations are built around formulae which establish response and predictor relationships. My kriging approaches are specified as follows:

\begin{equation}
Var_{ERA5} = \alpha + \sum_{i = 1}^{14}(\beta_i * Cov_{HWSD;i})
\end{equation}

with $Var_{ERA5}$ identifying any of the five \era variables \tair, \qsoila, \qsoilb, \qsoilc, or \qsoild at any given monthly interval between January 1981 and December 2015. $Cov_{HWSD;i}$ indexes the $i^{th}$ \hwsd covariate ranging from elevation and slope aspects to slope incline levels. Due to computational expense the kriging procedure only considers interaction effects between slope incline levels and slope aspects (see \ref{rEra5}).

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Kriging.jpg}
\caption[Kriging Concept]{\textbf{Kriging Concept - } Statistical downscaling effects of Tair for the time step of January 1981 using \hwsd covariate data across the Iberian Region. Diagram source: Le Riche et al., 2012\cite{LeRiche2012}. Some parts of this figure have been generated via \ref{rFigs}.}
\label{fig:Krig}
\end{figure}

For an in-depth mathematical explanation of the Kriging methodology, see Hengl, 2011\cite{Hengl2011}. A practical example of its use can be retrieved in Lichtenstern, 2013\cite{Lichtenstern2013}.

\clearpage

#### Memory Models
\label{sMemMods}

Models of vegetation memory within this study come in two flavours:
\begin{enumerate}
  \item \textit{Vegetation Memory Coefficients} are being computed to identify intrinsic and extrinsic forcing factors answering \textit{research question I.1}. 
  \item \textit{Model Comparisons} and \textit{Variance Partitioning} are employed to assess relative importance of different factors answering \textit{research question I.1} and \textit{I.2}.
\end{enumerate}

\paragraph*{Vegetation Memory Coefficients}  \hspace{.5cm}
The vegetation memory analyses in this study have been informed heavily by DeKeersmaecker et al.'s work\cite{DeKeersmaecker2015}. Vegetation memory models of this study are built upon the following basic specification:
\vspace{-.2cm}
\begin{equation}
\label{eqMemMod}
NDVI_t = \beta_{t-1}*NDVI_{[t-1]} + \beta_{Qsoil}*Qsoil_{k;m} + \beta_{Tair}*Tair_{t}
\end{equation}
with $NDVI_t$ and $NDVI_{[t-1]}$ being standardised \ndvi anomalies at time step $t$ and $t-1$, respectively; $Qsoil_{k;m}$ denoting \qsoil data at depth level $k$ (translating to \qsoila - \qsoild) and cumulative lag of standardised anomalies of lag $m$, and $Tair_t$ denoting \tair data at time $t$. See table \ref{tab:CoeffsOverview} for an interpretation of the model coefficients. The duality of memory effects as *intrinsic* and *extrinsic* as proposed by Ogle et al.\cite{Ogle2015} is embraced as follows:

\begin{enumerate}
\item \textbf{Intrinsic Memory} is identified as coefficients of  $NDVI_{ [t-1]}$\cite{DeKeersmaecker2015,Liu2018} (see model formula \ref{eqMemMod}).
\item \textbf{Extrinsic Memory} are implemented via \era data. See section \ref{sEra} for the rationale behind the inclusion of the different variables and model formula \ref{eqMemMod} for how they are included in vegetation memory models.
  \begin{enumerate}
  \item \textit{\tair} is implemented as an \textit{instantaneous} effect on plant performance.
  \item \textit{\qsoila - \qsoild} effects are implemented as \textit{cumulative lag} effects ranging from instantaneous impacts to lags on annual time windows\cite{Vicente-Serrano2013}.
  \end{enumerate}
\end{enumerate}

\vspace{-.8cm}

\renewcommand{\arraystretch}{1}
\begin{table*}[b!]
  \centering
  \caption[Interpretation of Memory Model Coefficients]{\textbf{Interpretation of Memory Model Coefficients -} Biological Interpretation of Vegetation Memory Coefficients as portrayed in model formula \ref{eqMemMod}.}
    \begin{tabular}{|L{1.7cm}L{5.5cm}L{9cm}|}
    \hline
    \bfseries Coefficient  & \bfseries Magnitude & \bfseries Sign \\
    \hline
    $\mathbf{\beta_{t-1}}$ & Absolute values depict the velocity at which systems return to equilibrium/pre-disturbance state. Large absolute values indicate low resilience (i.e. slow return). & \textit{Positive} - \ndvi anomalies resemble previous ones. \ndvi anomalies gradually diminish over time. \linebreak
\textit{Negative} - \ndvi anomalies resemble previous ones, but with the opposite sign. The return to pre-disturbance is characterised through oscillations. \\
    $\mathbf{\beta_{Qsoil}}$ & Absolute values depict the resistance to anomalies in \qsoil. Large absolute values indicate low resistance (i.e. strong vegetation responses) to \qsoil anomalies. & \textit{Positive} - Wetter soil conditions than average induce positive \ndvi anomalies; drier soil conditions than average induce negative \ndvi anomalies. \linebreak
\textit{Negative} - Drier soil conditions than average induce positive \ndvi anomalies; wetter soil conditions than average induce negative \ndvi anomalies. \\
  $\mathbf{\beta_{Tair}}$ & Absolute values depict the resistance to anomalies in air temperature. Large absolute values indicate low resistance (i.e. strong vegetation responses) to air temperature anomalies. & \textit{Positive} - Warmer air temperature than average induces positive \ndvi anomalies; colder air temperature than average induces negative \ndvi anomalies. \linebreak
\textit{Negative} - Colder air temperature than average induces positive \ndvi anomalies; warmer air temperature than average induces negative \ndvi anomalies. \\
    \hline
    \end{tabular}%
  \label{tab:CoeffsOverview}%
\end{table*}

\clearpage

The coefficients of the above drivers of vegetation memory (see table \ref{tab:CoeffsOverview} and formula \ref{eqMemMod}) are identified for each data pixel in the data rasters of the three study regions in four separate models (one for each \qsoil layer).

Doing so entails handling an immense amount of data which defies individual data preparation and model inspection and so one has to generate a generalised, and automated approach. A visual representation of the automated modelling approach used within this study can be seen in figure \ref{fig:ModScheme}. This approach is carried out for each pixel as follows using the code contained within \ref{rVegMem}:

\begin{enumerate}
\item Data for each variable (\ndvi, \tair, \qsoil) is \textbf{extracted and detrended} to avoid effects of changing abiotic conditions over long time-series\cite{DeKeersmaecker2015} using linear detrending with the pracma package in R.
\item Detrended data is \textbf{standardised to Z-Scores} to obtain deviations of monthly means/monthly anomalies for each variable\cite{DeKeersmaecker2015}:
\begin{equation}
Anomaly_{i} = \frac{Detrended_{i} - \overline{Detrended_{month}}}{SD_{Detrended, month}}
\end{equation}
with $i$ indexing individual, detrended data records. In the case of \ndvi, one additionally calculates monthly means of untreated \ndvi data across the entire data range. See figure \ref{fig:NDVIMemMod} for an examplatory overview of \ndvi data treatment.
\item Calculation of \textbf{lagged effects}:
\begin{enumerate}
  \item $NDVI_{t-1}$ is calculated from Z-Score \ndvi data.
  \item Cumulative lags of \qsoil data are established for lags ranging from 0 (instantaneous effects) to annual effects (aggregated over twelve months of \qsoil Z-scores) in steps on one month at a time. See figure \ref{fig:QsoilMemMod} for an examplatory overview of \qsoil data treatment.
  \item \tair data is implemented as instantaneous effects and so no lagged effects have to be calculated. 
  \end{enumerate}
\item Variables in nature are often collinear\cite{Butler2017,Goldsmith2018}. Failing to address this issue results in masking of information which might influence our understanding of processes in nature significantly\cite{Zuur2007}. One method of circumventing this issue lies with \textit{\pca}. More specifically, if regression modelling is the target, one may wish to employ \textbf{\pca regression} as a three-step process\cite{Zuur2007} for each of the cumulative \qsoil lags across all four \qsoil layers effectively adding the necessity for a model selection step:
  \begin{enumerate}
  \item Z-Score data for \ndvi, \tair, and \qsoil are fed to \pca via the vegan package in R. See figure \ref{fig:ExMod} for an examplatory overview of data and a \pca result.
  \item Regression is performed as follows:
  \begin{equation}
  NDVI_t = \beta_1 * PC_1 + \beta_2 * PC2 + \beta_3 * PC3
  \end{equation}
  with $NDVI_t$ representing NDVI anomalies which have been set to NA (skipped in models) in months for which $Thresholds_{i} < 0.1$ with $Thresholds_{i} = \overline{Raw_{NDVI, month}}$\cite{Liu2018}. $PC_1$ through $PC_3$ and $\beta_1$ through $\beta_3$ indicate principal components 1 through 3 and coefficients of their effects in the model respectively.
  \item Model selection is performed to identify the cumulative soil lag which presents the most explanatory power through comparison of model \aic values. The model with the \aic closest to 0 is said to be performing the best\cite{Cailleret2016}. This results in a proxy of \qsoil memory length of local vegetation.
  \item The regression coefficients $\beta_1$ through $\beta_3$ can be back-transformed to represent \pca input variable effects (see formula \ref{eqMemMod}) using \pca loadings and \pca model coefficients (see figure \ref{fig:PCAREG}).
  \end{enumerate}
\end{enumerate}

\clearpage

\begin{figure}[t!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/ModScheme.jpg}
\caption[Vegetation Memory Model Flowchart]{\textbf{Vegetation Memory Model Flowchart - } Visual workflow of pixel-wise iterated vegetation memory model. $m$ denotes the currently considered cumulative lag of \qsoil data with $M$ being the maximum cumulative lag. \qsoil layers \qsoila - \qsoild are identified via $k$. $L_1$ through $L_3$ are the loadings of each detrended and standardised variable (\ndvi, \tair, and \qsoil) onto the principal components 1 through 3, respectively. \pca model coefficients are identified as $\beta_1$ through $\beta_3$. $l$ denotes the cumulative \qsoil lag offering the most explanatory power in terms of \aic values of \pca regression models and is thus a proxy for vegetation memory in terms of \qsoil.}
\label{fig:ModScheme}
\end{figure}

\vspace{-4cm}

```{r VegMemNDVI, echo = FALSE, fig.width = 17, fig.height = 8, fig.subcap=c('NDVI Time-Series (Untreated and Detrended)', 'Monthly Means of Untreated NDVI Data with 0.1 Threshold', 'Standardised Detrended NDVI Data (Z-Scores)', 'Plotting Colour Reference'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Memory Model NDVI Data Treatment -} Overview of \\ndvi data treatment as outlined in figure \\ref{fig:ModScheme} and explained above. The data presented here represents a single pixel in the Iberian dryland region (see figure \\ref{fig:ExMod}). Figure established via \\ref{rVegMemNDVI}. \\label{fig:NDVIMemMod}", fig.scap="Memory Model NDVI Data Treatment", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
## load data
IbRas <- grep(list.files(Dir.Gimms.Monthly), pattern = "Iberian Region")
IBNDVI <- brick(paste(Dir.Gimms.Monthly, list.files(Dir.Gimms.Monthly)[IbRas], sep="/"))
## extract data
NDVI_vecraw <- as.vector(IBNDVI[35363])
NDVI_vecdet <- detrend(NDVI_vecraw, tt = 'linear') # linear detrending
NDVI_df <- data.frame(Month = rep(1:12, length(NDVI_vecraw)/12), NDVI_raw = NDVI_vecraw, NDVI_de = NDVI_vecdet) # create NDVI data frame
## calculate anomalies (Z-scores) and monthly means
NDVI_df <- transform(NDVI_df,
                     NDVI_Anomalies = ave(NDVI_de, Month, FUN=scale),
                     NDVI_Threshold = ave(NDVI_raw, Month, FUN=function(t) mean(t, na.rm=TRUE)))
## plotting data frame
NDVIplot_df <- data.frame(NDVI = c(NDVI_vecraw, NDVI_vecdet, 
                                   NDVI_df$NDVI_Anomalies,
                                   NDVI_df$NDVI_Threshold[1:12]),
                          Ident = c(rep("Raw Data", length(NDVI_vecraw)),
                                    rep("Detrended", length(NDVI_vecraw)),
                                    rep("Z-Scores", length(NDVI_vecraw)),
                                    rep("Monthly Means", 12)),
                          Months = c(rep(1:length(NDVI_vecraw), 3), 1:12))
## raw and detrended
ggplot(NDVIplot_df[1:(length(NDVI_vecraw)*2),], aes(x = Months, y = NDVI, col = Ident)) + geom_line(size = 2) + theme_bw(base_size = 35) + theme(legend.position = "none") + scale_color_manual(values=c("orange", "forestgreen"))
## monthly means
ggplot(NDVIplot_df[(length(NDVI_vecraw)*3+1):(dim(NDVIplot_df)[1]),], aes(x = as.factor(Months), y = NDVI, col = Ident)) + geom_bar(stat="identity", fill = "forestgreen") + theme_bw(base_size = 35) + theme(legend.position = "none") + scale_color_manual(values=c("forestgreen")) + xlab("Months") + geom_hline(aes(yintercept=.1), size = 1.5)
## z-scores
ggplot(NDVIplot_df[(length(NDVI_vecraw)*2+1):(length(NDVI_vecraw)*3),], aes(x = Months, y = NDVI, col = Ident)) + geom_line(size = 2) + theme_bw(base_size = 35) + theme(legend.position = "none") + scale_color_manual(values=c("purple"))
## legend
leg <- ggplot(NDVIplot_df[1:(length(NDVI_vecraw)*3),], aes(x = Months, y = NDVI, col = Ident)) + geom_line(size = 2) + scale_color_manual(values=c("orange", "forestgreen", "purple")) + theme_bw(base_size = 65) + 
  guides(colour = guide_legend(override.aes = list(size=20))) + labs(col='GIMMs NDVI 3g data')
legend <- cowplot::get_legend(leg)
grid.newpage()
grid.draw(legend)
```

\clearpage

```{r VegMemQsoil, echo = FALSE, fig.width = 17, fig.height = 8, fig.subcap=c('Qsoil1 Time-Series (Untreated and Detrended)', 'Standardised Detrended Qsoil1 Data (Z-Scores)', 'Cummulative Qsoil1 Lags', 'Plotting Colour Reference'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Memory Model Qsoil Data Treatment -} Overview of \\qsoil data treatment as outlined in figure \\ref{fig:ModScheme} and explained above. Only \\qsoila data is represented. The data presented here represents a single pixel in the Iberian dryland region (see figure \\ref{fig:ExMod}). Figure established via \\ref{rVegMemQsoil}. \\label{fig:QsoilMemMod}", fig.scap="Memory Model Qsoil Data Treatment", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
setwd(Dir.ERA.Monthly)
Qsoil <- brick(list.files()[grep(list.files(), pattern = "Iberian Region_11981_122015.nc")[1]])
load(paste(Dir.Data,"ModData_df.RData", sep ="/")) # model data for pixel 35363
Clim <- as.vector(Qsoil[35363])[1:dim(ModData_df)[1]]
Clim_vec <- detrend(Clim, tt = 'linear') # linear detrending
## raw and detrended
plot1_df <- with(ModData_df, data.frame(
  Months = rep(1:dim(ModData_df)[1], 2),
  Qsoil = c(Clim, Clim_vec),
  Ident = rep(c("Raw Data", "Detrened"), each = dim(ModData_df)[1])
))
ggplot(plot1_df, aes(x = Months, y = Qsoil, col = Ident)) + geom_line(size = 2) + theme_bw(base_size = 35) + theme(legend.position = "none") + scale_color_manual(values=c("orange", "navyblue"))
## raw and detrended
plot2_df <- with(ModData_df, data.frame(
  Months = rep(1:dim(ModData_df)[1], 1),
  Qsoil = c(Clim_raw),
  Ident = rep(c("Z-Scores"), each = dim(ModData_df)[1])
))
ggplot(plot2_df, aes(x = Months, y = Qsoil, col = Ident)) + geom_line(size = 2) + theme_bw(base_size = 35) + theme(legend.position = "none") + scale_color_manual(values=c("brown"))
## Cummulative soil moisture lags
plot3_df <- with(ModData_df, data.frame(
  Months = rep(1:dim(ModData_df)[1], 13),
  Qsoil = c(ClimCum_0, ClimCum_1, ClimCum_2, ClimCum_3, ClimCum_4, ClimCum_5, ClimCum_6, ClimCum_7, ClimCum_8, ClimCum_9, ClimCum_10, ClimCum_11, ClimCum_12),
  Ident = as.factor(rep(c("Z-Scores", "Lag 01", "Lag 02", "Lag 03", "Lag 04", "Lag 05", "Lag 06", "Lag 07", "Lag 08", "Lag 09", "Lag 10", "Lag 11", "Lag 12"), each = dim(ModData_df)[1]))
))
ggplot(plot3_df, aes(x = Months, y = Qsoil, col = Ident)) + geom_line(size = 1) + theme_bw(base_size = 35) + theme(legend.position = "none") +  scale_color_manual(values=c(rainbow(12), "brown"))
## legend
Qsoilplot_df <- rbind(plot1_df, plot3_df)
leg <- ggplot(Qsoilplot_df, aes(x = Months, y = Qsoil, col = Ident)) + geom_line(size = 2) + scale_color_manual(values=c("orange", "navyblue", rainbow(12), "brown")) + theme_bw(base_size = 65) + guides(colour = guide_legend(ncol=3, override.aes = list(size=20))) + labs(col='ERA5 Qsoil1 data')
legend <- cowplot::get_legend(leg)
grid.newpage()
grid.draw(legend)
```

\begin{figure}[h!]
\centering \includegraphics[width=.9\linewidth]{3 - Figures/ExMod.jpg}
\caption[Examplatory Vegetation Memory PCA]{\textbf{Examplatory Vegetation Memory PCA - } Overview of Z-Score data for $NDVI_{t-1}$, $Qsoil_{1;6}$, and $Tair$ for a single pixel in the dryland region of the Iberian study region (red colouring on \ndvi background in central plot) as well as their representation in a \pca. Also pictured: $NDVI_t$ Z-Scores required for \pca regression models (see figure \ref{fig:ModScheme} and \ref{fig:PCAREG}). Some parts of this figure have been generated via \ref{rFigs}.}
\label{fig:ExMod}
\end{figure}

\clearpage

\begin{figure}[t!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/PCAREG.jpg}
\caption[PCA Regression Coefficients]{\textbf{PCA Regression Coefficients - } Theoretical back-calculation of regression coefficients from \pca regression coefficients as lined out by Zuur et al\cite{Zuur2007}. The data presented here (\pca loadings, \pca model coefficients, and final variable coefficients) represents a single pixel in the Iberian dryland region (see figure \ref{fig:ExMod}).}
\label{fig:PCAREG}
\end{figure}

By following the vegetation memory modelling procedure outlined in figures \ref{fig:ModScheme} and \ref{fig:PCAREG} and explained above for each study region one obtains rasters containing the following information for each pixel:

\begin{enumerate}
\item \textbf{Vegetation Memory Coefficients} as established in formula \ref{eqMemMod} jused to identify meainingful drivers of vegetation memory (\textit{research question I.1}).
\item \textbf{Vegetation Memory Length} in regards to \qsoila, \qsoilb, \qsoilc, and \qsoild again being used to answer \textit{research question I.1}.
\end{enumerate}

\vspace{.5cm}

\paragraph*{Model Comparisons}  \hspace{.5cm}

Assessments of differences in relative importance of vegetation memory coefficients in individual models and between models serve to answer the following questions:

\begin{enumerate}
\item \textbf{Which model variable exerts the greatest influence on vegetation anomalies?} - To answer this question, I am comparing absolute values of variable coefficients across all pixels \textit{within} each \textit{model} individually, separately for each study region. Doing so serves to answer \textit{research question I.1} and \textit{I.2}.
\item \textbf{Which \qsoil layer is the most biologically influential?} - The answer to this question can be retrieved by comparing absolute values of \qsoil coefficients for all pixel per model \textit{between} all four \textit{models} for each study region which answers \textit{research question I.1}.
\end{enumerate}

Differences in absolute variable coefficient values within and between models has been assessed using Mann-Whitney-U Test (`wilcox.test(..., paired = FALSE)` in `R`). I have chosen the Mann-Whitney U-Test, since vegetation memory coefficient data cannot be expected to be normal distributed, nor to fall onto symmetrical distributions (hence, one should contrast median values rather than mean values). The code for these assessments can be retrieved in \ref{rVegMem} (`CoeffScaling`).

Although allowing for region-wide generalisations, these assessments of statistical significance can not be used to identify or display spatial patterns of relative memory coefficient importance.

\clearpage

\paragraph*{Variance Partitioning}  \hspace{.5cm}

Variance partitioning is a model-driven method of assessing relative importance of vegetation memory model variables. As opposed to Mann-Whitney U model comparisons, variance partitioning can be carried out for each pixel in my study region data rasters individually. This, in turn, results in the identification of patterns of relative model predictor importance.  

It was my goal to assess the relative importance of intrinsic and extrinsic vegetation memory components (\textit{research question I.2}). I have identified \qsoil layers to be of special interest in representing extrinsic vegetation memory (see section \ref{sResults}). Therefore, I am assessing the relative information contained in the vegetation memory model predictors $NDVI_{t-1}$ (intrinsic memory) and $Qsoil_{k;m}$ (extrinsic soil moisture memory of layer $k$ and cumulative lag $m$).  

Zuur et al.\cite{Zuur2007} present a method developed by Legendre \& Legendre\cite{Legendre1998} for the purpose of variance partitioning between two explanatory variables. This approach (represented in figure \ref{fig:VarPar}) is carried out as follows:

\begin{enumerate}
\item Apply the full regression model $Z_{NDVI} = NDVI_{t-1} + Qsoil_{k;m}$ and obtain $R^2$ (the coefficient of determination). This is $R^2_{Full}$ and equal to all explained variance. Unexplained variance can then be calculated as $1 - R^2_{Full}$
\item Obtain $R^2$ of the model $Z_{NDVI} = NDVI_{t-1}$. This is $R^2_{NDVI_{t-1}}$ and equal to all variance explained by $NDVI_{t-1}$.
\item Obtain $R^2$ of the model $Z_{NDVI} = Qsoil_{k;m}$. This is $R^2_{Qsoil_{k;m}}$ and equal to all variance explained by $Qsoil_{k;m}$.
\end{enumerate}

The variance shared between $NDVI_{t-1}$ and $Qsoil_{k;m}$ - $R^2_{Shared}$ can then be calculated as:

\vspace{-.2cm}
\begin{equation}
R^2_{Shared} = R^2_{NDVI_{t-1}} + R^2_{Qsoil_{k;m}} - R^2_{Full}
\end{equation}

The pure information contained within $NDVI_{t-1}$ ($R^2_{t-1}$) and $Qsoil_{k;m}$ ($R^2_{k;m}$) can then be calculated as follows:

\vspace{-.2cm}
\begin{equation}
R^2_{t-1} = R^2_{NDVI_{t-1}} - R^2_{Shared}
\end{equation}
\vspace{-.4cm}
\begin{equation}
R^2_{k;m} = R^2_{Qsoil_{k;m}} - R^2_{Shared}
\end{equation}

\begin{figure}[h!]
\centering \includegraphics[width=.9\linewidth]{3 - Figures/VarParScheme.jpg}
\caption[Variance Partitioning]{\textbf{Variance Partitioning - } Partitioning of variance in pure influence of $NDVI_{t-1}$ (Pure $[t-1]$), $Qsoil_{k;m}$ (Pure $Qsoil$, with $k$ identifying the \qsoil layer, and $m$ denoting the cumulative lag of \qsoil data), shared variance between the two (Shared), and residuals (Unexplained). The figure concept has been lifted from Zuur et al.\cite{Zuur2007} and adjusted to reflect the purpose of this study. Model specifications are contained within dashed boxes.}
\label{fig:VarPar}
\end{figure}

This form of variance partitioning is carried out for each pixel across all study regions and contained in the vegetation memory model output of \ref{rVegMem} alongside \pca regression models.

#### Adaptation to Climate

Following the notion of climate adaptation leading to altered disturbance-responses of local vegetation\cite{Walter2013} I am assessing the relationship of vegetation memory characteristics and the mean value of their drivers across the entire time period from 1981 to 2015. This is done using linear regression and useful in answering \textit{research question I.1}.

\clearpage

## Functional Aspects of Vegetation Memory

### Data
Contemporary studies of vegetation memory largely describe memory effects in terms of spatial patterns and effect sizes, but forego analyses of plant physiology or morphology to **explain causal pathways** leading to vegetation memory.  

Expressions of plant morphology and physiology are manifold and so one may wish to enlist multiple different proxies of these biological properties to rationalise vegetation memory effects.

#### TRY
Within this thesis, I am relating vegetation memory effects to two different \PFTs which have been selected because they represent two important plant characteristics/trade-off axes in plant function (1) Vegetative Height, and (2)  Leaf nitrogen content per leaf dry mass. 

Additionally, these two \PFTs correspond to two of the three \PFT domains (i.e. stems and leaves) layed out in Westoby \& Wright's \PFT framework\cite{Westoby2006}. Examining \PFTs of multiple aspects of plant function in the face of adverse events is especially important as plant performance levels during and after disturbances often incur responses of all aspects of individual plant functional domains\cite{Bonser2006}.  

For visualisations of the raw data, see figures \ref{fig:HOverview} and \ref{fig:NOverview}. These plots clearly depict the limitation of \TRY (and other \PFT data bases) - sampling bias and effort\cite{Sandel2015}. Certain regions of the earth are well-sampled for \PFTs (e.g. the Pyrenees) although these sampling schemes are often limited to plot-level sampling campaigns. This data limitation highlights the potential importance of a mapping approach as lined out in figure \ref{fig:PFTCombining}. The \TRY data used for my thesis has been obtained via \TRY on 07/08/2018.

\begin{enumerate}
\item \textbf{\vh} recorded in $cm$. Taller plants are better at pre-empting light resources and dispersing diaspores\cite{Diaz2015}.
\end{enumerate}

```{r ShowTRYH, echo = FALSE, fig.width = 17, fig.height = 9.5, fig.cap="\\textbf{Global Vegetative Height ($H$) data as obtained via TRY -} \\vh data obtained via \\TRY, aggregated to rasters at \\gimms resolution. Grey pixels indicate terrestrial regions for which no \\vh data is available. Figure established via \\ref{rHOverview}. \\label{fig:HOverview}", fig.scap="Global Vegetative Height (H) data as obtained via TRY", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
# Data
setwd(Dir.Gimms.Monthly)
Back_ras <- mean(brick(list.files()[1:7]), na.rm = TRUE) # background raster for later plots
values(Back_ras)[which(!is.na(values(Back_ras)))] <- 8888
RawTry_ras <- brick(paste(Dir.TRY,"/RawTRY-Global.nc", sep=""))
# Height plot
plot(Back_ras, col = "grey", colNA = "black", main = "Mean Vegetative Height", cex.main = 2, legend = FALSE)
plot(RawTry_ras[[1]], col = col.tair, add = TRUE, legend.width = 1.5, legend.shrink=1, axis.args=list(cex.axis=1.5), cex.axis = 1.5)
```

\begin{enumerate}
\setcounter{enumi}{1}
\item \textbf{\nmass} recorded in $\frac{mg_{N}}{g_{leaf}}$. This is a valuable proxy for different strategies of resource allocation to leaf longevity vs. photosynthetic potential\cite{Diaz2015}.
\end{enumerate}

```{r ShowTRYN, echo = FALSE, fig.width = 17, fig.height = 9.5, fig.cap="\\textbf{Global Leaf Nitrogan Content ($N_{mass}$) data as obtained via TRY -} \\nmass data obtained via \\TRY, aggregated to rasters at \\gimms resolution. Grey pixels indicate terrestrial regions for which no \\nmass data is available. Figure established via \\ref{rNOverview}. \\label{fig:NOverview}", fig.scap="Global Leaf Nitrogan Content ($N_{mass}$) data as obtained via TRY", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
# Nmass plot
plot(Back_ras, col = "grey", colNA = "black", main = "Mean Leaf Nitrogen Mass", cex.main = 2, legend = FALSE)
plot(RawTry_ras[[2]], col = col.tair, add = TRUE, legend.width = 1.5, legend.shrink=1, axis.args=list(cex.axis=1.5), cex.axis = 1.5)
```

\clearpage

#### COMPADRE
\LHT information for plants and animals can be retrieved via \COMPADRE; an extensive data base of different species and plot-scale ecosystems at different locations around the Earth\cite{Salguero-Gomez2015}. \COMPADRE is built around observational data and matrix models\cite{COMPADREGuide} which can be used to extract valuable information about temporal processes in biological communities\cite{Jongejans,DeKroon2008}. The outputs of \COMPADRE matrix models are manifold\cite{Salguero-Gomez2017} offering access to a host of biologically relevant proxies of population processes.

For this study, I have selected the following \COMPADRE outputs as the most likely to be related to vegetation memory characteristics:

\begin{enumerate}
\item The \textbf{Fast-Slow Continuum (FSC)} is a \pca-based approach whose two main axes capture over 60\% of the variation in plant life history strategies\cite{Salguero-Gomez2017} and are largely made up by the \LHTs contained in table \ref{tab:LHTTerm}\cite{Salguero-Gomez2015}. I hypothesize that expressions of the \fsc will strongly interact with vegetation memory effects due to the holistic nature of the \fsc and the temporal nature of both \LHTs and vegetation memory effects. The two axes read as follows:
  \begin{enumerate}
  \item \textit{\fsca} explains around 35\% of global \LHT variation and contrasts species of low generation times, early maturity, and fast growth with species of high generation times, delayed maturity, and slow growth\cite{Salguero-Gomez2017}. Fast species rank low on this axis\cite{Salguero-Gomez2016}.
  \item \textit{\fscb} captures approximately 25\% of global \LHT variation and contrasts species low reproductive output with species that reproduce much, often, and for a long time\cite{Salguero-Gomez2017}. Species of low reproductive output rank low on this axis\cite{Salguero-Gomez2016}.
  \end{enumerate}
\item \textbf{Reactivity} is a \textit{first time-step} information criterion and a proxy for instantaneous biological responses\cite{Stott2011} and may thus be an important criterion in areas of high vegetation memory and thus low engineering resilience.
\item The \textbf{\crho} can be regarded as a measure of intrinsic resilience as it indicates how fast transient dynamics of a perturbation event decay; the larger \crho, the faster the population will converge\cite{Stott2011}.
\item The \textbf{\cpi} is a measure of population life cycles in periodic environments with more rapidly growing populations usually being classified by higher \cpi values\cite{Caswell2001}.
\end{enumerate}

With \COMPADRE, data for all variables contained within \COMPADRE can be retrieved for all locations contained within the current release of the data base. For an overview of the \COMPADRE sites available to this study using \COMPADRE 4.0.1, see figure \ref{fig:COMPADREOverview}.

```{r ShowCOMPADRE, echo = FALSE, fig.width = 17, fig.height = 9.5, fig.cap="\\textbf{COMPADRE sites available to this study -} Data availability within \\COMPADRE 4.0.1 aggregated to a raster of \\gimms resolution. Presence of data per grid cell is indicated with red shading. \\label{fig:COMPADREOverview}. Figure established via \\ref{rCOMPADREOverview}", fig.scap="COMPADRE sites available to this study", out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
# DATA
Compadre_df <- read.csv(paste(Dir.Compadre, "/allCOMPADREOutput.csv", sep="")) # load data frame
setwd(Dir.Gimms.Monthly)
Back_ras <- mean(brick(list.files()[1:7]), na.rm = TRUE) # background raster for later plots
values(Back_ras)[which(!is.na(values(Back_ras)))] <- 8888
# RASTERISING
pts <- na.omit(data.frame(y = Compadre_df$Lat, x = Compadre_df$Lon, z = rep(1, dim(Compadre_df)[1])))
coordinates(pts) = ~x+y # convert x and y to coordinates
rast <- raster(ext=extent(Back_ras), resolution=res(Back_ras)) # create raster to be filled
rasOut<-rasterize(x = pts, y = rast, field = pts$z, fun = mean) # rasterize irregular points
# PLOTTING
plot(Back_ras, col = "grey", colNA = "black", main = "COMPADRE Data Locations", cex.main = 2, legend = FALSE)
plot(rasOut, col = "red", add = TRUE, legend = FALSE, axis.args=list(cex.axis=1.5), cex.axis = 1.5)
```

Like with \PFTs, sampling effort for \LHTs within the \COMPADRE scheme can only cover a limited range of geological locations. The best sampled for regions on Earth - in terms of \COMPADRE sites - are the Iberian Peninsula and the contiguous United States of America. To date, no mapping approach beyond the rasterising of plot-level data of \COMPADRE \LHTs has been proposed.

\clearpage

#### Floral Data

Extrapolating \PFT records from species-referenced records to spatial products using species-specific \PFT means and species occurence records as layed out by Ordonoez \& Svenning\cite{Ordonez2015} (see figure \ref{fig:PFTCombining}) may prove to overcome the data limitations of \TRY \PFT data (see figures \ref{fig:HOverview} and \ref{fig:NOverview}).

Plant species occurence records can be obtained via floral data repositories such as \GBIF (see figure \ref{fig:GBIFOverview} for a representation of \GBIF plant occurence data). Data in \GBIF are stored as geo-referenced records of species presence. Generating maps from geo-referenced data points can be achieved by aggregating data points to rasters of a desired extent and resolution (i.e. \gimms resolution).

\begin{figure}[h!]
\centering \includegraphics[width=1\linewidth]{3 - Figures/Gbif.png}
\caption[GBIF \textit{Plantae} Occurrence Overview]{\textbf{GBIF \textit{Plantae} Occurrence Overview - }Global representation of occurence records for species within the \textit{plantae} kingdom available via \GBIF\cite{GBIFOnline} as of 21/04/19. Figure generated using the \GBIF occurence data exploration tool\cite{GbifRetrieve} obtaining records from 1982 to 2015 (same as \gimms data availability). Polygons have been drawn to omit occurence records of marine plantae species. Larger red plotting symbols indicate greater amounts of geo-referenced occurence records.}
\label{fig:GBIFOverview}
\end{figure}

The floral data used within this study have been obtained for the time period of 1982 to 2015 (the same time span as the data availability for \gimms \ndvi data) via \GBIF on 19/04/19 through to 21/04/19.

\clearpage




\clearpage

## Analyses

#### Plant Functional Traits

\PFT data has been obtained via \TRY on 07/08/18 in geo-referenced data table format and is used to achieve \textit{research goal 2}.

\paragraph*{Data Extraction}  \hspace{.5cm}
Vegetation memory characteristics are stored as raster data sets to retain spatial patterns of memory coefficients. Therefore, \PFT data needs rasterising for comparability. \PFT data is extracted and rasterised in two ways:
\begin{enumerate}
\item \textbf{Raw geo-referenced \PFT records}. Geo-referenced \TRY data points are aggregated to rasters of \gimms resolution using a mean function (if multiple \PFT records fall onto the same raster cell, the mean value of these is assigned to the cell). This results in rasters of low data-coverage but peer-reviewed data records.
\item \textbf{Species-specific mean \PFT records}. These are extracted for each species within the \TRY data set to enable \PFT mapping as depicted in figure \ref{fig:PFTCombining}.
\end{enumerate}

Data extraction of \PFT records is handled via \ref{rPFTs}.


\paragraph*{Data Mapping}  \hspace{.5cm}

Data mapping is carried out via \ref{rPFTs} and extrapolates species-specific \PFT mean values according to \GBIF occurence data (see figure \ref{fig:PFTCombining}). Using the approach presented by Ordonez \& Svenning\cite{Ordonez2015}, I am establishing rasters of mean \PFT expressions by:

\begin{enumerate}
\item Assigning species-specific mean \PFT values to all cells of individual species occurence according to \GBIF.
\item Computing the mean \PFT value for each cell in the rasters.
\item Removing all cells whose values exceed the upper 95\% quantile of mean \PFT records in these final mean rasters to remove outliers which may be due to sampling bias.
\end{enumerate}

This results in rasters of high data coverage but at a loss of data reliability.

\paragraph*{Models}  \hspace{.5cm}

I use regression models to assess causal links between \PFT expressions (both raw and mean-extrapolated).

#### Life History Traits

\LHT data has been obtained via \COMPADRE on 28/01/19 in geo-referenced table format and is used to achieve \textit{research goal 2}.

\paragraph*{Data Extraction}  \hspace{.5cm}

Target \COMPADRE \LHTs are extracted using \ref{rCOMPADRE} by aggregating geo-referenced \LHT records to rasters of \gimms resolution using a mean function for each study region.

\paragraph*{Models}  \hspace{.5cm}

Like with \PFTs, I use regression models to assess causal links between \LHTs expressions (both raw and mean-extrapolated).

\clearpage

# Results
\label{sResults}

## Identifying Vegetation Memory
### Vegetation Memory Models

#### Iberian Region

I am only presenting \qsoila results here as I have identified \qsoila to be most informative \qsoil layer (see figure \ref{fig:IBLayers} and table \ref{tab:IBRQsoilU}). Results pertaining to \qsoilb, \qsoilc, and \qsoild can be found in figures \ref{fig:IBRVegMem2}, \ref{fig:IBRVegMem3}, and \ref{fig:IBRVegMem4} respectively. Additionally, patterns of $NDVI[t-1]$ and \tair coefficients do not change between different soil layer models and are thus reported on in figure \ref{fig:IBRVegMem1}.

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
Vegetation memory coefficients of \ndvil and extrinsic memory (\tair and \qsoila) across the Iberian region are represented in figure \ref{fig:IBRVegMem1}. Additionally, figure \ref{fig:IBRVegMem1} depicts \qsoila memory length across the Iberian region. The memory patterns are as follows:
\begin{enumerate}
\item \qsoila memory length (identified as cummulative lags according to \aic values) exhibits low values (short memory) in the region of the Pyrenees with a noticeable shift towards slightly longer memory lengths when moving to dryland regions (particucarly across Spain).
\item \ndvil memory follows the same pattern as presented by De Keersmaecker et al.\cite{DeKeersmaecker2015} with strong, positive memory effects in the south of the Iberian region which diminish but remain positive towards the north.
\item \qsoila memory is predominantly positive in sign (with a notable exception of the Pyrenees). Especially strong \qsoila memory can be observed in the dryland regions of Spain and Portugal.
\item \tair memory falls onto a clear latitudinal gradient with positive memory effects in the north to negative memory effects of almost equal absolute values in the south. Additionally, there seems to be an altitudinal gradient with negative memory effects in the Pyrenees.
\end{enumerate}

A hierarchy of vegetation memory strength has been established via median values of absolute vegetation memory coefficients. According to this analysis, \ndvil memory is stronger across the board than \qsoila memory which, in turn, is stronger than \tair memory. These differences have been assessed for statistical significance (see table \ref{tab:IBRU1}). Again, only \qsoila results are presented here. The hierarchy of median vegetation memory coefficients remains unalterd when considering other \qsoil layers (see tables \ref{tab:IBRU2}, \ref{tab:IBRU3}, \ref{tab:IBRU4}).

```{r IBRU1, echo = FALSE, results = 'asis'}
Ures(Region = "Iberian Region", SoilLayer = 1)
```

\clearpage

```{r IBRVegMem1, echo = FALSE, fig.width = 17, fig.height = 20, fig.subcap=c('SoilLag', 't-1', 'Qsoil', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Iberian Region; Qsoil1) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:IBRVegMem1}", fig.scap="Vegetation Memory Coefficients (Iberian Region; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Iberian Region", SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Layer Comparison}  \hspace{.5cm}

As stated above \qsoila has been identified as the most informative \qsoil layer in terms of vegetation memory. This is due to the fact that patterns of \qsoil memory stay consistent across \qsoil layers (see figure \ref{fig:IBLayers}) and \qsoila coefficients being larger than coefficients of other \qsoil layers at satistical significance (see table \ref{tab:IBRQsoilU}).
\vspace{-1cm}
```{r IBLayers, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('Qsoil1', 'Qsoil2', 'Qsoil3', 'Qsoil4'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Iberian Region, QSoil Layers) -} Vegetation memory coefficients of different \\qsoil layers. These are also contained in figures \\ref{fig:IBRVegMem1}, \\ref{fig:IBRVegMem2}, \\ref{fig:IBRVegMem3}, and \\ref{fig:IBRVegMem4} and have been scaled to be represented on the same colour axis for comparability. Figure established via \\ref{rSoilLayersRes}. \\label{fig:IBLayers}", fig.scap="Vegetation Memory Coefficients (Iberian Region, QSoil Layers)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
SoilLayersRes(Region = "Iberian Region")
```
\vspace{-.5cm}
```{r IBRQsoilU, echo = FALSE, results = 'asis'}
UQsoilres(Region = "Iberian Region")
```

\clearpage

\paragraph*{Variance Partitioning}  \hspace{.5cm}

Variance partitioning of \ndvil and \qsoil has been accessed for all \qsoil layers. These results are presented in figure \ref{fig:IBRVarPar1} and show a clear pattern of \ndvil explaining an overwhelming majority of \ndvi z-scores. Variance explained by \qsoil and variance shared by \qsoil and \ndvil decrease through the soil layers.

Spatial patterns of explained variance (see figure \ref{fig:IBRVarPar2}) reveal that \ndvil and \qsoil are the most valuable as predictors \ndvi across the southern dryland regions of Spain and Portugal.

```{r IBVarPar, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('t-1', 'Shared', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Variance Partitioning (Iberian Region; Qsoil1) -} Variance of \\ndvi anomalies explained by (a) full models of intrinsic and extrinsic memory, (b) intrinsic memory, (c) shared variance, and (d) extrinsic memory. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:IBRVarPar1}", fig.scap="Variance Partitioning (Iberian Region; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Iberian Region", SoilLayer = 1, Plot = 1)
VarParRes(Region = "Iberian Region", SoilLayer = 2, Plot = 1)
VarParRes(Region = "Iberian Region", SoilLayer = 3, Plot = 1)
VarParRes(Region = "Iberian Region", SoilLayer = 4, Plot = 1)
```

\clearpage

#### Caatinga
I am only presenting \qsoila results here as I have identified \qsoila to be most informative \qsoil layer (see figure \ref{fig:CALayers} and table \ref{tab:CAQsoilU}). Results pertaining to \qsoilb, \qsoilc, and \qsoild can be found in figures \ref{fig:CAVegMem2}, \ref{fig:CAVegMem3}, and \ref{fig:CAVegMem4} respectively. Additionally, patterns of $NDVI[t-1]$ and \tair coefficients do not change between different soil layer models and are thus reported on in figure \ref{fig:CAVegMem1}.

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
Vegetation memory coefficients of \ndvil and extrinsic memory (\tair and \qsoila) across the Caatinga are represented in figure \ref{fig:CAVegMem1}. Additionally, figure \ref{fig:CAVegMem1} depicts \qsoila memory length across the Iberian region. The memory patterns are as follows:
\begin{enumerate}
\item \qsoila memory length (identified as cummulative lags according to \aic values) exhibits lower values (shorter memory) in the north-eastern dryland regions as well as the south-western tropical regions.
\item \ndvil memory depicts the same pattern as the vegetation sensitivity index developed by Seddon et al\cite{Seddon2016} with the nort-eastern dryland region being characterised by strong intrinsic memory effects. Notice the negligible coverage of negative \ndvil memory effects as well as their minute absolute values when compared to positive \ndvil memory effect values.
\item \qsoila memory effects are mostly positive across the entire Caatinga range with the highest absolute values being found in the north-eastern dryland region. Take note that the maximum \qsoila memory coefficient is larger than the absolute of the correspsonding minimum value. Additionally, there are some changes in \qsoil memory effect sign between \qsoila and \qsoilb, and \qsoilc and \qsoild with negative \qsoil effects being identified around the region of Brasilia in the latter two layers.
\item \tair memory patterns follow a pattern that is close to the inverse of the \qsoila pattern with large negative values in the north-eastern dryland region. Take note that the absolute of the minimum \tair memory coefficient is larger than the correspsonding maximum value.
\end{enumerate}

A hierarchy of vegetation memory strength has been established via median values of absolute vegetation memory coefficients. According to this analysis, \ndvil memory is stronger across the board than \qsoila memory which, in turn, is stronger than \tair memory. These differences have been assessed for statistical significance (see table \ref{tab:CAU1}). 

Again, only \qsoila results are presented here. The hierarchy of median vegetation memory coefficients remains unalterd when considering other \qsoil layers (see tables \ref{tab:CAU2}, \ref{tab:CAU3}, \ref{tab:CAU4}).

```{r CAU1, echo = FALSE, results = 'asis'}
Ures(Region = "Caatinga", SoilLayer = 1)
```

\clearpage

```{r CAVegMem1, echo = FALSE, fig.width = 17, fig.height = 20, fig.subcap=c('SoilLag', 't-1', 'Qsoil', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Caatinga; Qsoil1) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:CAVegMem1}", fig.scap="Vegetation Memory Coefficients (Caatinga; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Caatinga", SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Layer Comparison}  \hspace{.5cm}
As stated above \qsoila has been identified as the most informative \qsoil layer in terms of vegetation memory. This is due to the fact that patterns of \qsoil memory stay consistent across \qsoil layers (see figure \ref{fig:CALayers}) and \qsoila coefficients being larger than coefficients of other \qsoil layers at satistical significance (see table \ref{tab:CAQsoilU}).
\vspace{-1cm}
```{r CALayers, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('Qsoil1', 'Qsoil2', 'Qsoil3', 'Qsoil4'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Caatinga, QSoil Layers) -} Vegetation memory coefficients of different \\qsoil layers. These are also contained in figures \\ref{fig:CAVegMem1}, \\ref{fig:CAVegMem2}, \\ref{fig:CAVegMem3}, and \\ref{fig:CAVegMem4} and have been scaled to be represented on the same colour axis for comparability. Figure established via \\ref{rSoilLayersRes}. \\label{fig:CALayers}", fig.scap="Vegetation Memory Coefficients (Caatinga, QSoil Layers)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
SoilLayersRes(Region = "Caatinga")
```
\vspace{-.5cm}
```{r CAQsoilU, echo = FALSE, results = 'asis'}
UQsoilres(Region = "Caatinga")
```

\clearpage

\paragraph*{Variance Partitioning}  \hspace{.5cm}
Variance partitioning of \ndvil and \qsoil has been accessed for all \qsoil layers. These results are presented in figure \ref{fig:CAVarPar1} and show a clear pattern of \ndvil explaining an overwhelming majority of \ndvi z-scores. Variance explained by \qsoil and variance shared by \qsoil and \ndvil decrease through the soil layers.

Spatial patterns of explained variance (see figure \ref{fig:CAVarPar2}) reveal that \ndvil and \qsoil are the most valuable as predictors \ndvi across the north-eastern dryland region.


```{r CAVarPar, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('t-1', 'Shared', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Variance Partitioning (Caatinga; Qsoil1) -} Variance of \\ndvi anomalies explained by (a) full models of intrinsic and extrinsic memory, (b) intrinsic memory, (c) shared variance, and (d) extrinsic memory. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:CAVarPar1}", fig.scap="Variance Partitioning (Caatinga; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Caatinga", SoilLayer = 1, Plot = 1)
VarParRes(Region = "Caatinga", SoilLayer = 2, Plot = 1)
VarParRes(Region = "Caatinga", SoilLayer = 3, Plot = 1)
VarParRes(Region = "Caatinga", SoilLayer = 4, Plot = 1)
```

\clearpage

#### Australia
\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
I am only presenting \qsoila results here as I have identified \qsoila to be most informative \qsoil layer (see figure \ref{fig:AULayers} and table \ref{tab:AUQsoilU}). Results pertaining to \qsoilb, \qsoilc, and \qsoild can be found in figures \ref{fig:AUVegMem2}, \ref{fig:AUVegMem3}, and \ref{fig:AUVegMem4} respectively. Additionally, patterns of $NDVI[t-1]$ and \tair coefficients do not change between different soil layer models and are thus reported on in figure \ref{fig:AUVegMem1}.

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
Vegetation memory coefficients of \ndvil and extrinsic memory (\tair and \qsoila) across Australia are represented in figure \ref{fig:AUVegMem1}. Additionally, figure \ref{fig:AUVegMem1} depicts \qsoila memory length across the Iberian region. The memory patterns are as follows:
\begin{enumerate}
\item \qsoila memory length (identified as cummulative lags according to \aic values) exhibits larger values (longer memory) in the western regions whilst lower memory length indices in the eastern regions of Australia identify shorter memory. Tkae note that these patterns do not overlap well with the previously identified memory lags of Vicente-Serrano et al.\cite{Vicente-Serrano2013}, or Liu et al.\cite{Liu2018}.
\item \ndvil memory follows the same pattern as presented by De Keersmaecker et al.\cite{DeKeersmaecker2015} with strong, positive memory effects all across Australia with stronger \ndvil memory effects in the Outback and lower effects across the coastlines. Notice the negligible coverage of negative \ndvil memory effects as well as their minute absolute values when compared to positive \ndvil memory effect values.
\item \qsoila memory effects are mostly positive across the entirety of Australia with the highest values being located in the Outback and negative \qsoila memory effects being found on Tasmania, along coastlines and south of the St. George Ranges. Take note that the maximum \qsoila memory coefficient is larger than the absolute of the correspsonding minimum value. Additionally, there are some changes in \qsoil memory effect sign between \qsoila and \qsoilb, and \qsoilc and \qsoild with negative \qsoil effects being identified throghout the entire Outback particularly within the \qsoild layer.
\item \tair memory patterns follow a pattern that is close to the inverse of the \tair pattern with large negative values across all of Australia. Take note that the absolute of the minimum \tair memory coefficient is larger than the correspsonding maximum value.
\end{enumerate}

A hierarchy of vegetation memory strength has been established via median values of absolute vegetation memory coefficients. According to this analysis, \ndvil memory is stronger across the board than \qsoila memory which, in turn, is stronger than \tair memory. These differences have been assessed for statistical significance (see table \ref{tab:AUU1}). 

Again, only \qsoila results are presented here. The hierarchy of median vegetation memory coefficients remains unalterd when considering other \qsoil layers (see tables \ref{tab:AUU2}, \ref{tab:AUU3}, \ref{tab:AUU4}).

```{r AUU1, echo = FALSE, results = 'asis'}
Ures(Region = "Australia", SoilLayer = 1)
```

\clearpage

```{r AUVegMem1, echo = FALSE, fig.width = 17, fig.height = 20, fig.subcap=c('SoilLag', 't-1', 'Qsoil', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Australia; Qsoil1) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PAUREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:AUVegMem1}", fig.scap="Vegetation Memory Coefficients (Australia; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Australia", SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Layer Comparison}  \hspace{.5cm}
As stated above \qsoila has been identified as the most informative \qsoil layer in terms of vegetation memory. This is due to the fact that patterns of \qsoil memory stay consistent across the first three \qsoil layers (see figure \ref{fig:AULayers}) and \qsoila coefficients being larger than coefficients of other \qsoil layers at satistical significance (see table \ref{tab:AUQsoilU}).
\vspace{-1cm}
```{r AULayers, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('Qsoil1', 'Qsoil2', 'Qsoil3', 'Qsoil4'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Australia, QSoil Layers) -} Vegetation memory coefficients of different \\qsoil layers. These are also contained in figures \\ref{fig:AUVegMem1}, \\ref{fig:AUVegMem2}, \\ref{fig:AUVegMem3}, and \\ref{fig:AUVegMem4} and have been scaled to be represented on the same colour axis for comparability. Figure established via \\ref{rSoilLayersRes}. \\label{fig:AULayers}", fig.scap="Vegetation Memory Coefficients (Australia, QSoil Layers)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
SoilLayersRes(Region = "Australia")
```
\vspace{-.5cm}
```{r AUQsoilU, echo = FALSE, results = 'asis'}
UQsoilres(Region = "Australia")
```

\clearpage

\paragraph*{Variance Partitioning}  \hspace{.5cm}
Variance partitioning of \ndvil and \qsoil has been accessed for all \qsoil layers. These results are presented in figure \ref{fig:AUVarPar1} and show a clear pattern of \ndvil explaining an overwhelming majority of \ndvi z-scores. Variance explained by \qsoil and variance shared by \qsoil and \ndvil decrease through the soil layers.

Spatial patterns of explained variance (see figure \ref{fig:AUVarPar2}) reveal that \ndvil and \qsoil are the most valuable as predictors \ndvi across the Outback with patchy distributions.

```{r AUVarPar, echo = FALSE, fig.width = 17, fig.height = 14, fig.subcap=c('t-1', 'Shared', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Variance Partitioning (Australia; Qsoil1) -} Variance of \\ndvi anomalies explained by (a) full models of intrinsic and extrinsic memory, (b) intrinsic memory, (c) shared variance, and (d) extrinsic memory. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:AUVarPar1}", fig.scap="Variance Partitioning (Australia; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Australia", SoilLayer = 1, Plot = 1)
VarParRes(Region = "Australia", SoilLayer = 2, Plot = 1)
VarParRes(Region = "Australia", SoilLayer = 3, Plot = 1)
VarParRes(Region = "Australia", SoilLayer = 4, Plot = 1)
```
\clearpage

#### Summary
Across all three study regions, the \textbf{\qsoila} layer has been \textbf{identified as the most informative} of all the \qsoil layers.

Some persistent vegetation memory patterns have emerged across all three study regions:
\begin{enumerate}
\item \textbf{\qsoila memory length} (identified as cummulative lags according to \aic values) exhibits \textbf{shorter} values \textbf{in drylands} when compared to adjacent non-dryland regions.
\item \textbf{\ndvil memory} follows the same pattern as identified in previous studies\cite{DeKeersmaecker2015,Seddon2016} with \textbf{strong and positive} memory effects \textbf{across dryland regions}.
\item \textbf{\qsoila memory} effects are \textbf{strong and positive across dryland regions}.
\item \textbf{\tair memory} patterns are usually \textbf{strong and negative in dryland regions}.
\end{enumerate}

Additionally, model coefficient comparison via Mann-Whitney U-Tests revealed that \ndvil is a larger memory component than \qsoil coefficients which, in turn, are larger components that \tair.

Variance partitioning of \ndvil and \qsoil identified a \textbf{subsiding effect of \qsoil effects through soil layers}. Overall, \textbf{\ndvil explains more variance in \ndvi z-scores than \qsoil data} or variance shared by \ndvil or \qsoil data.

\clearpage

### Vegetation Memory Sensitivity

#### Iberian Region
\paragraph*{Intrisic Memory and Air Temperature}  \hspace{.5cm}

Sensitivity relationships of \ndvil and \tair are depcited alongside raw data in figure \ref{fig:IBPatCausRes}.
\vspace{-.3cm}
```{r IBPatCausRes, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('NDVI t-1', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (NDVI t-1 and Tair, Iberian Region) -} Vegetation memory coefficients of figure \\ref{fig:IBRVegMem1} plotted against mean intrinsic and extrinsic drivers (see figure \\ref{fig:IBPDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:IBPatCausRes}", fig.scap="Vegetation Memory Sensitivity (NDVI t-1 and Tair, Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPatCauseRes <- PatcausRes(Region = "Iberian Region", SoilLayer = 1, SoilOnly = FALSE)
```
\vspace{-.3cm}
\ndvil memory effects across the Iberian region are characterised by an inverse relationship with mean \ndvi values ($intercept = `r IBPatCauseRes[[1]]`$; $p_{intercept} = `r IBPatCauseRes[[2]]`$ and $slope = `r IBPatCauseRes[[3]]`$; $p_{slope} = `r IBPatCauseRes[[4]]`$). \tair memory effects across the Iberian region are also characterised by an inverse relationship with mean \tair values ($intercept = `r IBPatCauseRes[[5]]`$; $p_{intercept} = `r IBPatCauseRes[[6]]`$ and $slope = `r IBPatCauseRes[[7]]`$; $p_{slope} = `r IBPatCauseRes[[8]]`$).

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}

Sensitivity relationships of \qsoila memory length and \qsoila are depcited alongside raw data in figure \ref{fig:IBPatCausRes1}.
\vspace{-.3cm}
```{r IBPatCausRes1, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil1, Iberian Region) -} \\qsoila vegetation memory coefficients and \\qsoila memory length of figure \\ref{fig:IBRVegMem1} plotted against mean \\qsoila records (see figure \\ref{fig:IBPDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:IBPatCausRes1}", fig.scap="Vegetation Memory Sensitivity (Qsoil1, Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPatCauseRes1 <- PatcausRes(Region = "Iberian Region", SoilLayer = 1, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoila memory length across the Iberian region are characterised by an inverse relationship with mean \qsoila values ($intercept = `r IBPatCauseRes1[[1]]`$; $p_{intercept} = `r IBPatCauseRes1[[2]]`$ and $slope = `r IBPatCauseRes1[[3]]`$; $p_{slope} = `r IBPatCauseRes1[[4]]`$). \qsoila memory effects across the Iberian region are also characterised by an inverse relationship with mean \qsoila values ($intercept = `r IBPatCauseRes1[[5]]`$; $p_{intercept} = `r IBPatCauseRes1[[6]]`$ and $slope = `r IBPatCauseRes1[[7]]`$; $p_{slope} = `r IBPatCauseRes1[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilb memory length and \qsoilb are depcited alongside raw data in figure \ref{fig:IBPatCausRes2}.
\vspace{-.3cm}
```{r IBPatCausRes2, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil2, Iberian Region) -} \\qsoilb vegetation memory coefficients and \\qsoilb memory length of figure \\ref{fig:IBRVegMem2} plotted against mean \\qsoilb records (see figure \\ref{fig:IBPDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:IBPatCausRes2}", fig.scap="Vegetation Memory Sensitivity (Qsoil2, Iberian Region)", ache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPatCauseRes2 <- PatcausRes(Region = "Iberian Region", SoilLayer = 2, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoilb memory length across the Iberian region are characterised by an inverse relationship with mean \qsoilb values ($intercept = `r IBPatCauseRes2[[1]]`$; $p_{intercept} = `r IBPatCauseRes2[[2]]`$ and $slope = `r IBPatCauseRes2[[3]]`$; $p_{slope} = `r IBPatCauseRes2[[4]]`$). \qsoilb memory effects across the Iberian region are also characterised by an inverse relationship with mean \qsoilb values ($intercept = `r IBPatCauseRes2[[5]]`$; $p_{intercept} = `r IBPatCauseRes2[[6]]`$ and $slope = `r IBPatCauseRes2[[7]]`$; $p_{slope} = `r IBPatCauseRes2[[8]]`$).

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilc memory length and \qsoilc are depcited alongside raw data in figure \ref{fig:IBPatCausRes3}.
\vspace{-.3cm}
```{r IBPatCausRes3, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil3, Iberian Region) -} \\qsoilc vegetation memory coefficients and \\qsoilc memory length of figure \\ref{fig:IBRVegMem3} plotted against mean \\qsoilc records (see figure \\ref{fig:IBPDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:IBPatCausRes3}", fig.scap="Vegetation Memory Sensitivity (Qsoil3, Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPatCauseRes3 <- PatcausRes(Region = "Iberian Region", SoilLayer = 3, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoilc memory length across the Iberian region are characterised by an positive relationship with mean \qsoilc values ($intercept = `r IBPatCauseRes3[[1]]`$; $p_{intercept} = `r IBPatCauseRes3[[2]]`$ and $slope = `r IBPatCauseRes3[[3]]`$; $p_{slope} = `r IBPatCauseRes3[[4]]`$). \qsoilc memory effects across the Iberian region are characterised by an inverse relationship with mean \qsoilc values ($intercept = `r IBPatCauseRes3[[5]]`$; $p_{intercept} = `r IBPatCauseRes3[[6]]`$ and $slope = `r IBPatCauseRes3[[7]]`$; $p_{slope} = `r IBPatCauseRes3[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoild memory length and \qsoild are depcited alongside raw data in figure \ref{fig:IBPatCausRes4}.
\vspace{-.3cm}
```{r IBPatCausRes4, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil4, Iberian Region) -} \\qsoild vegetation memory coefficients and \\qsoild memory length of figure \\ref{fig:IBRVegMem4} plotted against mean \\qsoila records (see figure \\ref{fig:IBPDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:IBPatCausRes4}", fig.scap="Vegetation Memory Sensitivity (Qsoil4, Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPatCauseRes4 <- PatcausRes(Region = "Iberian Region", SoilLayer = 4, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoild memory length across the Iberian region are characterised by an positive relationship with mean \qsoild values ($intercept = `r IBPatCauseRes4[[1]]`$; $p_{intercept} = `r IBPatCauseRes4[[2]]`$ and $slope = `r IBPatCauseRes4[[3]]`$; $p_{slope} = `r IBPatCauseRes4[[4]]`$). \qsoild memory effects across the Iberian region are characterised by an inverse relationship with mean \qsoild values ($intercept = `r IBPatCauseRes4[[5]]`$; $p_{intercept} = `r IBPatCauseRes4[[6]]`$ and $slope = `r IBPatCauseRes4[[7]]`$; $p_{slope} = `r IBPatCauseRes4[[8]]`$).

\paragraph*{Summary}  \hspace{.5cm}

Linear regression coefficients of vegetation memory sensitivity relationships across the Iberian region are presented in table \ref{tab:IBPatCauseTab}. Almost all vegetation memory coefficients establish themselves in negative correlations with respective mean envionmental values. \qsoil memory coefficients are linked more strongly to mean \qsoil data than \ndvil memory coeficcients is to mean \ndvi data or \tair memory coefficients and mean \tair data.

```{r IBPatCauseTab, results = 'asis', echo = FALSE}
PatCauseTab(ModelCoeffs = c(unlist(IBPatCauseRes),
                 unlist(IBPatCauseRes1)[5:8], unlist(IBPatCauseRes2)[5:8], unlist(IBPatCauseRes3)[5:8], unlist(IBPatCauseRes4)[5:8],
                 unlist(IBPatCauseRes1)[1:4], unlist(IBPatCauseRes2)[1:4], unlist(IBPatCauseRes3)[1:4], unlist(IBPatCauseRes4)[1:4]), Region = "Iberian Region")
```

```{r IBPatCauseANOVA, results = 'asis', echo = FALSE}
IBANOVA <- PatCausAnova(Region = "Iberian Region")
```

The sensitivity of \qsoil vegetation memory to mean \qsoil layer data diminshes through \qsoil layers (from shallow to deep layers). This effect has been identified as statistically signifcant according to an \anova at $p = `r IBANOVA[[2]][1,5]`$ (established via \ref{rPatCausAnova}).

The correlation of \qsoil vegetation memory length to mean \qsoil layer data starts of negative for \qsoila and \qsoilb (diminishing when going from \qsoila to \qsoilb) and flips to being positive for \qsoilc and \qsoild (intensifying from \qsoilc to \qsoild). This effect has been identified as statistically signifcant according to an \anova at $p = `r IBANOVA[[1]][1,5]`$  (established via \ref{rPatCausAnova}).

\clearpage

#### Caatinga
\paragraph*{Intrisic Memory and Air Temperature}  \hspace{.5cm}
Sensitivity relationships of \ndvil and \tair are depcited alongside raw data in figure \ref{fig:CAPatCausRes}.
\vspace{-.3cm}
```{r CAPatCausRes, echo = FALSE, fig.width = 17, fig.height = 12, fig.subcap=c('NDVI t-1', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (NDVI t-1 and Tair, Caatinga) -} Vegetation memory coefficients of figure \\ref{fig:CAVegMem1} plotted against mean intrinsic and extrinsic drivers (see figure \\ref{fig:CaatDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:CAPatCausRes}", fig.scap="Vegetation Memory Sensitivity (NDVI t-1 and Tair, Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPatCauseRes <- PatcausRes(Region = "Caatinga", SoilLayer = 1, SoilOnly = FALSE)
```
\vspace{-.3cm}
\ndvil memory effects across the Caatinga are characterised by an inverse relationship with mean \ndvi values ($intercept = `r CAPatCauseRes[[1]]`$; $p_{intercept} = `r CAPatCauseRes[[2]]`$ and $slope = `r CAPatCauseRes[[3]]`$; $p_{slope} = `r CAPatCauseRes[[4]]`$). \tair memory effects across the Caatinga are also characterised by an inverse relationship with mean \tair values ($intercept = `r CAPatCauseRes[[5]]`$; $p_{intercept} = `r CAPatCauseRes[[6]]`$ and $slope = `r CAPatCauseRes[[7]]`$; $p_{slope} = `r CAPatCauseRes[[8]]`$).

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoila memory length and \qsoila are depcited alongside raw data in figure \ref{fig:CAPatCausRes1}.
\vspace{-.3cm}
```{r CAPatCausRes1, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil1, Caatinga) -} \\qsoila vegetation memory coefficients and \\qsoila memory length of figure \\ref{fig:CAVegMem1} plotted against mean \\qsoila records (see figure \\ref{fig:CaatDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:CAPatCausRes1}", fig.scap="Vegetation Memory Sensitivity (Qsoil1, Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPatCauseRes1 <- PatcausRes(Region = "Caatinga", SoilLayer = 1, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoila memory length across the Caatinga are characterised by an inverse relationship with mean \qsoila values ($intercept = `r CAPatCauseRes1[[1]]`$; $p_{intercept} = `r CAPatCauseRes1[[2]]`$ and $slope = `r CAPatCauseRes1[[3]]`$; $p_{slope} = `r CAPatCauseRes1[[4]]`$). \qsoila memory effects across the Caatinga are also characterised by an inverse relationship with mean \qsoila values ($intercept = `r CAPatCauseRes1[[5]]`$; $p_{intercept} = `r CAPatCauseRes1[[6]]`$ and $slope = `r CAPatCauseRes1[[7]]`$; $p_{slope} = `r CAPatCauseRes1[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilb memory length and \qsoilb are depcited alongside raw data in figure \ref{fig:CAPatCausRes2}.
\vspace{-.3cm}
```{r CAPatCausRes2, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil2, Caatinga) -} \\qsoilb vegetation memory coefficients and \\qsoilb memory length of figure \\ref{fig:CAVegMem2} plotted against mean \\qsoilb records (see figure \\ref{fig:CaatDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:CAPatCausRes2}", fig.scap="Vegetation Memory Sensitivity (Qsoil2, Caatinga)", ache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPatCauseRes2 <- PatcausRes(Region = "Caatinga", SoilLayer = 2, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoilb memory length across the Caatinga are characterised by a positive relationship with mean \qsoilb values ($intercept = `r CAPatCauseRes2[[1]]`$; $p_{intercept} = `r CAPatCauseRes2[[2]]`$ and $slope = `r CAPatCauseRes2[[3]]`$; $p_{slope} = `r CAPatCauseRes2[[4]]`$). \qsoilb memory effects across the Caatinga are characterised by an inverse relationship with mean \qsoilb values ($intercept = `r CAPatCauseRes2[[5]]`$; $p_{intercept} = `r CAPatCauseRes2[[6]]`$ and $slope = `r CAPatCauseRes2[[7]]`$; $p_{slope} = `r CAPatCauseRes2[[8]]`$).

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilc memory length and \qsoilc are depcited alongside raw data in figure \ref{fig:CAPatCausRes3}.
\vspace{-.3cm}
```{r CAPatCausRes3, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil3, Caatinga) -} \\qsoilc vegetation memory coefficients and \\qsoilc memory length of figure \\ref{fig:CAVegMem3} plotted against mean \\qsoilc records (see figure \\ref{fig:CaatDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:CAPatCausRes3}", fig.scap="Vegetation Memory Sensitivity (Qsoil3, Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPatCauseRes3 <- PatcausRes(Region = "Caatinga", SoilLayer = 3, SoilOnly = TRUE)
```
\qsoilc memory length across the Caatinga are characterised by an inverse relationship with mean \qsoilc values ($intercept = `r CAPatCauseRes3[[1]]`$; $p_{intercept} = `r CAPatCauseRes3[[2]]`$ and $slope = `r CAPatCauseRes3[[3]]`$; $p_{slope} = `r CAPatCauseRes3[[4]]`$). \qsoilc memory effects across the Caatinga are also characterised by an inverse relationship with mean \qsoilc values ($intercept = `r CAPatCauseRes3[[5]]`$; $p_{intercept} = `r CAPatCauseRes3[[6]]`$ and $slope = `r CAPatCauseRes3[[7]]`$; $p_{slope} = `r CAPatCauseRes3[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoild memory length and \qsoild are depcited alongside raw data in figure \ref{fig:CAPatCausRes4}.
\vspace{-.3cm}
```{r CAPatCausRes4, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil4, Caatinga) -} \\qsoild vegetation memory coefficients and \\qsoild memory length of figure \\ref{fig:CAVegMem4} plotted against mean \\qsoila records (see figure \\ref{fig:CaatDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:CAPatCausRes4}", fig.scap="Vegetation Memory Sensitivity (Qsoil4, Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPatCauseRes4 <- PatcausRes(Region = "Caatinga", SoilLayer = 4, SoilOnly = TRUE)
```
\qsoild memory length across the Caatinga are characterised by an inverse relationship with mean \qsoild values ($intercept = `r CAPatCauseRes4[[1]]`$; $p_{intercept} = `r CAPatCauseRes4[[2]]`$ and $slope = `r CAPatCauseRes4[[3]]`$; $p_{slope} = `r CAPatCauseRes4[[4]]`$). \qsoild memory effects across the Caatinga are characterised by a positive relationship with mean \qsoild values ($intercept = `r CAPatCauseRes4[[5]]`$; $p_{intercept} = `r CAPatCauseRes4[[6]]`$ and $slope = `r CAPatCauseRes4[[7]]`$; $p_{slope} = `r CAPatCauseRes4[[8]]`$).

\paragraph*{Summary}  \hspace{.5cm}

Linear regression coefficients of vegetation memory sensitivity relationships across the Caatinga are presented in table \ref{tab:AUPatCauseTab}. Almost all vegetation memory coefficients establish themselves in negative correlations with respective mean envionmental values. \qsoila, \qsoilb, \qsoilc, and \ndvil are linked especially strongly to environmental mean drivers.

```{r CAPatCauseTab, results = 'asis', echo = FALSE}
PatCauseTab(ModelCoeffs = c(unlist(CAPatCauseRes),
                 unlist(CAPatCauseRes1)[5:8], unlist(CAPatCauseRes2)[5:8], unlist(CAPatCauseRes3)[5:8], unlist(CAPatCauseRes4)[5:8],
                 unlist(CAPatCauseRes1)[1:4], unlist(CAPatCauseRes2)[1:4], unlist(CAPatCauseRes3)[1:4], unlist(CAPatCauseRes4)[1:4]), Region = "Caatinga")
```

```{r CAPatCauseANOVA, results = 'asis', echo = FALSE}
CAANOVA <- PatCausAnova(Region = "Caatinga")
```

The sensitivity of \qsoil vegetation memory to mean \qsoil layer data fluctuates across the soil layer range whilst diminishing from \qsoila to \qsoilb. These differences have been been identified as statistically signifcant according to an \anova at $p = `r CAANOVA[[2]][1,5]`$ (established via \ref{rPatCausAnova}).

The correlation of \qsoil vegetation memory length to mean \qsoil layer follows no identifyable linear pattern. Differences in linear regressions have been identified as statistically signifcant according to an \anova at $p = `r CAANOVA[[1]][1,5]`$  (established via \ref{rPatCausAnova}).

\clearpage

#### Australia
\paragraph*{Intrisic Memory and Air Temperature}  \hspace{.5cm}
Sensitivity relationships of \ndvil and \tair are depcited alongside raw data in figure \ref{fig:AUPatCausRes}.
\vspace{-.3cm}
```{r AUPatCausRes, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('NDVI t-1', 'Tair'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (NDVI t-1 and Tair, Australia) -} Vegetation memory coefficients of figure \\ref{fig:AUVegMem1} plotted against mean intrinsic and extrinsic drivers (see figure \\ref{fig:AUDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:AUPatCausRes}", fig.scap="Vegetation Memory Sensitivity (NDVI t-1 and Tair, Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPatCauseRes <- PatcausRes(Region = "Australia", SoilLayer = 1, SoilOnly = FALSE)
```
\vspace{-.3cm}
\ndvil memory effects across Australia are characterised by an inverse relationship with mean \ndvi values ($intercept = `r AUPatCauseRes[[1]]`$; $p_{intercept} = `r AUPatCauseRes[[2]]`$ and $slope = `r AUPatCauseRes[[3]]`$; $p_{slope} = `r AUPatCauseRes[[4]]`$). \tair memory effects across Australia are also characterised by an inverse relationship with mean \tair values ($intercept = `r AUPatCauseRes[[5]]`$; $p_{intercept} = `r AUPatCauseRes[[6]]`$ and $slope = `r AUPatCauseRes[[7]]`$; $p_{slope} = `r AUPatCauseRes[[8]]`$).

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoila memory length and \qsoila are depcited alongside raw data in figure \ref{fig:AUPatCausRes1}.
\vspace{-.3cm}
```{r AUPatCausRes1, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil1, Australia) -} \\qsoila vegetation memory coefficients and \\qsoila memory length of figure \\ref{fig:AUVegMem1} plotted against mean \\qsoila records (see figure \\ref{fig:AUDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:AUPatCausRes1}", fig.scap="Vegetation Memory Sensitivity (Qsoil1, Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPatCauseRes1 <- PatcausRes(Region = "Australia", SoilLayer = 1, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoila memory length across Australia are characterised by an inverse relationship with mean \qsoila values ($intercept = `r AUPatCauseRes1[[1]]`$; $p_{intercept} = `r AUPatCauseRes1[[2]]`$ and $slope = `r AUPatCauseRes1[[3]]`$; $p_{slope} = `r AUPatCauseRes1[[4]]`$). \qsoila memory effects across Australia are also characterised by an inverse relationship with mean \qsoila values ($intercept = `r AUPatCauseRes1[[5]]`$; $p_{intercept} = `r AUPatCauseRes1[[6]]`$ and $slope = `r AUPatCauseRes1[[7]]`$; $p_{slope} = `r AUPatCauseRes1[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilb memory length and \qsoilb are depcited alongside raw data in figure \ref{fig:AUPatCausRes2}.
\vspace{-.3cm}
```{r AUPatCausRes2, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil2, Australia) -} \\qsoilb vegetation memory coefficients and \\qsoilb memory length of figure \\ref{fig:AUVegMem2} plotted against mean \\qsoilb records (see figure \\ref{fig:AUDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:AUPatCausRes2}", fig.scap="Vegetation Memory Sensitivity (Qsoil2, Australia)", ache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPatCauseRes2 <- PatcausRes(Region = "Australia", SoilLayer = 2, SoilOnly = TRUE)
```
\vspace{-.3cm}
\qsoilb memory length across Australia are characterised by a negative relationship with mean \qsoilb values ($intercept = `r AUPatCauseRes2[[1]]`$; $p_{intercept} = `r AUPatCauseRes2[[2]]`$ and $slope = `r AUPatCauseRes2[[3]]`$; $p_{slope} = `r AUPatCauseRes2[[4]]`$). \qsoilb memory effects across Australia are characterised by a positive relationship with mean \qsoilb values ($intercept = `r AUPatCauseRes2[[5]]`$; $p_{intercept} = `r AUPatCauseRes2[[6]]`$ and $slope = `r AUPatCauseRes2[[7]]`$; $p_{slope} = `r AUPatCauseRes2[[8]]`$).

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoilc memory length and \qsoilc are depcited alongside raw data in figure \ref{fig:AUPatCausRes3}.
\vspace{-.3cm}
```{r AUPatCausRes3, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil3, Australia) -} \\qsoilc vegetation memory coefficients and \\qsoilc memory length of figure \\ref{fig:AUVegMem3} plotted against mean \\qsoilc records (see figure \\ref{fig:AUDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:AUPatCausRes3}", fig.scap="Vegetation Memory Sensitivity (Qsoil3, Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPatCauseRes3 <- PatcausRes(Region = "Australia", SoilLayer = 3, SoilOnly = TRUE)
```
\qsoilc memory length across Australia are characterised by a positive relationship with mean \qsoilc values ($intercept = `r AUPatCauseRes3[[1]]`$; $p_{intercept} = `r AUPatCauseRes3[[2]]`$ and $slope = `r AUPatCauseRes3[[3]]`$; $p_{slope} = `r AUPatCauseRes3[[4]]`$). \qsoilc memory effects across Australia are characterised by an inverse relationship with mean \qsoilc values ($intercept = `r AUPatCauseRes3[[5]]`$; $p_{intercept} = `r AUPatCauseRes3[[6]]`$ and $slope = `r AUPatCauseRes3[[7]]`$; $p_{slope} = `r AUPatCauseRes3[[8]]`$).

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}
Sensitivity relationships of \qsoild memory length and \qsoild are depcited alongside raw data in figure \ref{fig:AUPatCausRes4}.
\vspace{-.3cm}
```{r AUPatCausRes4, echo = FALSE, fig.width = 17, fig.height = 11, fig.subcap=c('Memory Length (Lag)', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Sensitivity (Qsoil4, Australia) -} \\qsoild vegetation memory coefficients and \\qsoild memory length of figure \\ref{fig:AUVegMem4} plotted against mean \\qsoila records (see figure \\ref{fig:AUDataOverview}). Figure established via \\ref{rPatCausRes}. \\label{fig:AUPatCausRes4}", fig.scap="Vegetation Memory Sensitivity (Qsoil4, Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPatCauseRes4 <- PatcausRes(Region = "Australia", SoilLayer = 4, SoilOnly = TRUE)
```
\qsoild memory length across Australia are characterised by an inverse relationship with mean \qsoild values ($intercept = `r AUPatCauseRes4[[1]]`$; $p_{intercept} = `r AUPatCauseRes4[[2]]`$ and $slope = `r AUPatCauseRes4[[3]]`$; $p_{slope} = `r AUPatCauseRes4[[4]]`$). \qsoild memory effects across Australia are characterised by a positive relationship with mean \qsoild values ($intercept = `r AUPatCauseRes4[[5]]`$; $p_{intercept} = `r AUPatCauseRes4[[6]]`$ and $slope = `r AUPatCauseRes4[[7]]`$; $p_{slope} = `r AUPatCauseRes4[[8]]`$).

\paragraph*{Summary}  \hspace{.5cm}

Linear regression coefficients of vegetation memory sensitivity relationships across Australia are presented in table \ref{tab:AUPatCauseTab}. Almost all vegetation memory coefficients establish themselves in negative correlations with respective mean envionmental values. \qsoila memory length, \qsoild (in a positive relationship), and \ndvil are linked especially strongly to environmental mean drivers.

```{r AUPatCauseTab, results = 'asis', echo = FALSE}
PatCauseTab(ModelCoeffs = c(unlist(AUPatCauseRes),
                 unlist(AUPatCauseRes1)[5:8], unlist(AUPatCauseRes2)[5:8], unlist(AUPatCauseRes3)[5:8], unlist(AUPatCauseRes4)[5:8],
                 unlist(AUPatCauseRes1)[1:4], unlist(AUPatCauseRes2)[1:4], unlist(AUPatCauseRes3)[1:4], unlist(AUPatCauseRes4)[1:4]), Region = "Australia")
```

```{r AUPatCauseANOVA, results = 'asis', echo = FALSE}
AUANOVA <- PatCausAnova(Region = "Australia")
```

The sensitivity of \qsoil vegetation memory to mean \qsoil layer data fluctuates across the soil layer range with \qsoild coefficients' relation to mean \qsoil drivers being strong and positive. These differences have been been identified as statistically signifcant according to an \anova at $p = `r AUANOVA[[2]][1,5]`$ (established via \ref{rPatCausAnova}).

The correlation of \qsoil vegetation memory length to mean \qsoil layer follows no identifyable linear pattern. Differences in linear regressions have been identified as statistically signifcant according to an \anova at $p = `r AUANOVA[[1]][1,5]`$  (established via \ref{rPatCausAnova}).

\clearpage

#### Summary

In terms of vegetation memory sensitivity:
\begin{enumerate}
\item \textbf{\ndvil} memory coefficients are \textbf{strongly negatively correlated} to mean \ndvi records.
\item \textbf{\tair} memory coefficients are \textbf{wekly negatively correlated} to mean \tair records.
\item \textbf{\qsoil} memory coefficients are \textbf{overwelmingly correlated strongly negatively} to mean \qsoil records.
\item \textbf{\qsoil memory length} is \textbf{largely correlated negatively} with mean \qsoil records. Noticeable exceptions include \qsoilc and \qsoild across the Iberian region.
\end{enumerate}

With the exception of \qsoild across Australia, \textbf{\qsoil vegetation memory sensitivity decreases as soil layers become deeper}.

\textbf{Strong correlations of \qsoil memory length} and mean \qsoil records is usually found in \textbf{\qsoila} and \textbf{\qsoild}.

\clearpage

## Functional Aspects of Vegetation Memory
### Life History Traits
#### Iberian Region
\paragraph*{Fast-Slow Continuum}  \hspace{.5cm}

figure \ref{fig:IBCOMPAD1}
table \ref{tab:IBCOMPADTab1}

figure \ref{fig:IBCOMPAD2}
table \ref{tab:IBCOMPADTab2}

```{r IBCOMPAD1, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-1 and Vegetation Memory (Iberian Region) -} Linear regression coefficients of COMPADRE FSC-1 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:IBCOMPAD1}", fig.scap="COMPADRE FSC-1 and Vegetation Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg1 <- Comres(Region = "Iberian Region", Variable = "FSC-1")
```


```{r IBCOMPADTab1, results = 'asis', echo = FALSE}
CompadTab(Region = "Iberian Region", ModelCoeffs = c(unlist(leg1[[2]])), Variable = "FSC-1")
```

\clearpage

```{r IBCOMPAD2, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-2 and Vegetation Memory (Iberian Region) -} Linear regression coefficients of COMPADRE FSC-2 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:IBCOMPAD2}", fig.scap="COMPADRE FSC-2 and Vegetation Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg2 <- Comres(Region = "Iberian Region", Variable = "FSC-2")
```


```{r IBCOMPADTab2, results = 'asis', echo = FALSE}
CompadTab(Region = "Iberian Region", ModelCoeffs = c(unlist(leg2[[2]])), Variable = "FSC-2")
```

\clearpage

\paragraph*{Period of Oscillation}  \hspace{.5cm}

figure \ref{fig:IBCOMPAD3}
table \ref{tab:IBCOMPADTab3}

```{r IBCOMPAD3, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Period of Oscillation and Vegetation Memory (Iberian Region) -} Linear regression coefficients of COMPADRE Period of Oscillation and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:IBCOMPAD3}", fig.scap="COMPADRE Period of Oscillation and Vegetation Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg3 <- Comres(Region = "Iberian Region", Variable = "Pi")
```

```{r IBCOMPADTab3, results = 'asis', echo = FALSE}
CompadTab(Region = "Iberian Region", ModelCoeffs = c(unlist(leg3[[2]])), Variable = "Pi")
```

\clearpage

\paragraph*{Damping Ratio}  \hspace{.5cm}

figure \ref{fig:IBCOMPAD4}
table \ref{tab:IBCOMPADTab4} 

```{r IBCOMPAD4, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Damping Ratio and Vegetation Memory (Iberian Region) -} Linear regression coefficients of COMPADRE Damping Ratio and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:IBCOMPAD4}", fig.scap="COMPADRE Damping Ratio and Vegetation Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg4 <- Comres(Region = "Iberian Region", Variable = "Rho")
```

```{r IBCOMPADTab4, results = 'asis', echo = FALSE}
CompadTab(Region = "Iberian Region", ModelCoeffs = c(unlist(leg4[[2]])), Variable = "Rho")
```

\clearpage

\paragraph*{Reactivity}  \hspace{.5cm}

figure \ref{fig:IBCOMPAD5} 
table \ref{tab:IBCOMPADTab5}

```{r IBCOMPAD5, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Reactivity and Vegetation Memory (Iberian Region) -} Linear regression coefficients of COMPADRE Reactivity and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:IBCOMPAD5}", fig.scap="COMPADRE Reactivity and Vegetation Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg5 <- Comres(Region = "Iberian Region", Variable = "Reactivity")
```

```{r IBCOMPADTab5, results = 'asis', echo = FALSE}
CompadTab(Region = "Iberian Region", ModelCoeffs = c(unlist(leg5[[2]])), Variable = "Reactivity")
```

\paragraph*{Summary}  \hspace{.5cm}
\clearpage

#### Caatinga

\paragraph*{Fast-Slow Continuum}  \hspace{.5cm}

figure \ref{fig:CACOMPAD1}
table \ref{tab:CACOMPADTab1}

figure \ref{fig:CACOMPAD2}
table \ref{tab:CACOMPADTab2}

```{r CACOMPAD1, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-1 and Vegetation Memory (Caatinga) -} Linear regression coefficients of COMPADRE FSC-1 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:CACOMPAD1}", fig.scap="COMPADRE FSC-1 and Vegetation Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg1 <- Comres(Region = "Caatinga", Variable = "FSC-1")
```


```{r CACOMPADTab1, results = 'asis', echo = FALSE}
CompadTab(Region = "Caatinga", ModelCoeffs = c(unlist(leg1[[2]])), Variable = "FSC-1")
```

\clearpage

```{r CACOMPAD2, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-2 and Vegetation Memory (Caatinga) -} Linear regression coefficients of COMPADRE FSC-2 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:CACOMPAD2}", fig.scap="COMPADRE FSC-2 and Vegetation Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg2 <- Comres(Region = "Caatinga", Variable = "FSC-2")
```


```{r CACOMPADTab2, results = 'asis', echo = FALSE}
CompadTab(Region = "Caatinga", ModelCoeffs = c(unlist(leg2[[2]])), Variable = "FSC-2")
```

\clearpage

\paragraph*{Period of Oscillation}  \hspace{.5cm}

figure \ref{fig:CACOMPAD3}
table \ref{tab:CACOMPADTab3}

```{r CACOMPAD3, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Period of Oscillation and Vegetation Memory (Caatinga) -} Linear regression coefficients of COMPADRE Period of Oscillation and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:CACOMPAD3}", fig.scap="COMPADRE Period of Oscillation and Vegetation Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg3 <- Comres(Region = "Caatinga", Variable = "Pi")
```


```{r CACOMPADTab3, results = 'asis', echo = FALSE}
CompadTab(Region = "Caatinga", ModelCoeffs = c(unlist(leg3[[2]])), Variable = "Pi")
```

\clearpage

\paragraph*{Damping Ratio}  \hspace{.5cm}

figure \ref{fig:CACOMPAD4}
table \ref{tab:CACOMPADTab4}

```{r CACOMPAD4, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Damping Ratio and Vegetation Memory (Caatinga) -} Linear regression coefficients of COMPADRE Damping Ratio and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:CACOMPAD4}", fig.scap="COMPADRE Damping Ratio and Vegetation Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg4 <- Comres(Region = "Caatinga", Variable = "Rho")
```


```{r CACOMPADTab4, results = 'asis', echo = FALSE}
CompadTab(Region = "Caatinga", ModelCoeffs = c(unlist(leg4[[2]])), Variable = "Rho")
```

\clearpage

\paragraph*{Reactivity}  \hspace{.5cm}

figure \ref{fig:CACOMPAD5} 
table \ref{tab:CACOMPADTab5} 

```{r CACOMPAD5, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Reactivity and Vegetation Memory (Caatinga) -} Linear regression coefficients of COMPADRE Reactivity and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:CACOMPAD5}", fig.scap="COMPADRE Reactivity and Vegetation Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg5 <- Comres(Region = "Caatinga", Variable = "Reactivity")
```


```{r CACOMPADTab5, results = 'asis', echo = FALSE}
CompadTab(Region = "Caatinga", ModelCoeffs = c(unlist(leg5[[2]])), Variable = "Reactivity")
```

\paragraph*{Summary}  \hspace{.5cm}
\clearpage

#### Australia

\paragraph*{Fast-Slow Continuum}  \hspace{.5cm}

figure \ref{fig:AUCOMPAD1}
table \ref{tab:AUCOMPADTab1}

figure \ref{fig:AUCOMPAD2}
table \ref{tab:AUCOMPADTab2}

```{r AUCOMPAD1, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-1 and Vegetation Memory (Australia) -} Linear regression coefficients of COMPADRE FSC-1 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:AUCOMPAD1}", fig.scap="COMPADRE FSC-1 and Vegetation Memory (Australia)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg1 <- Comres(Region = "Australia", Variable = "FSC-1")
```


```{r AUCOMPADTab1, results = 'asis', echo = FALSE}
CompadTab(Region = "Australia", ModelCoeffs = c(unlist(leg1[[2]])), Variable = "FSC-1")
```

\clearpage

```{r AUCOMPAD2, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE FSC-2 and Vegetation Memory (Australia) -} Linear regression coefficients of COMPADRE FSC-2 and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:AUCOMPAD2}", fig.scap="COMPADRE FSC-2 and Vegetation Memory (Australia)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg2 <- Comres(Region = "Australia", Variable = "FSC-2")
```


```{r AUCOMPADTab2, results = 'asis', echo = FALSE}
CompadTab(Region = "Australia", ModelCoeffs = c(unlist(leg2[[2]])), Variable = "FSC-2")
```

\clearpage

\paragraph*{Period of Oscillation}  \hspace{.5cm}

figure \ref{fig:AUCOMPAD3}
table \ref{tab:AUCOMPADTab3}

```{r AUCOMPAD3, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Period of Oscillation and Vegetation Memory (Australia) -} Linear regression coefficients of COMPADRE Period of Oscillation and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:AUCOMPAD3}", fig.scap="COMPADRE Period of Oscillation and Vegetation Memory (Australia)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg3 <- Comres(Region = "Australia", Variable = "Pi")
```


```{r AUCOMPADTab3, results = 'asis', echo = FALSE}
CompadTab(Region = "Australia", ModelCoeffs = c(unlist(leg3[[2]])), Variable = "Pi")
```

\clearpage

\paragraph*{Damping Ratio}  \hspace{.5cm}

figure \ref{fig:AUCOMPAD4}
table \ref{tab:AUCOMPADTab4}

```{r AUCOMPAD4, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Damping Ratio and Vegetation Memory (Australia) -} Linear regression coefficients of COMPADRE Damping Ratio and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:AUCOMPAD4}", fig.scap="COMPADRE Damping Ratio and Vegetation Memory (Australia)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg4 <- Comres(Region = "Australia", Variable = "Rho")
```


```{r AUCOMPADTab4, results = 'asis', echo = FALSE}
CompadTab(Region = "Australia", ModelCoeffs = c(unlist(leg4[[2]])), Variable = "Rho")
```

\clearpage

\paragraph*{Reactivity}  \hspace{.5cm}

figure \ref{fig:AUCOMPAD5} 
table \ref{tab:AUCOMPADTab5}

```{r AUCOMPAD5, echo = FALSE, fig.width = 17, fig.height = 8, fig.cap="\\textbf{COMPADRE Reactivity and Vegetation Memory (Australia) -} Linear regression coefficients of COMPADRE Reactivity and vegetation memory coefficients. Figure established via \\ref{rCOMRes}. \\label{fig:AUCOMPAD5}", fig.scap="COMPADRE Reactivity and Vegetation Memory (Australia)", cache = TRUE, cache.lazy=FALSE, out.extra='', fig.pos = 'h!'}
leg5 <- Comres(Region = "Australia", Variable = "Reactivity")
```


```{r AUCOMPADTab5, results = 'asis', echo = FALSE}
CompadTab(Region = "Australia", ModelCoeffs = c(unlist(leg5[[2]])), Variable = "Reactivity")
```

\paragraph*{Summary}  \hspace{.5cm}
\clearpage

#### Summary

### Plant Functional Traits
#### Iberian Region
\paragraph*{Intrinsic Memory}  \hspace{.5cm}

figure \ref{fig:IBPFT1}

```{r IBPFT1, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Intrinsic Memory (Iberian Region) -} Intrinsic Memory (NDVI t-1, figure \\ref{fig:IBRVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT1}", fig.scap="PFTs and Intrinsic Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT1 <- Tryres(Region = "Iberian Region", SoilLayer = 1, Variable = "t-1")
```

\vh (raw) - $Intercept = `r IBPFT1[[1]]`$ ($p = `r IBPFT1[[2]]`$); $r = `r IBPFT1[[3]]`$ ($p = `r IBPFT1[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT1[[5]]`$ ($p = `r IBPFT1[[6]]`$); $r = `r IBPFT1[[7]]`$ ($p = `r IBPFT1[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT1[[9]]`$ ($p = `r IBPFT1[[10]]`$); $r = `r IBPFT1[[11]]`$ ($p = `r IBPFT1[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT1[[13]]`$ ($p = `r IBPFT1[[14]]`$); $r = `r IBPFT1[[15]]`$ ($p = `r IBPFT1[[16]]`$)

\clearpage

\paragraph*{Air Temperature}  \hspace{.5cm}

figure \ref{fig:IBPFT2}

```{r IBPFT2, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Tair Memory (Iberian Region) -} Tair Memory (figure \\ref{fig:IBRVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT2}", fig.scap="PFTs and Tair Memory (Iberian Region)",  cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT2 <- Tryres(Region = "Iberian Region", SoilLayer = 1, Variable = "Tair")
```

\vh (raw) - $Intercept = `r IBPFT2[[1]]`$ ($p = `r IBPFT2[[2]]`$); $r = `r IBPFT2[[3]]`$ ($p = `r IBPFT2[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT2[[5]]`$ ($p = `r IBPFT2[[6]]`$); $r = `r IBPFT2[[7]]`$ ($p = `r IBPFT2[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT2[[9]]`$ ($p = `r IBPFT2[[10]]`$); $r = `r IBPFT2[[11]]`$ ($p = `r IBPFT2[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT2[[13]]`$ ($p = `r IBPFT2[[14]]`$); $r = `r IBPFT2[[15]]`$ ($p = `r IBPFT2[[16]]`$)

\clearpage

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}

figure \ref{fig:IBPFT3}
table \ref{tab:IBPFTTab3}

```{r IBPFT3, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil1 Memory (Iberian Region) -} \\qsoila Memory (figure \\ref{fig:IBRVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT3}", fig.scap="PFTs and Qsoil1 Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT3 <- Tryres(Region = "Iberian Region", SoilLayer = 1, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r IBPFT3[[1]]`$ ($p = `r IBPFT3[[2]]`$); $r = `r IBPFT3[[3]]`$ ($p = `r IBPFT3[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT3[[5]]`$ ($p = `r IBPFT3[[6]]`$); $r = `r IBPFT3[[7]]`$ ($p = `r IBPFT3[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT3[[9]]`$ ($p = `r IBPFT3[[10]]`$); $r = `r IBPFT3[[11]]`$ ($p = `r IBPFT3[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT3[[13]]`$ ($p = `r IBPFT3[[14]]`$); $r = `r IBPFT3[[15]]`$ ($p = `r IBPFT3[[16]]`$)

```{r IBPFTTab3, results = 'asis', echo = FALSE}
TryTab(Region = "Iberian Region", ModelCoeffs = IBPFT3, SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}

figure \ref{fig:IBPFT4}
table \ref{tab:IBPFTTab4}

```{r IBPFT4, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil2 Memory (Iberian Region) -} \\qsoilb Memory (figure \\ref{fig:IBRVegMem2}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT4}", fig.scap="PFTs and Qsoil2 Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT4 <- Tryres(Region = "Iberian Region", SoilLayer = 2, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r IBPFT4[[1]]`$ ($p = `r IBPFT4[[2]]`$); $r = `r IBPFT4[[3]]`$ ($p = `r IBPFT4[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT4[[5]]`$ ($p = `r IBPFT4[[6]]`$); $r = `r IBPFT4[[7]]`$ ($p = `r IBPFT4[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT4[[9]]`$ ($p = `r IBPFT4[[10]]`$); $r = `r IBPFT4[[11]]`$ ($p = `r IBPFT4[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT4[[13]]`$ ($p = `r IBPFT4[[14]]`$); $r = `r IBPFT4[[15]]`$ ($p = `r IBPFT4[[16]]`$)

```{r IBPFTTab4, results = 'asis', echo = FALSE}
TryTab(Region = "Iberian Region", ModelCoeffs = IBPFT4, SoilLayer = 2)
```

\clearpage

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}

figure \ref{fig:IBPFT5}
table \ref{tab:IBPFTTab5}

```{r IBPFT5, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil3 Memory (Iberian Region) -} \\qsoilc Memory (figure \\ref{fig:IBRVegMem3}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT5}", fig.scap="PFTs and Qsoil3 Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT5 <- Tryres(Region = "Iberian Region", SoilLayer = 3, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r IBPFT5[[1]]`$ ($p = `r IBPFT5[[2]]`$); $r = `r IBPFT5[[3]]`$ ($p = `r IBPFT5[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT5[[5]]`$ ($p = `r IBPFT5[[6]]`$); $r = `r IBPFT5[[7]]`$ ($p = `r IBPFT5[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT5[[9]]`$ ($p = `r IBPFT5[[10]]`$); $r = `r IBPFT5[[11]]`$ ($p = `r IBPFT5[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT5[[13]]`$ ($p = `r IBPFT5[[14]]`$); $r = `r IBPFT5[[15]]`$ ($p = `r IBPFT5[[16]]`$)

```{r IBPFTTab5, results = 'asis', echo = FALSE}
TryTab(Region = "Iberian Region", ModelCoeffs = IBPFT5, SoilLayer = 3)
```

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}

figure \ref{fig:IBPFT6}
table \ref{tab:IBPFTTab6}

```{r IBPFT6, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil4 Memory (Iberian Region) -} \\qsoild Memory (figure \\ref{fig:IBRVegMem4}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:IBPTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:IBPFT6}", fig.scap="PFTs and Qsoil4 Memory (Iberian Region)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
IBPFT6 <- Tryres(Region = "Iberian Region", SoilLayer = 4, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r IBPFT6[[1]]`$ ($p = `r IBPFT6[[2]]`$); $r = `r IBPFT6[[3]]`$ ($p = `r IBPFT6[[4]]`$)

\vh (mapped) - $Intercept = `r IBPFT6[[5]]`$ ($p = `r IBPFT6[[6]]`$); $r = `r IBPFT6[[7]]`$ ($p = `r IBPFT6[[8]]`$)

\nmass (raw) - $Intercept = `r IBPFT6[[9]]`$ ($p = `r IBPFT6[[10]]`$); $r = `r IBPFT6[[11]]`$ ($p = `r IBPFT6[[12]]`$)

\nmass (mapped) - $Intercept = `r IBPFT6[[13]]`$ ($p = `r IBPFT6[[14]]`$); $r = `r IBPFT6[[15]]`$ ($p = `r IBPFT6[[16]]`$)

```{r IBPFTTab6, results = 'asis', echo = FALSE}
TryTab(Region = "Iberian Region", ModelCoeffs = IBPFT6, SoilLayer = 4)
```

\clearpage

\paragraph*{Summary}  \hspace{.5cm}
table \ref{tab:IBPFTTabRaw}
table \ref{tab:IBPFTTabMapped} 

```{r IBPFTTabRaw, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(IBPFT1)[c(1:4, 9:12)], unlist(IBPFT2)[c(1:4, 9:12)], 
                 unlist(IBPFT3)[c(1:4, 9:12)], unlist(IBPFT4)[c(1:4, 9:12)], 
                 unlist(IBPFT5)[c(1:4, 9:12)], unlist(IBPFT6)[c(1:4, 9:12)]), Region = "Iberian Region", Data = "Geo-referenced")
```

```{r IBPFTTabMapped, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(IBPFT1)[c(5:8, 13:16)], unlist(IBPFT2)[c(5:8, 13:16)], 
                 unlist(IBPFT3)[c(5:8, 13:16)], unlist(IBPFT4)[c(5:8, 13:16)], 
                 unlist(IBPFT5)[c(5:8, 13:16)], unlist(IBPFT6)[c(5:8, 13:16)]), Region = "Iberian Region", Data = "Mapped species-specific mean")
```
\clearpage

#### Caatinga
\paragraph*{Intrinsic Memory}  \hspace{.5cm}

figure \ref{fig:CAPFT1}

```{r CAPFT1, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Intrinsic Memory (Caatinga) -} Intrinsic Memory (NDVI t-1, figure \\ref{fig:CAVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT1}", fig.scap="PFTs and Intrinsic Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT1 <- Tryres(Region = "Caatinga", SoilLayer = 1, Variable = "t-1")
```

\vh (raw) - $Intercept = `r CAPFT1[[1]]`$ ($p = `r CAPFT1[[2]]`$); $r = `r CAPFT1[[3]]`$ ($p = `r CAPFT1[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT1[[5]]`$ ($p = `r CAPFT1[[6]]`$); $r = `r CAPFT1[[7]]`$ ($p = `r CAPFT1[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT1[[9]]`$ ($p = `r CAPFT1[[10]]`$); $r = `r CAPFT1[[11]]`$ ($p = `r CAPFT1[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT1[[13]]`$ ($p = `r CAPFT1[[14]]`$); $r = `r CAPFT1[[15]]`$ ($p = `r CAPFT1[[16]]`$)

\clearpage

\paragraph*{Air Temperature}  \hspace{.5cm}

figure \ref{fig:CAPFT2}

```{r CAPFT2, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Tair Memory (Caatinga) -} Tair Memory (figure \\ref{fig:CAVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT2}", fig.scap="PFTs and Tair Memory (Caatinga)",  cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT2 <- Tryres(Region = "Caatinga", SoilLayer = 1, Variable = "Tair")
```

\vh (raw) - $Intercept = `r CAPFT2[[1]]`$ ($p = `r CAPFT2[[2]]`$); $r = `r CAPFT2[[3]]`$ ($p = `r CAPFT2[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT2[[5]]`$ ($p = `r CAPFT2[[6]]`$); $r = `r CAPFT2[[7]]`$ ($p = `r CAPFT2[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT2[[9]]`$ ($p = `r CAPFT2[[10]]`$); $r = `r CAPFT2[[11]]`$ ($p = `r CAPFT2[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT2[[13]]`$ ($p = `r CAPFT2[[14]]`$); $r = `r CAPFT2[[15]]`$ ($p = `r CAPFT2[[16]]`$)

\clearpage

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}

figure \ref{fig:CAPFT3}
table \ref{tab:CAPFTTab3}

```{r CAPFT3, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil1 Memory (Caatinga) -} \\qsoila Memory (figure \\ref{fig:CAVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT3}", fig.scap="PFTs and Qsoil1 Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT3 <- Tryres(Region = "Caatinga", SoilLayer = 1, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r CAPFT3[[1]]`$ ($p = `r CAPFT3[[2]]`$); $r = `r CAPFT3[[3]]`$ ($p = `r CAPFT3[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT3[[5]]`$ ($p = `r CAPFT3[[6]]`$); $r = `r CAPFT3[[7]]`$ ($p = `r CAPFT3[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT3[[9]]`$ ($p = `r CAPFT3[[10]]`$); $r = `r CAPFT3[[11]]`$ ($p = `r CAPFT3[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT3[[13]]`$ ($p = `r CAPFT3[[14]]`$); $r = `r CAPFT3[[15]]`$ ($p = `r CAPFT3[[16]]`$)

```{r CAPFTTab3, results = 'asis', echo = FALSE}
TryTab(Region = "Caatinga", ModelCoeffs = CAPFT3, SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}

figure \ref{fig:CAPFT4}
table \ref{tab:CAPFTTab4}

```{r CAPFT4, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil2 Memory (Caatinga) -} \\qsoilb Memory (figure \\ref{fig:CAVegMem2}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT4}", fig.scap="PFTs and Qsoil2 Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT4 <- Tryres(Region = "Caatinga", SoilLayer = 2, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r CAPFT4[[1]]`$ ($p = `r CAPFT4[[2]]`$); $r = `r CAPFT4[[3]]`$ ($p = `r CAPFT4[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT4[[5]]`$ ($p = `r CAPFT4[[6]]`$); $r = `r CAPFT4[[7]]`$ ($p = `r CAPFT4[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT4[[9]]`$ ($p = `r CAPFT4[[10]]`$); $r = `r CAPFT4[[11]]`$ ($p = `r CAPFT4[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT4[[13]]`$ ($p = `r CAPFT4[[14]]`$); $r = `r CAPFT4[[15]]`$ ($p = `r CAPFT4[[16]]`$)

```{r CAPFTTab4, results = 'asis', echo = FALSE}
TryTab(Region = "Caatinga", ModelCoeffs = CAPFT4, SoilLayer = 2)
```

\clearpage

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}

figure \ref{fig:CAPFT5}
table \ref{tab:CAPFTTab5}

```{r CAPFT5, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil3 Memory (Caatinga) -} \\qsoilc Memory (figure \\ref{fig:CAVegMem3}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT5}", fig.scap="PFTs and Qsoil3 Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT5 <- Tryres(Region = "Caatinga", SoilLayer = 3, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r CAPFT5[[1]]`$ ($p = `r CAPFT5[[2]]`$); $r = `r CAPFT5[[3]]`$ ($p = `r CAPFT5[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT5[[5]]`$ ($p = `r CAPFT5[[6]]`$); $r = `r CAPFT5[[7]]`$ ($p = `r CAPFT5[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT5[[9]]`$ ($p = `r CAPFT5[[10]]`$); $r = `r CAPFT5[[11]]`$ ($p = `r CAPFT5[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT5[[13]]`$ ($p = `r CAPFT5[[14]]`$); $r = `r CAPFT5[[15]]`$ ($p = `r CAPFT5[[16]]`$)

```{r CAPFTTab5, results = 'asis', echo = FALSE}
TryTab(Region = "Caatinga", ModelCoeffs = CAPFT5, SoilLayer = 3)
```

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}

figure \ref{fig:CAPFT6}
table \ref{tab:CAPFTTab6}

```{r CAPFT6, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil4 Memory (Caatinga) -} \\qsoild Memory (figure \\ref{fig:CAVegMem4}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:CaatTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:CAPFT6}", fig.scap="PFTs and Qsoil4 Memory (Caatinga)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
CAPFT6 <- Tryres(Region = "Caatinga", SoilLayer = 4, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r CAPFT6[[1]]`$ ($p = `r CAPFT6[[2]]`$); $r = `r CAPFT6[[3]]`$ ($p = `r CAPFT6[[4]]`$)

\vh (mapped) - $Intercept = `r CAPFT6[[5]]`$ ($p = `r CAPFT6[[6]]`$); $r = `r CAPFT6[[7]]`$ ($p = `r CAPFT6[[8]]`$)

\nmass (raw) - $Intercept = `r CAPFT6[[9]]`$ ($p = `r CAPFT6[[10]]`$); $r = `r CAPFT6[[11]]`$ ($p = `r CAPFT6[[12]]`$)

\nmass (mapped) - $Intercept = `r CAPFT6[[13]]`$ ($p = `r CAPFT6[[14]]`$); $r = `r CAPFT6[[15]]`$ ($p = `r CAPFT6[[16]]`$)

```{r CAPFTTab6, results = 'asis', echo = FALSE}
TryTab(Region = "Caatinga", ModelCoeffs = CAPFT6, SoilLayer = 4)
```

\clearpage

\paragraph*{Summary}  \hspace{.5cm}
table \ref{tab:CAPFTTabRaw}
table \ref{tab:CAPFTTabMapped}

```{r CAPFTTabRaw, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(CAPFT1)[c(1:4, 9:12)], unlist(CAPFT2)[c(1:4, 9:12)], 
                 unlist(CAPFT3)[c(1:4, 9:12)], unlist(CAPFT4)[c(1:4, 9:12)], 
                 unlist(CAPFT5)[c(1:4, 9:12)], unlist(CAPFT6)[c(1:4, 9:12)]), Region = "Caatinga", Data = "Geo-referenced")
```

```{r CAPFTTabMapped, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(CAPFT1)[c(5:8, 13:16)], unlist(CAPFT2)[c(5:8, 13:16)], 
                 unlist(CAPFT3)[c(5:8, 13:16)], unlist(CAPFT4)[c(5:8, 13:16)], 
                 unlist(CAPFT5)[c(5:8, 13:16)], unlist(CAPFT6)[c(5:8, 13:16)]), Region = "Caatinga", Data = "Mapped species-specific mean")
```
\clearpage

#### Australia

\paragraph*{Intrinsic Memory}  \hspace{.5cm}

figure \ref{fig:AUPFT1}

```{r AUPFT1, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Intrinsic Memory (Australia) -} Intrinsic Memory (NDVI t-1, figure \\ref{fig:AUVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT1}", fig.scap="PFTs and Intrinsic Memory (Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT1 <- Tryres(Region = "Australia", SoilLayer = 1, Variable = "t-1")
```

\vh (raw) - $Intercept = `r AUPFT1[[1]]`$ ($p = `r AUPFT1[[2]]`$); $r = `r AUPFT1[[3]]`$ ($p = `r AUPFT1[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT1[[5]]`$ ($p = `r AUPFT1[[6]]`$); $r = `r AUPFT1[[7]]`$ ($p = `r AUPFT1[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT1[[9]]`$ ($p = `r AUPFT1[[10]]`$); $r = `r AUPFT1[[11]]`$ ($p = `r AUPFT1[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT1[[13]]`$ ($p = `r AUPFT1[[14]]`$); $r = `r AUPFT1[[15]]`$ ($p = `r AUPFT1[[16]]`$)

\clearpage

\paragraph*{Air Temperature}  \hspace{.5cm}

figure \ref{fig:AUPFT2}

```{r AUPFT2, echo = FALSE, fig.width = 17, fig.height = 6, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 1, out.width='1\\linewidth', fig.cap="\\textbf{PFTs and Tair Memory (Australia) -} Tair Memory (figure \\ref{fig:AUVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT2}", fig.scap="PFTs and Tair Memory (Australia)",  cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT2 <- Tryres(Region = "Australia", SoilLayer = 1, Variable = "Tair")
```

\vh (raw) - $Intercept = `r AUPFT2[[1]]`$ ($p = `r AUPFT2[[2]]`$); $r = `r AUPFT2[[3]]`$ ($p = `r AUPFT2[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT2[[5]]`$ ($p = `r AUPFT2[[6]]`$); $r = `r AUPFT2[[7]]`$ ($p = `r AUPFT2[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT2[[9]]`$ ($p = `r AUPFT2[[10]]`$); $r = `r AUPFT2[[11]]`$ ($p = `r AUPFT2[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT2[[13]]`$ ($p = `r AUPFT2[[14]]`$); $r = `r AUPFT2[[15]]`$ ($p = `r AUPFT2[[16]]`$)

\clearpage

\paragraph*{Soil Moisture (0-7cm)}  \hspace{.5cm}

figure \ref{fig:AUPFT3}
table \ref{tab:AUPFTTab3}

```{r AUPFT3, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil1 Memory (Australia) -} \\qsoila Memory (figure \\ref{fig:AUVegMem1}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT3}", fig.scap="PFTs and Qsoil1 Memory (Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT3 <- Tryres(Region = "Australia", SoilLayer = 1, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r AUPFT3[[1]]`$ ($p = `r AUPFT3[[2]]`$); $r = `r AUPFT3[[3]]`$ ($p = `r AUPFT3[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT3[[5]]`$ ($p = `r AUPFT3[[6]]`$); $r = `r AUPFT3[[7]]`$ ($p = `r AUPFT3[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT3[[9]]`$ ($p = `r AUPFT3[[10]]`$); $r = `r AUPFT3[[11]]`$ ($p = `r AUPFT3[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT3[[13]]`$ ($p = `r AUPFT3[[14]]`$); $r = `r AUPFT3[[15]]`$ ($p = `r AUPFT3[[16]]`$)

```{r AUPFTTab3, results = 'asis', echo = FALSE}
TryTab(Region = "Australia", ModelCoeffs = AUPFT3, SoilLayer = 1)
```

\clearpage

\paragraph*{Soil Moisture (7-28cm)}  \hspace{.5cm}

figure \ref{fig:AUPFT4}
table \ref{tab:AUPFTTab4}

```{r AUPFT4, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil2 Memory (Australia) -} \\qsoilb Memory (figure \\ref{fig:AUVegMem2}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT4}", fig.scap="PFTs and Qsoil2 Memory (Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT4 <- Tryres(Region = "Australia", SoilLayer = 2, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r AUPFT4[[1]]`$ ($p = `r AUPFT4[[2]]`$); $r = `r AUPFT4[[3]]`$ ($p = `r AUPFT4[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT4[[5]]`$ ($p = `r AUPFT4[[6]]`$); $r = `r AUPFT4[[7]]`$ ($p = `r AUPFT4[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT4[[9]]`$ ($p = `r AUPFT4[[10]]`$); $r = `r AUPFT4[[11]]`$ ($p = `r AUPFT4[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT4[[13]]`$ ($p = `r AUPFT4[[14]]`$); $r = `r AUPFT4[[15]]`$ ($p = `r AUPFT4[[16]]`$)

```{r AUPFTTab4, results = 'asis', echo = FALSE}
TryTab(Region = "Australia", ModelCoeffs = AUPFT4, SoilLayer = 2)
```

\clearpage

\paragraph*{Soil Moisture (28-100cm)}  \hspace{.5cm}

figure \ref{fig:AUPFT5}
table \ref{tab:AUPFTTab5}

```{r AUPFT5, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil3 Memory (Australia) -} \\qsoilc Memory (figure \\ref{fig:AUVegMem3}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT5}", fig.scap="PFTs and Qsoil3 Memory (Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT5 <- Tryres(Region = "Australia", SoilLayer = 3, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r AUPFT5[[1]]`$ ($p = `r AUPFT5[[2]]`$); $r = `r AUPFT5[[3]]`$ ($p = `r AUPFT5[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT5[[5]]`$ ($p = `r AUPFT5[[6]]`$); $r = `r AUPFT5[[7]]`$ ($p = `r AUPFT5[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT5[[9]]`$ ($p = `r AUPFT5[[10]]`$); $r = `r AUPFT5[[11]]`$ ($p = `r AUPFT5[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT5[[13]]`$ ($p = `r AUPFT5[[14]]`$); $r = `r AUPFT5[[15]]`$ ($p = `r AUPFT5[[16]]`$)

```{r AUPFTTab5, results = 'asis', echo = FALSE}
TryTab(Region = "Australia", ModelCoeffs = AUPFT5, SoilLayer = 3)
```

\clearpage

\paragraph*{Soil Moisture (100-255cm)}  \hspace{.5cm}

figure \ref{fig:AUPFT6}
table \ref{tab:AUPFTTab6}

```{r AUPFT6, echo = FALSE, fig.width = 17, fig.height = 10, fig.subcap=c('Height', 'Nitrogen'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{PFTs and Qsoil4 Memory (Australia) -} \\qsoild Memory (figure \\ref{fig:AUVegMem4}) plotted against expressions of (a) \\vh, and (b) \\nmass both via geo-referenced \\TRY records and mapped species-specific trait means (figure \\ref{fig:AUTRY}). Figure established via \\ref{rTRYRes}. \\label{fig:AUPFT6}", fig.scap="PFTs and Qsoil4 Memory (Australia)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
AUPFT6 <- Tryres(Region = "Australia", SoilLayer = 4, Variable = "Qsoil")
```

\vh (raw) - $Intercept = `r AUPFT6[[1]]`$ ($p = `r AUPFT6[[2]]`$); $r = `r AUPFT6[[3]]`$ ($p = `r AUPFT6[[4]]`$)

\vh (mapped) - $Intercept = `r AUPFT6[[5]]`$ ($p = `r AUPFT6[[6]]`$); $r = `r AUPFT6[[7]]`$ ($p = `r AUPFT6[[8]]`$)

\nmass (raw) - $Intercept = `r AUPFT6[[9]]`$ ($p = `r AUPFT6[[10]]`$); $r = `r AUPFT6[[11]]`$ ($p = `r AUPFT6[[12]]`$)

\nmass (mapped) - $Intercept = `r AUPFT6[[13]]`$ ($p = `r AUPFT6[[14]]`$); $r = `r AUPFT6[[15]]`$ ($p = `r AUPFT6[[16]]`$)

```{r AUPFTTab6, results = 'asis', echo = FALSE}
TryTab(Region = "Australia", ModelCoeffs = AUPFT6, SoilLayer = 4)
```

\clearpage

\paragraph*{Summary}  \hspace{.5cm}
table \ref{tab:AUPFTTabRaw}
table \ref{tab:AUPFTTabMapped}

```{r AUPFTTabRaw, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(AUPFT1)[c(1:4, 9:12)], unlist(AUPFT2)[c(1:4, 9:12)], 
                 unlist(AUPFT3)[c(1:4, 9:12)], unlist(AUPFT4)[c(1:4, 9:12)], 
                 unlist(AUPFT5)[c(1:4, 9:12)], unlist(AUPFT6)[c(1:4, 9:12)]), Region = "Australia", Data = "Geo-referenced")
```

```{r AUPFTTabMapped, results = 'asis', echo = FALSE}
PFTTab(ModelCoeffs = c(unlist(AUPFT1)[c(5:8, 13:16)], unlist(AUPFT2)[c(5:8, 13:16)], 
                 unlist(AUPFT3)[c(5:8, 13:16)], unlist(AUPFT4)[c(5:8, 13:16)], 
                 unlist(AUPFT5)[c(5:8, 13:16)], unlist(AUPFT6)[c(5:8, 13:16)]), Region = "Australia", Data = "Mapped species-specific mean")
```
\clearpage

#### Summary

\clearpage


# Discussion
## Vegetation Memory
## Life History Traits
## Plant Functional Traits

# Conclusion

**Outlook**  
1. Soil moisture-driven drought indices\cite{Sohrabi2015}?  
2. Use \BIEN data


<!--- ####### BIBLIOGRAPHY ---------------------------------------------------------->
\phantomsection
\addcontentsline{toc}{chapter}{Bibliography}
\titleformat{\chapter}{\normalfont\huge\bfseries}{}{0pt}{\Huge}
\titlespacing*{\chapter}{0pt}{10pt}{30pt}
\MakeBib

<!--- ####### APPENDIX ---------------------------------------------------------->
\titleformat{\chapter}{\normalfont\huge\bfseries}{}{0pt}{\Huge}
\titlespacing*{\chapter}{0pt}{-30pt}{30pt}
\appendix  

# Appendix

## Project Requirements

Following these steps ensures full reproducibility of the entire analysis. Alternatively, codes can be retrieved via \url{https://github.com/ErikKusch/M.Sc.Thesis}.

With the exception of python, bash, and matlab scripts to obtain \era data, have been carried out in `R`\cite{R} using the functionality contained within the base installation as well as the packages outlined in table \ref{tab:rPackages}. \ref{rPackages} contains the `R` commands used to install all packages needed to reproduce the analyses of this study from a base installation of `R`. Data sources and methods of data retrieval are stated for each data set individually. All codes needed to reproduce the analysis at the core of this thesis have been included to this document in section \ref{S:RAnalyses}. Note that the computation can be sped up by altering the `Cores` argument to enable parallel processing via the `foreach` and `doparallel`\cite{R-doParallel} packages.

### `R` Requirements

#### `R` Packages

\renewcommand{\arraystretch}{1}
\begin{table*}[h!]
  \centering
  \caption[R Packages]{\textbf{R Packages -} Packages which need to be loaded into R to fully reproduce the analyses within this study.}
    \begin{tabular}{|L{4cm}L{4cm}L{8.5cm}|}
    \hline
    \bfseries Package  & \bfseries Version & Use \\
    \hline
    automap\cite{R-automap} & 1.0-14 & Statistical Downscaling of \era5 data \\
    doParallel\cite{R-doParallel} & 1.0.14 & Paralell processing \\
    foreach\cite{R-foreach} &  1.4.4 &  Paralell processing \\
    gameofthrones\cite{R-GoT} &  1.0.0 &  Data visualisation\\
    ggplot2\cite{R-ggplot2} &  3.1.0 &  Data visualisation\\
    gimms\cite{R-Gimms} &  1.1.1 &  Downloading GIMMs NDVI3g data\\
    ncdf4\cite{R-ncdf4} & 1.16.1 &  Namespace for NetCDF files\\
    pracma\cite{R-pracma} & 2.2.2 &  Detrending time series\\
    raster\cite{R-Raster} & 2.8-19 &  Rasterising NetCDF data\\
    rgbif\cite{R-gbif} & 1.2.0 &  Downloading floral occurence data\\
    rgdal\cite{R-rgdal} & 1.4-2 &  Loading and using shapefiles\\
    sp\cite{R-sp} & 1.3-1 &  Converting point data to rasterised data\\
    vegan\cite{R-vegan} & 2.5-4 &  PCA approach for model building\\
    xlsx\cite{R-xlsx} & 0.6.1 &  Export of numeric results\\
    \hline
    \end{tabular}%
  \label{tab:rPackages}%
\end{table*}

\footnotesize

```{r, code = readLines('Y - Codes/S0a_Packages.R'), eval = FALSE, ref = "rPackages", codecap = "Installing and loading of R packages needed to reproduce the analyses of this study.", tidy = TRUE}
```

\clearpage

#### Project Directories

\begin{figure}[h!]
\centering \includegraphics[width=.9\linewidth]{3 - Figures/FolderHierarchy.png}
\caption[Working Directories]{\textbf{Working Directories - }An overview of working directories established/required by \ref{rDirectories}.}
\label{fig:WDs}
\end{figure}

\footnotesize
```{r, code = readLines('Y - Codes/S0b_Directories.R'), eval = FALSE, ref = "rDirectories", codecap = "Identifing and generating the folder structure used within the computational steps. A visual overview is presented in \\ref{fig:WDs}.", tidy = FALSE}
```

\clearpage

#### `R` Functions for Region Selection and Raster Names

\footnotesize
```{r, code = readLines('Y - Codes/S0c_Functions.R'), eval = FALSE, ref = "rFunctions", codecap = "User-defined functions used to optimise further functions of this analysis when (1) Limitting to study regions (RegionSelection), and (2) assigning names to model rasters (Fun\\_NamesRas).", tidy = FALSE}
```

\clearpage

### ERA5 Data
#### Obtaining ERA5 Data
\footnotesize
```{python, code = readLines('Y - Codes/ERA5/All_1980s.py'), eval = FALSE, ref = "ObtainEra5", codecap = "Obtaining ERA5 data from the \\ecmwf servers. Substitute the date statement to download the full data set. Python script.", tidy = FALSE}
```

\vspace{.7cm}

#### Pre-Processing ERA5 Data
```{bash, code = readLines('Y - Codes/ERA5/Process_raw_input.sh'), eval = FALSE, ref = "ProcessEra5", codecap = "Processing ERA5 data from local downloads to merge by time step. Bash script.", tidy = TRUE}
```

```{python, code = readLines('Y - Codes/ERA5/Regrid_the_data.m'), eval = FALSE, ref = "RegridEra5", codecap = "Regridding ERA5 data to fit \\gimms and \\hwsd extents. Matlab script.", tidy = TRUE}
```

\clearpage


## Data
### HWSD Data
\vspace{-0.3cm}
\renewcommand{\arraystretch}{.8}
\begin{table*}[h!]
  \centering
  \caption[HWSD Variables and Explanations]{\textbf{HWSD Variables and Explanations -} HWSD variables used within this study and their explanations. Slope aspects and inclines are recorded as number of 3 arc-second cells falling into 5 minute cells}
    \begin{tabular}{|L{4cm}L{12.5cm}|}
    \hline
    \bfseries HWSD Variable  & \bfseries Explanation\\ \hline
    \textit{Elevation} & Altitude in metres as measured from sea-level\\
    \textit{Slope\_aspect\_N} & $(0^\circ; 45^\circ]$; $(315^\circ; 360^\circ]$ \\
    \textit{Slope\_aspect\_E} & $(45^\circ; 135^\circ]$ \\
    \textit{Slope\_aspect\_S} & $(135^\circ; 225^\circ]$ \\
    \textit{Slope\_aspect\_W} & $(225^\circ ; 315^\circ]$ \\
    \textit{Slope\_aspect\_U} & Slope undefined or slope incline is less than $2\%$ \\
    \textit{Slopes1} & $0\% \leq$ incline $\leq 0.5\%$ \\
    \textit{Slopes2} & $0.5\% \leq$ incline $\leq 2\%$ \\
    \textit{Slopes3} & $2\% \leq$ incline $\leq 5\%$ \\
    \textit{Slopes4} & $5\% \leq$ incline $\leq 10\%$ \\
    \textit{Slopes5} & $10\% \leq$ incline $\leq 15\%$ \\
    \textit{Slopes6} & $15\% \leq$ incline $\leq 30\%$ \\
    \textit{Slopes7} & $30\% \leq$ incline $\leq 45\%$ \\
    \textit{Slopes8} & Incline $> 45\%$ \\
    \hline
    \end{tabular}
  \label{tab:HWSDOverview}
\end{table*}

\vspace{-0.7cm}

```{r CovPlota, echo = FALSE, fig.width = 16, fig.height = 12.5, fig.cap="\\textbf{HWSD slope aspect data -} \\hwsd data at \\gimms resolution divided by 1000 for displaying. Figure established via \\ref{rHWSDAOverview}. \\label{fig:HWSDAOverview}", fig.scap="HWSD slope aspect data", out.extra='',fig.pos = 'h!', cache = TRUE, cache.lazy=FALSE}
Covariates_vec <- c("Slopes1", "Slopes2", "Slopes3", "Slopes4", "Slopes5", "Slopes6", "Slopes7", "Slopes8",
                    "Slope_aspect_N", "Slope_aspect_E", "Slope_aspect_S", "Slope_aspect_W", "Slope_aspect_U", 
                    "Elevation")
Cov_fine <- list() # create empty list
for(c in 1:length(Covariates_vec)){ # cycle through all covariates and load the data
      Cov_fine[[c]] <- raster(paste(Dir.KrigCov, "/Co-variates_NativeResolution.nc", sep=""), 
                              varname = Covariates_vec[c])
      }
Cov_fine <- brick(Cov_fine) # make fine covariate data into one big brick

for(i in 1:13){
values(Cov_fine[[i]]) <- values(Cov_fine[[i]])/1000
}
par(mfrow = c(3,2))
for(i in 9:13){
  plot(Cov_fine[[i]], colNA = "black", cex.main = 2, legend.width = 1.5, legend.shrink=1, 
       axis.args=list(cex.axis=1.5), cex.axis = 1.5, legend = TRUE, col = terrain.colors(100), 
       main = Covariates_vec[[i]])
}
```

\clearpage

```{r CovPlotb, echo = FALSE, fig.width = 17, fig.height = 20, fig.cap="\\textbf{HWSD slope incline data -} \\hwsd data at \\gimms resolution. Data has been divided by 1000 for displaying. Figure established via \\ref{rHWSDIOverview}. \\label{fig:HWSDIOverview}", fig.scap="HWSD slope incline data", out.extra='',fig.pos = 'h!', cache = TRUE, cache.lazy=FALSE}
par(mfrow = c(4,2))
for(i in 1:8){
  plot(Cov_fine[[i]]/10, colNA = "black", cex.main = 2, legend.width = 1.5, legend.shrink=1, axis.args=list(cex.axis=1.5), cex.axis = 1.5, legend = TRUE, col = terrain.colors(100), main = Covariates_vec[[i]])
}
```


\clearpage

### Study Regions
#### Iberian Region
```{r SR_IBP1, echo = FALSE, fig.width = 17, fig.height = 19, out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
SR_Qsoil4 <- SRData("Iberian Region")
```
\vspace{-1.45cm}
```{r SR_IBP2, echo = FALSE, fig.width = 17, fig.height = 2, fig.cap="\\textbf{Data Overview (Iberian Region) -} Data required for identificiation of vegetation memory: (1) \\gimms \\ndvi 3g; and (2) ERA5: \\tair, \\qsoila, \\qsoilb, \\qsoilc, \\qsoild. Figure established via \\ref{rStudRegFun}. \\label{fig:IBPDataOverview}", fig.scap="Data Overview (Iberian Region)", out.extra='',fig.pos = 'h'}
plot(SR_Qsoil4, legend.only=TRUE, smallplot=c(0.05,.95,.2,.35), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.qsoil, legend.args = list(text='Soil Moisture', side = 3, line = .1, cex = 2))
```

\clearpage

```{r SRIBP_TRY, echo = FALSE, fig.width = 17, fig.height = 17, fig.cap="\\textbf{TRY Data (Iberian Region) -} TRY PFT data across the Iberian Region: (1) Geo-referenced records (upper row), and (2) Extrapolated species-specific mean PFT records (lower row). Figure established via \\ref{rSRTRY}. \\label{fig:IBPTRY}", fig.scap="TRY Data (Iberian Region)", out.extra='',fig.pos = 'h', cache.lazy = FALSE}
TRYRegions(Region = "Iberian Region")
```
\clearpage

#### Caatinga, Brazil
```{r SR_Caat1, echo = FALSE, fig.width = 17, fig.height = 19, out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
SR_Qsoil4 <- SRData("Caatinga")
```
\vspace{-1.45cm}
```{r SR_Caat2, echo = FALSE, fig.width = 17, fig.height = 2, fig.cap="\\textbf{Data Overview (Caatinga, Brazil) -} Data required for identificiation of vegetation memory: (1) \\gimms \\ndvi 3g; and (2) ERA5: \\tair, \\qsoila, \\qsoilb, \\qsoilc, \\qsoild. Figure established via \\ref{rStudRegFun}. \\label{fig:CaatDataOverview}", fig.scap="Data Overview (Caatinga, Brazil)", out.extra='',fig.pos = 'h'}
plot(SR_Qsoil4, legend.only=TRUE, smallplot=c(0.05,.95,.2,.35), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.qsoil, legend.args = list(text='Soil Moisture', side = 3, line = .1, cex = 2))
```

\clearpage

```{r SRCaat_TRY, echo = FALSE, fig.width = 17, fig.height = 17, fig.cap="\\textbf{TRY Data (Caatinga, Brazil) -} TRY PFT data across Caatinga, Brazil: (1) Geo-referenced records (upper row), and (2) Extrapolated sepcies-specific mean PFT records (lower row). Figure established via \\ref{rSRTRY}. \\label{fig:CaatTRY}", fig.scap="TRY Data (Caatinga, Brazil", out.extra='',fig.pos = 'h', cache.lazy = FALSE}
TRYRegions(Region = "Caatinga")
```
\clearpage

#### Australia
```{r SR_AU1, echo = FALSE, fig.width = 17, fig.height = 19, out.extra='',fig.pos = 'h', cache = TRUE, cache.lazy=FALSE}
SR_Qsoil4 <- SRData("Australia")
```
\vspace{-1.45cm}
```{r SR_AU2, echo = FALSE, fig.width = 17, fig.height = 2, fig.cap="\\textbf{Data Overview (Australia) -} Data required for identificiation of vegetation memory: (1) \\gimms \\ndvi 3g; and (2) ERA5: \\tair, \\qsoila, \\qsoilb, \\qsoilc, \\qsoild. Figure established via \\ref{rStudRegFun}. \\label{fig:AUDataOverview}", fig.scap="Data Overview (Australia)", out.extra='',fig.pos = 'h'}
plot(SR_Qsoil4, legend.only=TRUE, smallplot=c(0.05,.95,.2,.35), horizontal = TRUE, axis.args=list(cex.axis=2.5), col = col.qsoil, legend.args = list(text='Soil Moisture', side = 3, line = .1, cex = 2))
```

\clearpage

```{r SRAU_TRY, echo = FALSE, fig.width = 17, fig.height = 17, fig.cap="\\textbf{TRY Data (Australia) -} TRY PFT data across Australia: (1) Geo-referenced records (upper row), and (2) Extrapolated species-specific mean PFT records (lower row). Figure established via \\ref{rSRTRY}. \\label{fig:AUTRY}", fig.scap="TRY Data (Australia)", out.extra='',fig.pos = 'h', cache.lazy = FALSE}
TRYRegions(Region = "Australia")
```
\clearpage

## `R` Analyses Codes
\label{S:RAnalyses}

### Master File
\footnotesize
```{r, code = readLines('MScMaster.R'), eval = FALSE, ref = "rMaster", codecap = "Running the entire analysis once data has been allocated to directories. S0a\\_Packages.R can be found in \\ref{rPackages}, S0b\\_Directories.R is located in \\ref{rDirectories} whilst S0c\\_Functions.R is contained in \\ref{rFunctions}. S1\\_GIMMs.R, S2\\_ERA5.R, S3\\_VegetationMemory.R, S4\\_PFTs.R, and S4\\_COMPADRE.R are included in \\ref{rGimms}, \\ref{rEra5}, \\ref{rVegMem}, \\ref{rPFTs}, and \\ref{rCOMPADRE}, respectively.", tidy = FALSE}
```

\clearpage

### Vegetation Memory
#### GIMMs Data
\footnotesize
```{r, code = readLines('Y - Codes/S1_GIMMs.R'), eval = FALSE, ref = "rGimms", codecap = "Downloading GIMMs NDVI3g data, establishing rasters of monthly composites (RasterGIMMs), and creating NDVI raster stacks for each study region (CombineCDFs).", tidy = TRUE, cache.lazy=FALSE}
```

#### ERA5
\footnotesize
```{r, code = readLines('Y - Codes/S2_ERA5.R'), eval = FALSE, ref = "rEra5", codecap = "Kriging ERA5 data from \\era to \\gimms resolution using \\hwsd covariates (table \\ref{tab:HWSDOverview}) (RasterEra5).", tidy = FALSE, cache.lazy=FALSE}
```
#### Calculation of Vegetation Memory
\footnotesize
```{r, code = readLines('Y - Codes/S3_VegetationMemory.R'), eval = FALSE, ref = "rVegMem", codecap = "Computing vegetation memory for study regions as specified by lags, time frame, and variables to be considered (VegMem), scaling rasters of vegetation memory to be on the same scale for each study region (CoeffScaling).", tidy = FALSE, cache.lazy=FALSE}
```

\clearpage
### Plant Functional Traits
\footnotesize
```{r, code = readLines('Y - Codes/S4_PFTs.R'), eval = FALSE, ref = "rPFTs", codecap = "Calculating species-specific PFT means (PFTs), creating distribution maps from floral occurence data obtained from GBIF (DistMaps), and combine occurence maps with species trait means (PFTRasters).", tidy = FALSE, cache.lazy=FALSE}
```

\clearpage
### COMPADRE
\footnotesize
```{r, code = readLines('Y - Codes/S4_COMPADRE.R'), eval = FALSE, ref = "rCOMPADRE", codecap = "Extracting and rasterising COMPADRE data from COMPADRE data base for each study region (RasterCOMPADRE).", tidy = TRUE, cache.lazy=FALSE}
```

\clearpage  

## Results

### Vegetation Memory Models
#### Iberian Region

```{r IBRVegMem2, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Iberian Region; Qsoil2) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:IBRVegMem2}", fig.scap="Vegetation Memory Coefficients (Iberian Region; Qsoil2)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Iberian Region", SoilLayer = 2)
```

```{r IBRVegMem3, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Iberian Region; Qsoil3) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:IBRVegMem3}", fig.scap="Vegetation Memory Coefficients (Iberian Region; Qsoil3)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Iberian Region", SoilLayer = 3)
```

\clearpage

```{r IBRVegMem4, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Iberian Region; Qsoil4) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:IBRVegMem4}", fig.scap="Vegetation Memory Coefficients (Iberian Region; Qsoil4)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Iberian Region", SoilLayer = 4)
```

```{r IBRU2, echo = FALSE, results = 'asis'}
Ures(Region = "Iberian Region", SoilLayer = 2)
```

```{r IBRU3, echo = FALSE, results = 'asis'}
Ures(Region = "Iberian Region", SoilLayer = 3)
```

```{r IBRU4, echo = FALSE, results = 'asis'}
Ures(Region = "Iberian Region", SoilLayer = 4)
```

\clearpage

#### Caatinga

```{r CAVegMem2, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Caatinga; Qsoil2) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:CAVegMem2}", fig.scap="Vegetation Memory Coefficients (Caatinga; Qsoil2)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Caatinga", SoilLayer = 2)
```

```{r CAVegMem3, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Caatinga; Qsoil3) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:CAVegMem3}", fig.scap="Vegetation Memory Coefficients (Caatinga; Qsoil3)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Caatinga", SoilLayer = 3)
```

\clearpage

```{r CAVegMem4, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Caatinga; Qsoil4) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PCAREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:CAVegMem4}", fig.scap="Vegetation Memory Coefficients (Caatinga; Qsoil4)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Caatinga", SoilLayer = 4)
```

```{r CAU2, echo = FALSE, results = 'asis'}
Ures(Region = "Caatinga", SoilLayer = 2)
```

```{r CAU3, echo = FALSE, results = 'asis'}
Ures(Region = "Caatinga", SoilLayer = 3)
```

```{r CAU4, echo = FALSE, results = 'asis'}
Ures(Region = "Caatinga", SoilLayer = 4)
```

\clearpage

#### Australia

```{r AUVegMem2, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Australia; Qsoil2) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PAUREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:AUVegMem2}", fig.scap="Vegetation Memory Coefficients (Australia; Qsoil2)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Australia", SoilLayer = 2)
```

```{r AUVegMem3, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Australia; Qsoil3) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PAUREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:AUVegMem3}", fig.scap="Vegetation Memory Coefficients (Australia; Qsoil3)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Australia", SoilLayer = 3)
```

\clearpage

```{r AUVegMem4, echo = FALSE, fig.width = 17, fig.height = 15, fig.subcap=c('SoilLag', 'Qsoil'), fig.ncol = 2, out.width='.5\\linewidth', fig.cap="\\textbf{Vegetation Memory Coefficients (Australia; Qsoil4) -} Coefficients of vegetation memory obtained via model selection (figure \\ref{fig:ModScheme}) and \\pca regression (figure \\ref{fig:PAUREG}). For an interpretation of these coefficients, see table \\ref{tab:CoeffsOverview}. Figure established via \\ref{rModelRes}. \\label{fig:AUVegMem4}", fig.scap="Vegetation Memory Coefficients (Australia; Qsoil4)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
ModelRes(Region = "Australia", SoilLayer = 4)
```

```{r AUU2, echo = FALSE, results = 'asis'}
Ures(Region = "Australia", SoilLayer = 2)
```

```{r AUU3, echo = FALSE, results = 'asis'}
Ures(Region = "Australia", SoilLayer = 3)
```

```{r AUU4, echo = FALSE, results = 'asis'}
Ures(Region = "Australia", SoilLayer = 4)
```

\clearpage

### Variance Partitioning

#### Iberian Region
```{r IBRVarPar1, echo = FALSE, fig.width = 17, fig.height = 12.5, fig.subcap=c('Total', 't-1', 'Shared', 'Qsoil'), fig.ncol = 3, out.width='.33\\linewidth', fig.cap="\\textbf{Variance Partitioning (Iberian Region) -} Variance of \\ndvi anomalies explained by (a,d,g,j) full models of intrinsic and extrinsic memory, (b,e,h,k) intrinsic memory, (c,f,i,l) shared variance, and (d) extrinsic memory across soil layers \\qsoila to \\qsoild. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:IBRVarPar2}", fig.scap="Variance Partitioning (Iberian Region; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Iberian Region", SoilLayer = 1, Plot = 2)
VarParRes(Region = "Iberian Region", SoilLayer = 2, Plot = 2)
VarParRes(Region = "Iberian Region", SoilLayer = 3, Plot = 2)
VarParRes(Region = "Iberian Region", SoilLayer = 4, Plot = 2)
```

\clearpage

#### Caatinga
```{r CAVarPar1, echo = FALSE, fig.width = 17, fig.height = 12.5, fig.subcap=c('Total', 't-1', 'Shared', 'Qsoil'), fig.ncol = 3, out.width='.33\\linewidth', fig.cap="\\textbf{Variance Partitioning (Caatinga) -} Variance of \\ndvi anomalies explained by (a,d,g,j) full models of intrinsic and extrinsic memory, (b,e,h,k) intrinsic memory, (c,f,i,l) shared variance, and (d) extrinsic memory across soil layers \\qsoila to \\qsoild. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:CAVarPar2}", fig.scap="Variance Partitioning (Caatinga; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Caatinga", SoilLayer = 1, Plot = 2)
VarParRes(Region = "Caatinga", SoilLayer = 2, Plot = 2)
VarParRes(Region = "Caatinga", SoilLayer = 3, Plot = 2)
VarParRes(Region = "Caatinga", SoilLayer = 4, Plot = 2)
```

\clearpage

#### Australia
```{r AUVarPar1, echo = FALSE, fig.width = 17, fig.height = 12.5, fig.subcap=c('Total', 't-1', 'Shared', 'Qsoil'), fig.ncol = 3, out.width='.33\\linewidth', fig.cap="\\textbf{Variance Partitioning (Australia) -} Variance of \\ndvi anomalies explained by (a,d,g,j) full models of intrinsic and extrinsic memory, (b,e,h,k) intrinsic memory, (c,f,i,l) shared variance, and (d) extrinsic memory across soil layers \\qsoila to \\qsoild. A representation of how these were calculated can be retrieved in figure \\ref{fig:VarPar}. Figure established via \\ref{rVarParRes}. \\label{fig:AUVarPar2}", fig.scap="Variance Partitioning (Australia; Qsoil1)", cache = TRUE, cache.lazy=FALSE, fig.pos = 'h!'}
VarParRes(Region = "Australia", SoilLayer = 1, Plot = 2)
VarParRes(Region = "Australia", SoilLayer = 2, Plot = 2)
VarParRes(Region = "Australia", SoilLayer = 3, Plot = 2)
VarParRes(Region = "Australia", SoilLayer = 4, Plot = 2)
```

\clearpage


## `R` Data Visualisation Codes

### Preamble
\footnotesize
```{r PreambShow, eval = FALSE, ref = "rPreambsShow", codecap = "Preamble needed for processing the following chunks within this manuscript.", tidy = TRUE}
source("S0a_Packages.R") # loading packages
source("S0b_Directories.R") # setting directories
source("S0c_Functions.R") # Loading miscellaneous functions
col.NDVI <- rev(terrain.colors(100))
col.qsoil <- colorRampPalette(c("yellow", "burlywood", "beige", "turquoise", "deepskyblue"))(100)
col.tair <- colorRampPalette(c("blue","turquoise", "yellow", "orange", "red"))(100)
SR_cols <- list(col.NDVI, col.tair, col.qsoil, col.qsoil, col.qsoil, col.qsoil)
SR_Titles <- list("NDVI", "Air Temperature", "Soil Moisture (0-7cm)", "Soil Moisture (7-28cm)", "Soil Moisture (28-100cm)", "Soil Moisture (100-255cm)")
setwd(Dir.KrigCov)
Elevation <- raster(list.files()[2], varname = "Elevation")
ElevationF <- raster(list.files()[1], varname = "Elevation")
```

### Data Overview

#### NDVI
\footnotesize
```{r ref.label='NDVIOverview', eval = FALSE, ref = "rNDVIOverview", codecap = "Plotting global NDVI mean for the time frame of 1982 - 2015.", tidy = TRUE}
```

#### ERA5
\footnotesize
```{r ref.label='QsoilPlot', eval = FALSE, ref = "rQsoilOverview", codecap = "Two by two plotting of global soil moisture indices across four different soil layers all on the same scale.", tidy = FALSE}
```
\footnotesize
```{r ref.label='ATPlot', eval = FALSE, ref = "rATOverview", codecap = "Plotting mean air temperature from 1982 - 2015 globally.", tidy = FALSE}
```

\clearpage

#### HWSD 
\footnotesize

```{r ref.label='CovPlot', eval = FALSE, ref = "rEleOverview", codecap = "Plotting HWSD elevation data.", tidy = TRUE}
```

\footnotesize
```{r ref.label='CovPlota', eval = FALSE, ref = "rHWSDAOverview", codecap = "Loading HWSD data and plotting HWSD slope incline data.", tidy = FALSE}
```

\footnotesize
```{r ref.label='CovPlotb', eval = FALSE, ref = "rHWSDIOverview", codecap = "Plotting HWSD slope aspect data", tidy = TRUE}
```

\clearpage

#### TRY
\footnotesize
```{r ref.label='ShowTRYH', eval = FALSE, ref = "rHOverview", codecap = "Plotting global \\vh \\TRY data with a background plot of land mass.", tidy = TRUE}
```
\footnotesize
```{r ref.label='ShowTRYN', eval = FALSE, ref = "rNOverview", codecap = "Plotting global \\nmass \\TRY data with a background plot of land mass.", tidy = TRUE}
```

#### COMPADRE

\footnotesize
```{r ref.label='ShowCOMPADRE', eval = FALSE, ref = "rCOMPADREOverview", codecap = "Plotting global locations of COMPADRE data availability at \\gimms resolution.", tidy = TRUE}
```

\clearpage

#### Study Regions

\footnotesize
```{r ref.label='StudRegFun', eval = FALSE, ref = "rStudRegFun", codecap = "Function for plotting data overviews in three-by-two plots for study regions.", tidy = TRUE}
```

\clearpage

\footnotesize
```{r ref.label='SRTRY', eval = FALSE, ref = "rSRTRY", codecap = "Function for plotting TRY data overviews in two-by-two plots for study regions.", tidy = TRUE}
```

\clearpage

### Vegetation Memory Models

\footnotesize
```{r ref.label='VegMemNDVI', eval = FALSE, ref = "rVegMemNDVI", codecap = "Plotting \\ndvi data treatment in two-by-two plots.", tidy = TRUE, tidy.opts=list(width.cutoff=50)}
```

\clearpage

\footnotesize
```{r ref.label='VegMemQsoil', eval = FALSE, ref = "rVegMemQsoil", codecap = "Plotting \\qsoil1 data treatment in two-by-two plots.", tidy = TRUE, tidy.opts=list(width.cutoff=50)}
```

\clearpage

### Results

#### Memory Models
\footnotesize
```{r ref.label='ModelRes', eval = FALSE, ref = "rModelRes", codecap = "Plotting vegetation memory model outputs.", tidy = TRUE}
```
\footnotesize
```{r ref.label='URes', eval = FALSE, ref = "rUresChunk", codecap = "Loading U-Test results of model coefficients and displaying as a table.", tidy = TRUE}
```

\clearpage

#### Variance Partitioning
\footnotesize
```{r ref.label='VarParRes', eval = FALSE, ref = "rVarParRes", codecap = "Plotting variance partitioning results.", tidy = TRUE}
```

\clearpage

#### Soil Layer Comparison
\footnotesize
```{r ref.label='SoilLayersRes', eval = FALSE, ref = "rSoilLayersRes", codecap = "Comparing soil layer memory coefficients.", tidy = TRUE}
```
\footnotesize
```{r ref.label='UQsoilRes', eval = FALSE, ref = "rUQsoilRes", codecap = "Loading U-Test results of soil layer comparison and displaying as a table.", tidy = TRUE}
```

\clearpage

#### Vegetation Memory Sensitivity
\footnotesize
```{r ref.label='PatCausRes', eval = FALSE, ref = "rPatCausRes", codecap = "Vegetation sensitivity plots.", tidy = TRUE}
```
\footnotesize
```{r ref.label='Patcaustab', eval = FALSE, ref = "rPatcaustab", codecap = "Linear regression coefficients of vegetation memory sensitivity.", tidy = TRUE}
```
\footnotesize
```{r ref.label='PatCausAnova', eval = FALSE, ref = "rPatCausAnova", codecap = "ANOVAs of Qsoil layer and Memory length models.", tidy = TRUE}
```

\clearpage

### Plant Function

#### Life History Traits
\footnotesize
```{r ref.label='COMRes', eval = FALSE, ref = "rCOMRes", codecap = "Plotting COMPADRE data against vegetation memory coefficients.", tidy = TRUE}
```
\footnotesize
```{r ref.label='COMPADTab', eval = FALSE, ref = "rCOMPADTab", codecap = "Linear regression coefficients of COMPADRE data and vegetation memory coeffcients.", tidy = TRUE}
```

\clearpage

#### Plant Functional Traits
\footnotesize
```{r ref.label='TRYRes', eval = FALSE, ref = "rTRYRes", codecap = "Plotting TRY data against vegetation memory coefficients.", tidy = TRUE}
```
\footnotesize
```{r ref.label='TRYresTab', eval = FALSE, ref = "rTRYresTab", codecap = "Linear regression coefficients of TRY data and vegetation memory coeffcients.", tidy = TRUE}
```
\footnotesize
```{r ref.label='PFTTab', eval = FALSE, ref = "rPFTTab", codecap = "Overview of linear regression coefficients of TRY data and vegetation memory coeffcients.", tidy = TRUE}
```

\clearpage

### Miscellaneous Figures
\footnotesize
```{r, code = readLines('3 - Figures/RFigures.R'), eval = FALSE, ref = "rFigs", codecap = "Producing miscellaneous figures used for flow charts and scheme overviews.", tidy = TRUE, cache.lazy=FALSE}
```


\clearpage

## Declaration Of Authorship  
\noindent\fbox{
    \parbox{\textwidth}{
I, Erik Kusch, hereby declare that this thesis and the work presented in it is entirely my own. Where I have consulted the work of others, this is always clearly stated.\\

\noindent \namesigdate{Erik Kusch}
    }

}